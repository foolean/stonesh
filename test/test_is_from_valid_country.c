/*
 * test_is_from_valid_country.c
 *
 * This file is part of the regressions tests for stonesh.
 *
 * Copyright 2012 Bennett Samowich <bennett@foolean.org>
 *
 * Stonesh is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * Stonesh is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with Stonesh.  If not, see <http://www.gnu.org/licenses/>.
 */

#include <stdio.h>
#include <stdlib.h>
#include <string.h>

#include "readconf.h"
#include "geoip.h"

extern Options options;

char *progname = "test_is_from_valid_country";

int test_is_from_valid_country( char *in, char *list, int out )
{
    int result;
    char *countries;

    options.geoip_dat  = "GeoIP.dat";
    options.geoip6_dat = "GeoIPv6.dat";

    printf( "   is_from_valid_country( '%s', '%s', %i ) ", in, list, out );
    /*@-unrecog@*/
    countries = strdup( list );
    /*@+unrecog@*/

    result = is_from_valid_country( in, countries, "," );
    free( countries );

    printf( " = %i ", result );
    if ( result == out ) {
        printf( "passed\n" );
        return( 0 );
    }
    printf( "failed\n" );
    return( 1 );
}

int main()
{
    int errors = 0;
    int tests = 0;


    /* test the trim function */
    printf( "testing geoip.c:is_from_valid_country()\n" );

    tests++; errors += test_is_from_valid_country( "128.12.23.21", "US", 1 );
    tests++; errors += test_is_from_valid_country( "128.12.23.21", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "128.12.23.21", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "128.12.23.21", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "128.12.23.21", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "178.110.55.83", "GB", 1 );
    tests++; errors += test_is_from_valid_country( "178.110.55.83", "XX,GB,YY", 1 );
    tests++; errors += test_is_from_valid_country( "178.110.55.83", "GB,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "178.110.55.83", "XX,YY,GB", 1 );
    tests++; errors += test_is_from_valid_country( "178.110.55.83", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "222.149.27.198", "JP", 1 );
    tests++; errors += test_is_from_valid_country( "222.149.27.198", "XX,JP,YY", 1 );
    tests++; errors += test_is_from_valid_country( "222.149.27.198", "JP,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "222.149.27.198", "XX,YY,JP", 1 );
    tests++; errors += test_is_from_valid_country( "222.149.27.198", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "90.162.182.132", "ES", 1 );
    tests++; errors += test_is_from_valid_country( "90.162.182.132", "XX,ES,YY", 1 );
    tests++; errors += test_is_from_valid_country( "90.162.182.132", "ES,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "90.162.182.132", "XX,YY,ES", 1 );
    tests++; errors += test_is_from_valid_country( "90.162.182.132", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "32.96.71.46", "US", 1 );
    tests++; errors += test_is_from_valid_country( "32.96.71.46", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "32.96.71.46", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "32.96.71.46", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "32.96.71.46", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "4.129.229.139", "US", 1 );
    tests++; errors += test_is_from_valid_country( "4.129.229.139", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "4.129.229.139", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "4.129.229.139", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "4.129.229.139", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "57.205.89.174", "EU", 1 );
    tests++; errors += test_is_from_valid_country( "57.205.89.174", "XX,EU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "57.205.89.174", "EU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "57.205.89.174", "XX,YY,EU", 1 );
    tests++; errors += test_is_from_valid_country( "57.205.89.174", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "193.52.225.100", "FR", 1 );
    tests++; errors += test_is_from_valid_country( "193.52.225.100", "XX,FR,YY", 1 );
    tests++; errors += test_is_from_valid_country( "193.52.225.100", "FR,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "193.52.225.100", "XX,YY,FR", 1 );
    tests++; errors += test_is_from_valid_country( "193.52.225.100", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "133.150.197.55", "JP", 1 );
    tests++; errors += test_is_from_valid_country( "133.150.197.55", "XX,JP,YY", 1 );
    tests++; errors += test_is_from_valid_country( "133.150.197.55", "JP,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "133.150.197.55", "XX,YY,JP", 1 );
    tests++; errors += test_is_from_valid_country( "133.150.197.55", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "101.67.46.193", "CN", 1 );
    tests++; errors += test_is_from_valid_country( "101.67.46.193", "XX,CN,YY", 1 );
    tests++; errors += test_is_from_valid_country( "101.67.46.193", "CN,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "101.67.46.193", "XX,YY,CN", 1 );
    tests++; errors += test_is_from_valid_country( "101.67.46.193", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:2a16:7f03:db82:c5c3:e41f:46a6:adfb", "EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:2a16:7f03:db82:c5c3:e41f:46a6:adfb", "XX,EU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:2a16:7f03:db82:c5c3:e41f:46a6:adfb", "EU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:2a16:7f03:db82:c5c3:e41f:46a6:adfb", "XX,YY,EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:2a16:7f03:db82:c5c3:e41f:46a6:adfb", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "142.123.171.179", "CA", 1 );
    tests++; errors += test_is_from_valid_country( "142.123.171.179", "XX,CA,YY", 1 );
    tests++; errors += test_is_from_valid_country( "142.123.171.179", "CA,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "142.123.171.179", "XX,YY,CA", 1 );
    tests++; errors += test_is_from_valid_country( "142.123.171.179", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "205.14.45.211", "US", 1 );
    tests++; errors += test_is_from_valid_country( "205.14.45.211", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "205.14.45.211", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "205.14.45.211", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "205.14.45.211", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:a71d:65e6:7e33:bae2:cd09:d273:fcae", "JP", 1 );
    tests++; errors += test_is_from_valid_country( "2001:a71d:65e6:7e33:bae2:cd09:d273:fcae", "XX,JP,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:a71d:65e6:7e33:bae2:cd09:d273:fcae", "JP,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:a71d:65e6:7e33:bae2:cd09:d273:fcae", "XX,YY,JP", 1 );
    tests++; errors += test_is_from_valid_country( "2001:a71d:65e6:7e33:bae2:cd09:d273:fcae", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "126.229.65.229", "JP", 1 );
    tests++; errors += test_is_from_valid_country( "126.229.65.229", "XX,JP,YY", 1 );
    tests++; errors += test_is_from_valid_country( "126.229.65.229", "JP,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "126.229.65.229", "XX,YY,JP", 1 );
    tests++; errors += test_is_from_valid_country( "126.229.65.229", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "34.164.11.197", "US", 1 );
    tests++; errors += test_is_from_valid_country( "34.164.11.197", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "34.164.11.197", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "34.164.11.197", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "34.164.11.197", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "72.141.64.235", "CA", 1 );
    tests++; errors += test_is_from_valid_country( "72.141.64.235", "XX,CA,YY", 1 );
    tests++; errors += test_is_from_valid_country( "72.141.64.235", "CA,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "72.141.64.235", "XX,YY,CA", 1 );
    tests++; errors += test_is_from_valid_country( "72.141.64.235", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:8914:503b:f4c0:59ca:db07:8623:9b80", "AU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:8914:503b:f4c0:59ca:db07:8623:9b80", "XX,AU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:8914:503b:f4c0:59ca:db07:8623:9b80", "AU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:8914:503b:f4c0:59ca:db07:8623:9b80", "XX,YY,AU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:8914:503b:f4c0:59ca:db07:8623:9b80", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:a5f7:04a3:5a5a:a676:52c0:8d03:cea3", "JP", 1 );
    tests++; errors += test_is_from_valid_country( "2001:a5f7:04a3:5a5a:a676:52c0:8d03:cea3", "XX,JP,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:a5f7:04a3:5a5a:a676:52c0:8d03:cea3", "JP,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:a5f7:04a3:5a5a:a676:52c0:8d03:cea3", "XX,YY,JP", 1 );
    tests++; errors += test_is_from_valid_country( "2001:a5f7:04a3:5a5a:a676:52c0:8d03:cea3", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "9.253.171.237", "US", 1 );
    tests++; errors += test_is_from_valid_country( "9.253.171.237", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "9.253.171.237", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "9.253.171.237", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "9.253.171.237", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:5593:df7f:aa70:9253:d967:7b2e:f027", "EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:5593:df7f:aa70:9253:d967:7b2e:f027", "XX,EU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:5593:df7f:aa70:9253:d967:7b2e:f027", "EU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:5593:df7f:aa70:9253:d967:7b2e:f027", "XX,YY,EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:5593:df7f:aa70:9253:d967:7b2e:f027", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "3.61.114.218", "US", 1 );
    tests++; errors += test_is_from_valid_country( "3.61.114.218", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "3.61.114.218", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "3.61.114.218", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "3.61.114.218", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "117.207.93.167", "IN", 1 );
    tests++; errors += test_is_from_valid_country( "117.207.93.167", "XX,IN,YY", 1 );
    tests++; errors += test_is_from_valid_country( "117.207.93.167", "IN,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "117.207.93.167", "XX,YY,IN", 1 );
    tests++; errors += test_is_from_valid_country( "117.207.93.167", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "51.65.106.55", "GB", 1 );
    tests++; errors += test_is_from_valid_country( "51.65.106.55", "XX,GB,YY", 1 );
    tests++; errors += test_is_from_valid_country( "51.65.106.55", "GB,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "51.65.106.55", "XX,YY,GB", 1 );
    tests++; errors += test_is_from_valid_country( "51.65.106.55", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "214.99.139.19", "US", 1 );
    tests++; errors += test_is_from_valid_country( "214.99.139.19", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "214.99.139.19", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "214.99.139.19", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "214.99.139.19", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "38.150.178.70", "US", 1 );
    tests++; errors += test_is_from_valid_country( "38.150.178.70", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "38.150.178.70", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "38.150.178.70", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "38.150.178.70", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "124.154.98.134", "JP", 1 );
    tests++; errors += test_is_from_valid_country( "124.154.98.134", "XX,JP,YY", 1 );
    tests++; errors += test_is_from_valid_country( "124.154.98.134", "JP,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "124.154.98.134", "XX,YY,JP", 1 );
    tests++; errors += test_is_from_valid_country( "124.154.98.134", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:b59c:6b1c:ac3b:707f:7afa:a83c:1635", "TW", 1 );
    tests++; errors += test_is_from_valid_country( "2001:b59c:6b1c:ac3b:707f:7afa:a83c:1635", "XX,TW,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:b59c:6b1c:ac3b:707f:7afa:a83c:1635", "TW,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:b59c:6b1c:ac3b:707f:7afa:a83c:1635", "XX,YY,TW", 1 );
    tests++; errors += test_is_from_valid_country( "2001:b59c:6b1c:ac3b:707f:7afa:a83c:1635", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "184.59.185.200", "US", 1 );
    tests++; errors += test_is_from_valid_country( "184.59.185.200", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "184.59.185.200", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "184.59.185.200", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "184.59.185.200", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:a315:b88a:5d9f:b945:90a1:ede1:ccfc", "JP", 1 );
    tests++; errors += test_is_from_valid_country( "2001:a315:b88a:5d9f:b945:90a1:ede1:ccfc", "XX,JP,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:a315:b88a:5d9f:b945:90a1:ede1:ccfc", "JP,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:a315:b88a:5d9f:b945:90a1:ede1:ccfc", "XX,YY,JP", 1 );
    tests++; errors += test_is_from_valid_country( "2001:a315:b88a:5d9f:b945:90a1:ede1:ccfc", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "77.88.130.14", "PL", 1 );
    tests++; errors += test_is_from_valid_country( "77.88.130.14", "XX,PL,YY", 1 );
    tests++; errors += test_is_from_valid_country( "77.88.130.14", "PL,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "77.88.130.14", "XX,YY,PL", 1 );
    tests++; errors += test_is_from_valid_country( "77.88.130.14", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "215.205.48.25", "US", 1 );
    tests++; errors += test_is_from_valid_country( "215.205.48.25", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "215.205.48.25", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "215.205.48.25", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "215.205.48.25", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "177.85.142.16", "BR", 1 );
    tests++; errors += test_is_from_valid_country( "177.85.142.16", "XX,BR,YY", 1 );
    tests++; errors += test_is_from_valid_country( "177.85.142.16", "BR,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "177.85.142.16", "XX,YY,BR", 1 );
    tests++; errors += test_is_from_valid_country( "177.85.142.16", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:2e0a:e9b0:54fc:5b80:857e:a4d0:e491", "EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:2e0a:e9b0:54fc:5b80:857e:a4d0:e491", "XX,EU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:2e0a:e9b0:54fc:5b80:857e:a4d0:e491", "EU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:2e0a:e9b0:54fc:5b80:857e:a4d0:e491", "XX,YY,EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:2e0a:e9b0:54fc:5b80:857e:a4d0:e491", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "145.121.203.42", "NL", 1 );
    tests++; errors += test_is_from_valid_country( "145.121.203.42", "XX,NL,YY", 1 );
    tests++; errors += test_is_from_valid_country( "145.121.203.42", "NL,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "145.121.203.42", "XX,YY,NL", 1 );
    tests++; errors += test_is_from_valid_country( "145.121.203.42", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "79.16.4.234", "IT", 1 );
    tests++; errors += test_is_from_valid_country( "79.16.4.234", "XX,IT,YY", 1 );
    tests++; errors += test_is_from_valid_country( "79.16.4.234", "IT,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "79.16.4.234", "XX,YY,IT", 1 );
    tests++; errors += test_is_from_valid_country( "79.16.4.234", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:8e60:8d3d:a8c3:1756:cb4f:15d1:6081", "AU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:8e60:8d3d:a8c3:1756:cb4f:15d1:6081", "XX,AU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:8e60:8d3d:a8c3:1756:cb4f:15d1:6081", "AU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:8e60:8d3d:a8c3:1756:cb4f:15d1:6081", "XX,YY,AU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:8e60:8d3d:a8c3:1756:cb4f:15d1:6081", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "131.210.16.108", "US", 1 );
    tests++; errors += test_is_from_valid_country( "131.210.16.108", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "131.210.16.108", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "131.210.16.108", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "131.210.16.108", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "61.25.36.157", "JP", 1 );
    tests++; errors += test_is_from_valid_country( "61.25.36.157", "XX,JP,YY", 1 );
    tests++; errors += test_is_from_valid_country( "61.25.36.157", "JP,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "61.25.36.157", "XX,YY,JP", 1 );
    tests++; errors += test_is_from_valid_country( "61.25.36.157", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "152.57.27.179", "US", 1 );
    tests++; errors += test_is_from_valid_country( "152.57.27.179", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "152.57.27.179", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "152.57.27.179", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "152.57.27.179", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:8546:3699:a49a:12c6:8f80:4035:36e9", "AU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:8546:3699:a49a:12c6:8f80:4035:36e9", "XX,AU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:8546:3699:a49a:12c6:8f80:4035:36e9", "AU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:8546:3699:a49a:12c6:8f80:4035:36e9", "XX,YY,AU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:8546:3699:a49a:12c6:8f80:4035:36e9", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "167.199.23.171", "US", 1 );
    tests++; errors += test_is_from_valid_country( "167.199.23.171", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "167.199.23.171", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "167.199.23.171", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "167.199.23.171", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "123.207.137.13", "CN", 1 );
    tests++; errors += test_is_from_valid_country( "123.207.137.13", "XX,CN,YY", 1 );
    tests++; errors += test_is_from_valid_country( "123.207.137.13", "CN,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "123.207.137.13", "XX,YY,CN", 1 );
    tests++; errors += test_is_from_valid_country( "123.207.137.13", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "79.5.250.82", "IT", 1 );
    tests++; errors += test_is_from_valid_country( "79.5.250.82", "XX,IT,YY", 1 );
    tests++; errors += test_is_from_valid_country( "79.5.250.82", "IT,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "79.5.250.82", "XX,YY,IT", 1 );
    tests++; errors += test_is_from_valid_country( "79.5.250.82", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "134.60.225.43", "DE", 1 );
    tests++; errors += test_is_from_valid_country( "134.60.225.43", "XX,DE,YY", 1 );
    tests++; errors += test_is_from_valid_country( "134.60.225.43", "DE,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "134.60.225.43", "XX,YY,DE", 1 );
    tests++; errors += test_is_from_valid_country( "134.60.225.43", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:1d9c:7bbb:75cf:8fdb:60a9:369b:0385", "NL", 1 );
    tests++; errors += test_is_from_valid_country( "2001:1d9c:7bbb:75cf:8fdb:60a9:369b:0385", "XX,NL,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:1d9c:7bbb:75cf:8fdb:60a9:369b:0385", "NL,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:1d9c:7bbb:75cf:8fdb:60a9:369b:0385", "XX,YY,NL", 1 );
    tests++; errors += test_is_from_valid_country( "2001:1d9c:7bbb:75cf:8fdb:60a9:369b:0385", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "108.125.143.144", "US", 1 );
    tests++; errors += test_is_from_valid_country( "108.125.143.144", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "108.125.143.144", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "108.125.143.144", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "108.125.143.144", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:5461:0ed1:3446:46e4:5baf:96f8:52e5", "EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:5461:0ed1:3446:46e4:5baf:96f8:52e5", "XX,EU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:5461:0ed1:3446:46e4:5baf:96f8:52e5", "EU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:5461:0ed1:3446:46e4:5baf:96f8:52e5", "XX,YY,EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:5461:0ed1:3446:46e4:5baf:96f8:52e5", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "17.139.194.102", "US", 1 );
    tests++; errors += test_is_from_valid_country( "17.139.194.102", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "17.139.194.102", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "17.139.194.102", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "17.139.194.102", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "22.143.191.88", "US", 1 );
    tests++; errors += test_is_from_valid_country( "22.143.191.88", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "22.143.191.88", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "22.143.191.88", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "22.143.191.88", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:205e:4419:feda:76ea:9602:7122:880e", "EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:205e:4419:feda:76ea:9602:7122:880e", "XX,EU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:205e:4419:feda:76ea:9602:7122:880e", "EU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:205e:4419:feda:76ea:9602:7122:880e", "XX,YY,EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:205e:4419:feda:76ea:9602:7122:880e", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "150.139.127.40", "CN", 1 );
    tests++; errors += test_is_from_valid_country( "150.139.127.40", "XX,CN,YY", 1 );
    tests++; errors += test_is_from_valid_country( "150.139.127.40", "CN,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "150.139.127.40", "XX,YY,CN", 1 );
    tests++; errors += test_is_from_valid_country( "150.139.127.40", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "118.183.127.244", "CN", 1 );
    tests++; errors += test_is_from_valid_country( "118.183.127.244", "XX,CN,YY", 1 );
    tests++; errors += test_is_from_valid_country( "118.183.127.244", "CN,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "118.183.127.244", "XX,YY,CN", 1 );
    tests++; errors += test_is_from_valid_country( "118.183.127.244", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "165.197.126.211", "US", 1 );
    tests++; errors += test_is_from_valid_country( "165.197.126.211", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "165.197.126.211", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "165.197.126.211", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "165.197.126.211", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "217.56.121.52", "IT", 1 );
    tests++; errors += test_is_from_valid_country( "217.56.121.52", "XX,IT,YY", 1 );
    tests++; errors += test_is_from_valid_country( "217.56.121.52", "IT,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "217.56.121.52", "XX,YY,IT", 1 );
    tests++; errors += test_is_from_valid_country( "217.56.121.52", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:5106:ebbc:456c:c147:1150:9329:233e", "EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:5106:ebbc:456c:c147:1150:9329:233e", "XX,EU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:5106:ebbc:456c:c147:1150:9329:233e", "EU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:5106:ebbc:456c:c147:1150:9329:233e", "XX,YY,EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:5106:ebbc:456c:c147:1150:9329:233e", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "68.73.166.180", "US", 1 );
    tests++; errors += test_is_from_valid_country( "68.73.166.180", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "68.73.166.180", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "68.73.166.180", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "68.73.166.180", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "30.27.76.115", "US", 1 );
    tests++; errors += test_is_from_valid_country( "30.27.76.115", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "30.27.76.115", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "30.27.76.115", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "30.27.76.115", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "33.203.109.2", "US", 1 );
    tests++; errors += test_is_from_valid_country( "33.203.109.2", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "33.203.109.2", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "33.203.109.2", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "33.203.109.2", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:519d:14ce:9757:4a80:a862:0f0a:de4d", "EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:519d:14ce:9757:4a80:a862:0f0a:de4d", "XX,EU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:519d:14ce:9757:4a80:a862:0f0a:de4d", "EU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:519d:14ce:9757:4a80:a862:0f0a:de4d", "XX,YY,EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:519d:14ce:9757:4a80:a862:0f0a:de4d", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "202.150.104.78", "NZ", 1 );
    tests++; errors += test_is_from_valid_country( "202.150.104.78", "XX,NZ,YY", 1 );
    tests++; errors += test_is_from_valid_country( "202.150.104.78", "NZ,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "202.150.104.78", "XX,YY,NZ", 1 );
    tests++; errors += test_is_from_valid_country( "202.150.104.78", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "115.134.64.197", "MY", 1 );
    tests++; errors += test_is_from_valid_country( "115.134.64.197", "XX,MY,YY", 1 );
    tests++; errors += test_is_from_valid_country( "115.134.64.197", "MY,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "115.134.64.197", "XX,YY,MY", 1 );
    tests++; errors += test_is_from_valid_country( "115.134.64.197", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:1c97:63b0:89a8:4625:803b:b7b4:a897", "NL", 1 );
    tests++; errors += test_is_from_valid_country( "2001:1c97:63b0:89a8:4625:803b:b7b4:a897", "XX,NL,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:1c97:63b0:89a8:4625:803b:b7b4:a897", "NL,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:1c97:63b0:89a8:4625:803b:b7b4:a897", "XX,YY,NL", 1 );
    tests++; errors += test_is_from_valid_country( "2001:1c97:63b0:89a8:4625:803b:b7b4:a897", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "1.113.127.235", "JP", 1 );
    tests++; errors += test_is_from_valid_country( "1.113.127.235", "XX,JP,YY", 1 );
    tests++; errors += test_is_from_valid_country( "1.113.127.235", "JP,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "1.113.127.235", "XX,YY,JP", 1 );
    tests++; errors += test_is_from_valid_country( "1.113.127.235", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "1.76.38.162", "JP", 1 );
    tests++; errors += test_is_from_valid_country( "1.76.38.162", "XX,JP,YY", 1 );
    tests++; errors += test_is_from_valid_country( "1.76.38.162", "JP,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "1.76.38.162", "XX,YY,JP", 1 );
    tests++; errors += test_is_from_valid_country( "1.76.38.162", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "13.158.187.53", "US", 1 );
    tests++; errors += test_is_from_valid_country( "13.158.187.53", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "13.158.187.53", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "13.158.187.53", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "13.158.187.53", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "134.11.242.78", "US", 1 );
    tests++; errors += test_is_from_valid_country( "134.11.242.78", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "134.11.242.78", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "134.11.242.78", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "134.11.242.78", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "20.123.205.7", "US", 1 );
    tests++; errors += test_is_from_valid_country( "20.123.205.7", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "20.123.205.7", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "20.123.205.7", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "20.123.205.7", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "139.151.116.147", "US", 1 );
    tests++; errors += test_is_from_valid_country( "139.151.116.147", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "139.151.116.147", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "139.151.116.147", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "139.151.116.147", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "214.127.244.103", "US", 1 );
    tests++; errors += test_is_from_valid_country( "214.127.244.103", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "214.127.244.103", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "214.127.244.103", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "214.127.244.103", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "212.113.72.174", "BE", 1 );
    tests++; errors += test_is_from_valid_country( "212.113.72.174", "XX,BE,YY", 1 );
    tests++; errors += test_is_from_valid_country( "212.113.72.174", "BE,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "212.113.72.174", "XX,YY,BE", 1 );
    tests++; errors += test_is_from_valid_country( "212.113.72.174", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:82a2:9487:acfb:0653:b176:9651:0714", "AU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:82a2:9487:acfb:0653:b176:9651:0714", "XX,AU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:82a2:9487:acfb:0653:b176:9651:0714", "AU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:82a2:9487:acfb:0653:b176:9651:0714", "XX,YY,AU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:82a2:9487:acfb:0653:b176:9651:0714", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "62.204.158.112", "BG", 1 );
    tests++; errors += test_is_from_valid_country( "62.204.158.112", "XX,BG,YY", 1 );
    tests++; errors += test_is_from_valid_country( "62.204.158.112", "BG,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "62.204.158.112", "XX,YY,BG", 1 );
    tests++; errors += test_is_from_valid_country( "62.204.158.112", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:a56a:8f39:b63e:db21:ad4f:afb7:d91a", "JP", 1 );
    tests++; errors += test_is_from_valid_country( "2001:a56a:8f39:b63e:db21:ad4f:afb7:d91a", "XX,JP,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:a56a:8f39:b63e:db21:ad4f:afb7:d91a", "JP,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:a56a:8f39:b63e:db21:ad4f:afb7:d91a", "XX,YY,JP", 1 );
    tests++; errors += test_is_from_valid_country( "2001:a56a:8f39:b63e:db21:ad4f:afb7:d91a", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "61.32.26.230", "KR", 1 );
    tests++; errors += test_is_from_valid_country( "61.32.26.230", "XX,KR,YY", 1 );
    tests++; errors += test_is_from_valid_country( "61.32.26.230", "KR,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "61.32.26.230", "XX,YY,KR", 1 );
    tests++; errors += test_is_from_valid_country( "61.32.26.230", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "155.27.1.190", "US", 1 );
    tests++; errors += test_is_from_valid_country( "155.27.1.190", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "155.27.1.190", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "155.27.1.190", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "155.27.1.190", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "8.242.33.33", "US", 1 );
    tests++; errors += test_is_from_valid_country( "8.242.33.33", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "8.242.33.33", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "8.242.33.33", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "8.242.33.33", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:8dc3:84fa:4ef0:edbf:c8a8:15f0:6f36", "AU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:8dc3:84fa:4ef0:edbf:c8a8:15f0:6f36", "XX,AU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:8dc3:84fa:4ef0:edbf:c8a8:15f0:6f36", "AU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:8dc3:84fa:4ef0:edbf:c8a8:15f0:6f36", "XX,YY,AU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:8dc3:84fa:4ef0:edbf:c8a8:15f0:6f36", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "51.47.19.9", "GB", 1 );
    tests++; errors += test_is_from_valid_country( "51.47.19.9", "XX,GB,YY", 1 );
    tests++; errors += test_is_from_valid_country( "51.47.19.9", "GB,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "51.47.19.9", "XX,YY,GB", 1 );
    tests++; errors += test_is_from_valid_country( "51.47.19.9", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:4c10:af11:23bd:78b6:abb5:b960:a57e", "NL", 1 );
    tests++; errors += test_is_from_valid_country( "2001:4c10:af11:23bd:78b6:abb5:b960:a57e", "XX,NL,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:4c10:af11:23bd:78b6:abb5:b960:a57e", "NL,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:4c10:af11:23bd:78b6:abb5:b960:a57e", "XX,YY,NL", 1 );
    tests++; errors += test_is_from_valid_country( "2001:4c10:af11:23bd:78b6:abb5:b960:a57e", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "21.148.34.236", "US", 1 );
    tests++; errors += test_is_from_valid_country( "21.148.34.236", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "21.148.34.236", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "21.148.34.236", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "21.148.34.236", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "95.4.214.170", "TR", 1 );
    tests++; errors += test_is_from_valid_country( "95.4.214.170", "XX,TR,YY", 1 );
    tests++; errors += test_is_from_valid_country( "95.4.214.170", "TR,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "95.4.214.170", "XX,YY,TR", 1 );
    tests++; errors += test_is_from_valid_country( "95.4.214.170", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "178.226.111.142", "NL", 1 );
    tests++; errors += test_is_from_valid_country( "178.226.111.142", "XX,NL,YY", 1 );
    tests++; errors += test_is_from_valid_country( "178.226.111.142", "NL,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "178.226.111.142", "XX,YY,NL", 1 );
    tests++; errors += test_is_from_valid_country( "178.226.111.142", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "53.116.159.135", "DE", 1 );
    tests++; errors += test_is_from_valid_country( "53.116.159.135", "XX,DE,YY", 1 );
    tests++; errors += test_is_from_valid_country( "53.116.159.135", "DE,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "53.116.159.135", "XX,YY,DE", 1 );
    tests++; errors += test_is_from_valid_country( "53.116.159.135", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:2eab:6fe3:b3b0:8dfd:c7ef:5fc9:fc85", "EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:2eab:6fe3:b3b0:8dfd:c7ef:5fc9:fc85", "XX,EU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:2eab:6fe3:b3b0:8dfd:c7ef:5fc9:fc85", "EU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:2eab:6fe3:b3b0:8dfd:c7ef:5fc9:fc85", "XX,YY,EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:2eab:6fe3:b3b0:8dfd:c7ef:5fc9:fc85", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "178.100.82.94", "GB", 1 );
    tests++; errors += test_is_from_valid_country( "178.100.82.94", "XX,GB,YY", 1 );
    tests++; errors += test_is_from_valid_country( "178.100.82.94", "GB,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "178.100.82.94", "XX,YY,GB", 1 );
    tests++; errors += test_is_from_valid_country( "178.100.82.94", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "206.213.38.150", "US", 1 );
    tests++; errors += test_is_from_valid_country( "206.213.38.150", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "206.213.38.150", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "206.213.38.150", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "206.213.38.150", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "13.27.89.23", "US", 1 );
    tests++; errors += test_is_from_valid_country( "13.27.89.23", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "13.27.89.23", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "13.27.89.23", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "13.27.89.23", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "20.12.19.122", "US", 1 );
    tests++; errors += test_is_from_valid_country( "20.12.19.122", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "20.12.19.122", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "20.12.19.122", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "20.12.19.122", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "181.56.224.149", "CO", 1 );
    tests++; errors += test_is_from_valid_country( "181.56.224.149", "XX,CO,YY", 1 );
    tests++; errors += test_is_from_valid_country( "181.56.224.149", "CO,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "181.56.224.149", "XX,YY,CO", 1 );
    tests++; errors += test_is_from_valid_country( "181.56.224.149", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:41c6:30b5:cc65:cf5e:00c7:4046:7bef", "GB", 1 );
    tests++; errors += test_is_from_valid_country( "2001:41c6:30b5:cc65:cf5e:00c7:4046:7bef", "XX,GB,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:41c6:30b5:cc65:cf5e:00c7:4046:7bef", "GB,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:41c6:30b5:cc65:cf5e:00c7:4046:7bef", "XX,YY,GB", 1 );
    tests++; errors += test_is_from_valid_country( "2001:41c6:30b5:cc65:cf5e:00c7:4046:7bef", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "203.58.51.228", "AU", 1 );
    tests++; errors += test_is_from_valid_country( "203.58.51.228", "XX,AU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "203.58.51.228", "AU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "203.58.51.228", "XX,YY,AU", 1 );
    tests++; errors += test_is_from_valid_country( "203.58.51.228", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "61.87.112.225", "JP", 1 );
    tests++; errors += test_is_from_valid_country( "61.87.112.225", "XX,JP,YY", 1 );
    tests++; errors += test_is_from_valid_country( "61.87.112.225", "JP,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "61.87.112.225", "XX,YY,JP", 1 );
    tests++; errors += test_is_from_valid_country( "61.87.112.225", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:2163:7214:0208:9f84:28b9:74b7:4b43", "EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:2163:7214:0208:9f84:28b9:74b7:4b43", "XX,EU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:2163:7214:0208:9f84:28b9:74b7:4b43", "EU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:2163:7214:0208:9f84:28b9:74b7:4b43", "XX,YY,EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:2163:7214:0208:9f84:28b9:74b7:4b43", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "137.61.63.90", "SE", 1 );
    tests++; errors += test_is_from_valid_country( "137.61.63.90", "XX,SE,YY", 1 );
    tests++; errors += test_is_from_valid_country( "137.61.63.90", "SE,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "137.61.63.90", "XX,YY,SE", 1 );
    tests++; errors += test_is_from_valid_country( "137.61.63.90", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "213.30.28.60", "PT", 1 );
    tests++; errors += test_is_from_valid_country( "213.30.28.60", "XX,PT,YY", 1 );
    tests++; errors += test_is_from_valid_country( "213.30.28.60", "PT,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "213.30.28.60", "XX,YY,PT", 1 );
    tests++; errors += test_is_from_valid_country( "213.30.28.60", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "118.199.219.189", "CN", 1 );
    tests++; errors += test_is_from_valid_country( "118.199.219.189", "XX,CN,YY", 1 );
    tests++; errors += test_is_from_valid_country( "118.199.219.189", "CN,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "118.199.219.189", "XX,YY,CN", 1 );
    tests++; errors += test_is_from_valid_country( "118.199.219.189", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "164.106.38.237", "US", 1 );
    tests++; errors += test_is_from_valid_country( "164.106.38.237", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "164.106.38.237", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "164.106.38.237", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "164.106.38.237", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "75.110.133.80", "US", 1 );
    tests++; errors += test_is_from_valid_country( "75.110.133.80", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "75.110.133.80", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "75.110.133.80", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "75.110.133.80", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "96.180.47.103", "US", 1 );
    tests++; errors += test_is_from_valid_country( "96.180.47.103", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "96.180.47.103", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "96.180.47.103", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "96.180.47.103", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "22.84.214.225", "US", 1 );
    tests++; errors += test_is_from_valid_country( "22.84.214.225", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "22.84.214.225", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "22.84.214.225", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "22.84.214.225", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "27.49.106.218", "IN", 1 );
    tests++; errors += test_is_from_valid_country( "27.49.106.218", "XX,IN,YY", 1 );
    tests++; errors += test_is_from_valid_country( "27.49.106.218", "IN,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "27.49.106.218", "XX,YY,IN", 1 );
    tests++; errors += test_is_from_valid_country( "27.49.106.218", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "124.55.187.230", "KR", 1 );
    tests++; errors += test_is_from_valid_country( "124.55.187.230", "XX,KR,YY", 1 );
    tests++; errors += test_is_from_valid_country( "124.55.187.230", "KR,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "124.55.187.230", "XX,YY,KR", 1 );
    tests++; errors += test_is_from_valid_country( "124.55.187.230", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "211.23.169.148", "TW", 1 );
    tests++; errors += test_is_from_valid_country( "211.23.169.148", "XX,TW,YY", 1 );
    tests++; errors += test_is_from_valid_country( "211.23.169.148", "TW,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "211.23.169.148", "XX,YY,TW", 1 );
    tests++; errors += test_is_from_valid_country( "211.23.169.148", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "116.205.86.204", "CN", 1 );
    tests++; errors += test_is_from_valid_country( "116.205.86.204", "XX,CN,YY", 1 );
    tests++; errors += test_is_from_valid_country( "116.205.86.204", "CN,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "116.205.86.204", "XX,YY,CN", 1 );
    tests++; errors += test_is_from_valid_country( "116.205.86.204", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "140.28.22.79", "US", 1 );
    tests++; errors += test_is_from_valid_country( "140.28.22.79", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "140.28.22.79", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "140.28.22.79", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "140.28.22.79", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "31.245.242.115", "DE", 1 );
    tests++; errors += test_is_from_valid_country( "31.245.242.115", "XX,DE,YY", 1 );
    tests++; errors += test_is_from_valid_country( "31.245.242.115", "DE,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "31.245.242.115", "XX,YY,DE", 1 );
    tests++; errors += test_is_from_valid_country( "31.245.242.115", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "15.248.202.93", "US", 1 );
    tests++; errors += test_is_from_valid_country( "15.248.202.93", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "15.248.202.93", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "15.248.202.93", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "15.248.202.93", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "176.53.79.73", "TR", 1 );
    tests++; errors += test_is_from_valid_country( "176.53.79.73", "XX,TR,YY", 1 );
    tests++; errors += test_is_from_valid_country( "176.53.79.73", "TR,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "176.53.79.73", "XX,YY,TR", 1 );
    tests++; errors += test_is_from_valid_country( "176.53.79.73", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "193.136.133.111", "PT", 1 );
    tests++; errors += test_is_from_valid_country( "193.136.133.111", "XX,PT,YY", 1 );
    tests++; errors += test_is_from_valid_country( "193.136.133.111", "PT,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "193.136.133.111", "XX,YY,PT", 1 );
    tests++; errors += test_is_from_valid_country( "193.136.133.111", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "149.212.191.201", "DK", 1 );
    tests++; errors += test_is_from_valid_country( "149.212.191.201", "XX,DK,YY", 1 );
    tests++; errors += test_is_from_valid_country( "149.212.191.201", "DK,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "149.212.191.201", "XX,YY,DK", 1 );
    tests++; errors += test_is_from_valid_country( "149.212.191.201", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "222.145.41.241", "JP", 1 );
    tests++; errors += test_is_from_valid_country( "222.145.41.241", "XX,JP,YY", 1 );
    tests++; errors += test_is_from_valid_country( "222.145.41.241", "JP,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "222.145.41.241", "XX,YY,JP", 1 );
    tests++; errors += test_is_from_valid_country( "222.145.41.241", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:247e:d6a7:1c87:6b91:68f0:df2d:bd3e", "EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:247e:d6a7:1c87:6b91:68f0:df2d:bd3e", "XX,EU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:247e:d6a7:1c87:6b91:68f0:df2d:bd3e", "EU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:247e:d6a7:1c87:6b91:68f0:df2d:bd3e", "XX,YY,EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:247e:d6a7:1c87:6b91:68f0:df2d:bd3e", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "29.146.209.29", "US", 1 );
    tests++; errors += test_is_from_valid_country( "29.146.209.29", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "29.146.209.29", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "29.146.209.29", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "29.146.209.29", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:a111:2075:b02b:b7db:92b3:0712:795a", "JP", 1 );
    tests++; errors += test_is_from_valid_country( "2001:a111:2075:b02b:b7db:92b3:0712:795a", "XX,JP,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:a111:2075:b02b:b7db:92b3:0712:795a", "JP,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:a111:2075:b02b:b7db:92b3:0712:795a", "XX,YY,JP", 1 );
    tests++; errors += test_is_from_valid_country( "2001:a111:2075:b02b:b7db:92b3:0712:795a", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:5150:b2d1:fdf7:45b0:df3e:76d5:a9df", "EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:5150:b2d1:fdf7:45b0:df3e:76d5:a9df", "XX,EU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:5150:b2d1:fdf7:45b0:df3e:76d5:a9df", "EU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:5150:b2d1:fdf7:45b0:df3e:76d5:a9df", "XX,YY,EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:5150:b2d1:fdf7:45b0:df3e:76d5:a9df", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "211.146.243.203", "CN", 1 );
    tests++; errors += test_is_from_valid_country( "211.146.243.203", "XX,CN,YY", 1 );
    tests++; errors += test_is_from_valid_country( "211.146.243.203", "CN,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "211.146.243.203", "XX,YY,CN", 1 );
    tests++; errors += test_is_from_valid_country( "211.146.243.203", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "166.211.79.203", "US", 1 );
    tests++; errors += test_is_from_valid_country( "166.211.79.203", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "166.211.79.203", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "166.211.79.203", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "166.211.79.203", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "181.0.186.137", "AR", 1 );
    tests++; errors += test_is_from_valid_country( "181.0.186.137", "XX,AR,YY", 1 );
    tests++; errors += test_is_from_valid_country( "181.0.186.137", "AR,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "181.0.186.137", "XX,YY,AR", 1 );
    tests++; errors += test_is_from_valid_country( "181.0.186.137", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "166.110.248.166", "CL", 1 );
    tests++; errors += test_is_from_valid_country( "166.110.248.166", "XX,CL,YY", 1 );
    tests++; errors += test_is_from_valid_country( "166.110.248.166", "CL,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "166.110.248.166", "XX,YY,CL", 1 );
    tests++; errors += test_is_from_valid_country( "166.110.248.166", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "219.125.7.150", "JP", 1 );
    tests++; errors += test_is_from_valid_country( "219.125.7.150", "XX,JP,YY", 1 );
    tests++; errors += test_is_from_valid_country( "219.125.7.150", "JP,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "219.125.7.150", "XX,YY,JP", 1 );
    tests++; errors += test_is_from_valid_country( "219.125.7.150", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:53c9:c569:7726:d161:2017:ff1b:4fcd", "EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:53c9:c569:7726:d161:2017:ff1b:4fcd", "XX,EU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:53c9:c569:7726:d161:2017:ff1b:4fcd", "EU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:53c9:c569:7726:d161:2017:ff1b:4fcd", "XX,YY,EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:53c9:c569:7726:d161:2017:ff1b:4fcd", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "212.50.87.159", "BG", 1 );
    tests++; errors += test_is_from_valid_country( "212.50.87.159", "XX,BG,YY", 1 );
    tests++; errors += test_is_from_valid_country( "212.50.87.159", "BG,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "212.50.87.159", "XX,YY,BG", 1 );
    tests++; errors += test_is_from_valid_country( "212.50.87.159", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "151.67.158.40", "IT", 1 );
    tests++; errors += test_is_from_valid_country( "151.67.158.40", "XX,IT,YY", 1 );
    tests++; errors += test_is_from_valid_country( "151.67.158.40", "IT,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "151.67.158.40", "XX,YY,IT", 1 );
    tests++; errors += test_is_from_valid_country( "151.67.158.40", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:8a1c:812b:d381:a566:5861:4119:6317", "AU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:8a1c:812b:d381:a566:5861:4119:6317", "XX,AU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:8a1c:812b:d381:a566:5861:4119:6317", "AU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:8a1c:812b:d381:a566:5861:4119:6317", "XX,YY,AU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:8a1c:812b:d381:a566:5861:4119:6317", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "126.235.149.216", "JP", 1 );
    tests++; errors += test_is_from_valid_country( "126.235.149.216", "XX,JP,YY", 1 );
    tests++; errors += test_is_from_valid_country( "126.235.149.216", "JP,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "126.235.149.216", "XX,YY,JP", 1 );
    tests++; errors += test_is_from_valid_country( "126.235.149.216", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "177.25.12.70", "BR", 1 );
    tests++; errors += test_is_from_valid_country( "177.25.12.70", "XX,BR,YY", 1 );
    tests++; errors += test_is_from_valid_country( "177.25.12.70", "BR,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "177.25.12.70", "XX,YY,BR", 1 );
    tests++; errors += test_is_from_valid_country( "177.25.12.70", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "110.73.250.104", "CN", 1 );
    tests++; errors += test_is_from_valid_country( "110.73.250.104", "XX,CN,YY", 1 );
    tests++; errors += test_is_from_valid_country( "110.73.250.104", "CN,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "110.73.250.104", "XX,YY,CN", 1 );
    tests++; errors += test_is_from_valid_country( "110.73.250.104", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:2261:fc8a:c0a3:e714:3248:ea51:fe8f", "EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:2261:fc8a:c0a3:e714:3248:ea51:fe8f", "XX,EU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:2261:fc8a:c0a3:e714:3248:ea51:fe8f", "EU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:2261:fc8a:c0a3:e714:3248:ea51:fe8f", "XX,YY,EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:2261:fc8a:c0a3:e714:3248:ea51:fe8f", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:54ef:a84b:6ef7:44a9:489b:445f:bccf", "EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:54ef:a84b:6ef7:44a9:489b:445f:bccf", "XX,EU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:54ef:a84b:6ef7:44a9:489b:445f:bccf", "EU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:54ef:a84b:6ef7:44a9:489b:445f:bccf", "XX,YY,EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:54ef:a84b:6ef7:44a9:489b:445f:bccf", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "115.81.67.52", "TW", 1 );
    tests++; errors += test_is_from_valid_country( "115.81.67.52", "XX,TW,YY", 1 );
    tests++; errors += test_is_from_valid_country( "115.81.67.52", "TW,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "115.81.67.52", "XX,YY,TW", 1 );
    tests++; errors += test_is_from_valid_country( "115.81.67.52", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "201.149.63.67", "MX", 1 );
    tests++; errors += test_is_from_valid_country( "201.149.63.67", "XX,MX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "201.149.63.67", "MX,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "201.149.63.67", "XX,YY,MX", 1 );
    tests++; errors += test_is_from_valid_country( "201.149.63.67", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "47.20.98.146", "US", 1 );
    tests++; errors += test_is_from_valid_country( "47.20.98.146", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "47.20.98.146", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "47.20.98.146", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "47.20.98.146", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "208.135.204.160", "US", 1 );
    tests++; errors += test_is_from_valid_country( "208.135.204.160", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "208.135.204.160", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "208.135.204.160", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "208.135.204.160", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "16.140.168.111", "US", 1 );
    tests++; errors += test_is_from_valid_country( "16.140.168.111", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "16.140.168.111", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "16.140.168.111", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "16.140.168.111", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "81.249.103.84", "FR", 1 );
    tests++; errors += test_is_from_valid_country( "81.249.103.84", "XX,FR,YY", 1 );
    tests++; errors += test_is_from_valid_country( "81.249.103.84", "FR,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "81.249.103.84", "XX,YY,FR", 1 );
    tests++; errors += test_is_from_valid_country( "81.249.103.84", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2.150.11.121", "NO", 1 );
    tests++; errors += test_is_from_valid_country( "2.150.11.121", "XX,NO,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2.150.11.121", "NO,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2.150.11.121", "XX,YY,NO", 1 );
    tests++; errors += test_is_from_valid_country( "2.150.11.121", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "85.115.251.186", "RU", 1 );
    tests++; errors += test_is_from_valid_country( "85.115.251.186", "XX,RU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "85.115.251.186", "RU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "85.115.251.186", "XX,YY,RU", 1 );
    tests++; errors += test_is_from_valid_country( "85.115.251.186", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "136.189.109.99", "US", 1 );
    tests++; errors += test_is_from_valid_country( "136.189.109.99", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "136.189.109.99", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "136.189.109.99", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "136.189.109.99", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "83.188.128.24", "RU", 1 );
    tests++; errors += test_is_from_valid_country( "83.188.128.24", "XX,RU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "83.188.128.24", "RU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "83.188.128.24", "XX,YY,RU", 1 );
    tests++; errors += test_is_from_valid_country( "83.188.128.24", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "93.125.102.26", "BY", 1 );
    tests++; errors += test_is_from_valid_country( "93.125.102.26", "XX,BY,YY", 1 );
    tests++; errors += test_is_from_valid_country( "93.125.102.26", "BY,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "93.125.102.26", "XX,YY,BY", 1 );
    tests++; errors += test_is_from_valid_country( "93.125.102.26", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "92.231.30.223", "DE", 1 );
    tests++; errors += test_is_from_valid_country( "92.231.30.223", "XX,DE,YY", 1 );
    tests++; errors += test_is_from_valid_country( "92.231.30.223", "DE,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "92.231.30.223", "XX,YY,DE", 1 );
    tests++; errors += test_is_from_valid_country( "92.231.30.223", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "50.229.74.253", "US", 1 );
    tests++; errors += test_is_from_valid_country( "50.229.74.253", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "50.229.74.253", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "50.229.74.253", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "50.229.74.253", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "162.122.54.180", "VE", 1 );
    tests++; errors += test_is_from_valid_country( "162.122.54.180", "XX,VE,YY", 1 );
    tests++; errors += test_is_from_valid_country( "162.122.54.180", "VE,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "162.122.54.180", "XX,YY,VE", 1 );
    tests++; errors += test_is_from_valid_country( "162.122.54.180", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:1331:079c:2722:1163:0be5:7b20:500b", "CR", 1 );
    tests++; errors += test_is_from_valid_country( "2001:1331:079c:2722:1163:0be5:7b20:500b", "XX,CR,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:1331:079c:2722:1163:0be5:7b20:500b", "CR,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:1331:079c:2722:1163:0be5:7b20:500b", "XX,YY,CR", 1 );
    tests++; errors += test_is_from_valid_country( "2001:1331:079c:2722:1163:0be5:7b20:500b", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "47.68.239.81", "DE", 1 );
    tests++; errors += test_is_from_valid_country( "47.68.239.81", "XX,DE,YY", 1 );
    tests++; errors += test_is_from_valid_country( "47.68.239.81", "DE,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "47.68.239.81", "XX,YY,DE", 1 );
    tests++; errors += test_is_from_valid_country( "47.68.239.81", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "29.151.24.212", "US", 1 );
    tests++; errors += test_is_from_valid_country( "29.151.24.212", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "29.151.24.212", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "29.151.24.212", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "29.151.24.212", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "7.68.247.9", "US", 1 );
    tests++; errors += test_is_from_valid_country( "7.68.247.9", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "7.68.247.9", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "7.68.247.9", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "7.68.247.9", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "153.201.60.131", "JP", 1 );
    tests++; errors += test_is_from_valid_country( "153.201.60.131", "XX,JP,YY", 1 );
    tests++; errors += test_is_from_valid_country( "153.201.60.131", "JP,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "153.201.60.131", "XX,YY,JP", 1 );
    tests++; errors += test_is_from_valid_country( "153.201.60.131", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "157.223.203.199", "US", 1 );
    tests++; errors += test_is_from_valid_country( "157.223.203.199", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "157.223.203.199", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "157.223.203.199", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "157.223.203.199", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "113.174.123.107", "VN", 1 );
    tests++; errors += test_is_from_valid_country( "113.174.123.107", "XX,VN,YY", 1 );
    tests++; errors += test_is_from_valid_country( "113.174.123.107", "VN,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "113.174.123.107", "XX,YY,VN", 1 );
    tests++; errors += test_is_from_valid_country( "113.174.123.107", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "129.159.241.195", "US", 1 );
    tests++; errors += test_is_from_valid_country( "129.159.241.195", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "129.159.241.195", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "129.159.241.195", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "129.159.241.195", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "175.130.35.105", "JP", 1 );
    tests++; errors += test_is_from_valid_country( "175.130.35.105", "XX,JP,YY", 1 );
    tests++; errors += test_is_from_valid_country( "175.130.35.105", "JP,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "175.130.35.105", "XX,YY,JP", 1 );
    tests++; errors += test_is_from_valid_country( "175.130.35.105", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:2be3:70a0:8f68:0cf2:df77:d3d5:4d6c", "EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:2be3:70a0:8f68:0cf2:df77:d3d5:4d6c", "XX,EU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:2be3:70a0:8f68:0cf2:df77:d3d5:4d6c", "EU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:2be3:70a0:8f68:0cf2:df77:d3d5:4d6c", "XX,YY,EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:2be3:70a0:8f68:0cf2:df77:d3d5:4d6c", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "55.231.169.110", "US", 1 );
    tests++; errors += test_is_from_valid_country( "55.231.169.110", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "55.231.169.110", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "55.231.169.110", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "55.231.169.110", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "168.83.213.0", "AR", 1 );
    tests++; errors += test_is_from_valid_country( "168.83.213.0", "XX,AR,YY", 1 );
    tests++; errors += test_is_from_valid_country( "168.83.213.0", "AR,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "168.83.213.0", "XX,YY,AR", 1 );
    tests++; errors += test_is_from_valid_country( "168.83.213.0", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:828a:007a:5236:0548:4d11:752d:7fc2", "AU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:828a:007a:5236:0548:4d11:752d:7fc2", "XX,AU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:828a:007a:5236:0548:4d11:752d:7fc2", "AU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:828a:007a:5236:0548:4d11:752d:7fc2", "XX,YY,AU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:828a:007a:5236:0548:4d11:752d:7fc2", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "148.137.64.125", "US", 1 );
    tests++; errors += test_is_from_valid_country( "148.137.64.125", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "148.137.64.125", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "148.137.64.125", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "148.137.64.125", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "88.215.164.144", "RU", 1 );
    tests++; errors += test_is_from_valid_country( "88.215.164.144", "XX,RU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "88.215.164.144", "RU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "88.215.164.144", "XX,YY,RU", 1 );
    tests++; errors += test_is_from_valid_country( "88.215.164.144", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:21a7:1b02:1024:b140:f746:ad8c:750e", "EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:21a7:1b02:1024:b140:f746:ad8c:750e", "XX,EU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:21a7:1b02:1024:b140:f746:ad8c:750e", "EU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:21a7:1b02:1024:b140:f746:ad8c:750e", "XX,YY,EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:21a7:1b02:1024:b140:f746:ad8c:750e", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "112.45.83.144", "CN", 1 );
    tests++; errors += test_is_from_valid_country( "112.45.83.144", "XX,CN,YY", 1 );
    tests++; errors += test_is_from_valid_country( "112.45.83.144", "CN,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "112.45.83.144", "XX,YY,CN", 1 );
    tests++; errors += test_is_from_valid_country( "112.45.83.144", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "67.112.143.71", "US", 1 );
    tests++; errors += test_is_from_valid_country( "67.112.143.71", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "67.112.143.71", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "67.112.143.71", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "67.112.143.71", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:5342:8f68:bde1:e334:278f:8c94:94d4", "EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:5342:8f68:bde1:e334:278f:8c94:94d4", "XX,EU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:5342:8f68:bde1:e334:278f:8c94:94d4", "EU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:5342:8f68:bde1:e334:278f:8c94:94d4", "XX,YY,EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:5342:8f68:bde1:e334:278f:8c94:94d4", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:8b2e:0d74:9803:9924:1844:629e:1e6c", "AU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:8b2e:0d74:9803:9924:1844:629e:1e6c", "XX,AU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:8b2e:0d74:9803:9924:1844:629e:1e6c", "AU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:8b2e:0d74:9803:9924:1844:629e:1e6c", "XX,YY,AU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:8b2e:0d74:9803:9924:1844:629e:1e6c", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "125.67.153.235", "CN", 1 );
    tests++; errors += test_is_from_valid_country( "125.67.153.235", "XX,CN,YY", 1 );
    tests++; errors += test_is_from_valid_country( "125.67.153.235", "CN,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "125.67.153.235", "XX,YY,CN", 1 );
    tests++; errors += test_is_from_valid_country( "125.67.153.235", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:2b4c:6427:a6da:9359:d25b:0cc4:15cd", "EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:2b4c:6427:a6da:9359:d25b:0cc4:15cd", "XX,EU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:2b4c:6427:a6da:9359:d25b:0cc4:15cd", "EU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:2b4c:6427:a6da:9359:d25b:0cc4:15cd", "XX,YY,EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:2b4c:6427:a6da:9359:d25b:0cc4:15cd", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "11.106.244.203", "US", 1 );
    tests++; errors += test_is_from_valid_country( "11.106.244.203", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "11.106.244.203", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "11.106.244.203", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "11.106.244.203", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "90.46.23.195", "FR", 1 );
    tests++; errors += test_is_from_valid_country( "90.46.23.195", "XX,FR,YY", 1 );
    tests++; errors += test_is_from_valid_country( "90.46.23.195", "FR,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "90.46.23.195", "XX,YY,FR", 1 );
    tests++; errors += test_is_from_valid_country( "90.46.23.195", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "62.108.75.61", "TR", 1 );
    tests++; errors += test_is_from_valid_country( "62.108.75.61", "XX,TR,YY", 1 );
    tests++; errors += test_is_from_valid_country( "62.108.75.61", "TR,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "62.108.75.61", "XX,YY,TR", 1 );
    tests++; errors += test_is_from_valid_country( "62.108.75.61", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "116.55.111.78", "CN", 1 );
    tests++; errors += test_is_from_valid_country( "116.55.111.78", "XX,CN,YY", 1 );
    tests++; errors += test_is_from_valid_country( "116.55.111.78", "CN,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "116.55.111.78", "XX,YY,CN", 1 );
    tests++; errors += test_is_from_valid_country( "116.55.111.78", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "210.176.128.173", "HK", 1 );
    tests++; errors += test_is_from_valid_country( "210.176.128.173", "XX,HK,YY", 1 );
    tests++; errors += test_is_from_valid_country( "210.176.128.173", "HK,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "210.176.128.173", "XX,YY,HK", 1 );
    tests++; errors += test_is_from_valid_country( "210.176.128.173", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "166.170.39.105", "US", 1 );
    tests++; errors += test_is_from_valid_country( "166.170.39.105", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "166.170.39.105", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "166.170.39.105", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "166.170.39.105", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "37.123.168.252", "SE", 1 );
    tests++; errors += test_is_from_valid_country( "37.123.168.252", "XX,SE,YY", 1 );
    tests++; errors += test_is_from_valid_country( "37.123.168.252", "SE,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "37.123.168.252", "XX,YY,SE", 1 );
    tests++; errors += test_is_from_valid_country( "37.123.168.252", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "198.202.65.199", "US", 1 );
    tests++; errors += test_is_from_valid_country( "198.202.65.199", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "198.202.65.199", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "198.202.65.199", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "198.202.65.199", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "30.86.83.130", "US", 1 );
    tests++; errors += test_is_from_valid_country( "30.86.83.130", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "30.86.83.130", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "30.86.83.130", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "30.86.83.130", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "199.33.208.21", "US", 1 );
    tests++; errors += test_is_from_valid_country( "199.33.208.21", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "199.33.208.21", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "199.33.208.21", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "199.33.208.21", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "97.154.25.102", "US", 1 );
    tests++; errors += test_is_from_valid_country( "97.154.25.102", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "97.154.25.102", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "97.154.25.102", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "97.154.25.102", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "124.27.130.11", "JP", 1 );
    tests++; errors += test_is_from_valid_country( "124.27.130.11", "XX,JP,YY", 1 );
    tests++; errors += test_is_from_valid_country( "124.27.130.11", "JP,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "124.27.130.11", "XX,YY,JP", 1 );
    tests++; errors += test_is_from_valid_country( "124.27.130.11", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "75.36.110.127", "US", 1 );
    tests++; errors += test_is_from_valid_country( "75.36.110.127", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "75.36.110.127", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "75.36.110.127", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "75.36.110.127", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "49.225.103.146", "NZ", 1 );
    tests++; errors += test_is_from_valid_country( "49.225.103.146", "XX,NZ,YY", 1 );
    tests++; errors += test_is_from_valid_country( "49.225.103.146", "NZ,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "49.225.103.146", "XX,YY,NZ", 1 );
    tests++; errors += test_is_from_valid_country( "49.225.103.146", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "49.245.147.102", "SG", 1 );
    tests++; errors += test_is_from_valid_country( "49.245.147.102", "XX,SG,YY", 1 );
    tests++; errors += test_is_from_valid_country( "49.245.147.102", "SG,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "49.245.147.102", "XX,YY,SG", 1 );
    tests++; errors += test_is_from_valid_country( "49.245.147.102", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "126.168.30.218", "JP", 1 );
    tests++; errors += test_is_from_valid_country( "126.168.30.218", "XX,JP,YY", 1 );
    tests++; errors += test_is_from_valid_country( "126.168.30.218", "JP,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "126.168.30.218", "XX,YY,JP", 1 );
    tests++; errors += test_is_from_valid_country( "126.168.30.218", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "156.152.85.206", "US", 1 );
    tests++; errors += test_is_from_valid_country( "156.152.85.206", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "156.152.85.206", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "156.152.85.206", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "156.152.85.206", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:a294:6a4f:1b43:efc0:112f:f539:7fd3", "JP", 1 );
    tests++; errors += test_is_from_valid_country( "2001:a294:6a4f:1b43:efc0:112f:f539:7fd3", "XX,JP,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:a294:6a4f:1b43:efc0:112f:f539:7fd3", "JP,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:a294:6a4f:1b43:efc0:112f:f539:7fd3", "XX,YY,JP", 1 );
    tests++; errors += test_is_from_valid_country( "2001:a294:6a4f:1b43:efc0:112f:f539:7fd3", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "71.104.3.157", "US", 1 );
    tests++; errors += test_is_from_valid_country( "71.104.3.157", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "71.104.3.157", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "71.104.3.157", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "71.104.3.157", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "35.92.194.128", "US", 1 );
    tests++; errors += test_is_from_valid_country( "35.92.194.128", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "35.92.194.128", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "35.92.194.128", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "35.92.194.128", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "7.154.207.56", "US", 1 );
    tests++; errors += test_is_from_valid_country( "7.154.207.56", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "7.154.207.56", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "7.154.207.56", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "7.154.207.56", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "147.67.24.61", "LU", 1 );
    tests++; errors += test_is_from_valid_country( "147.67.24.61", "XX,LU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "147.67.24.61", "LU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "147.67.24.61", "XX,YY,LU", 1 );
    tests++; errors += test_is_from_valid_country( "147.67.24.61", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "217.40.0.199", "GB", 1 );
    tests++; errors += test_is_from_valid_country( "217.40.0.199", "XX,GB,YY", 1 );
    tests++; errors += test_is_from_valid_country( "217.40.0.199", "GB,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "217.40.0.199", "XX,YY,GB", 1 );
    tests++; errors += test_is_from_valid_country( "217.40.0.199", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:12e8:ceed:4f01:27e2:d724:0e95:4f5a", "BR", 1 );
    tests++; errors += test_is_from_valid_country( "2001:12e8:ceed:4f01:27e2:d724:0e95:4f5a", "XX,BR,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:12e8:ceed:4f01:27e2:d724:0e95:4f5a", "BR,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:12e8:ceed:4f01:27e2:d724:0e95:4f5a", "XX,YY,BR", 1 );
    tests++; errors += test_is_from_valid_country( "2001:12e8:ceed:4f01:27e2:d724:0e95:4f5a", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "197.155.160.76", "ML", 1 );
    tests++; errors += test_is_from_valid_country( "197.155.160.76", "XX,ML,YY", 1 );
    tests++; errors += test_is_from_valid_country( "197.155.160.76", "ML,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "197.155.160.76", "XX,YY,ML", 1 );
    tests++; errors += test_is_from_valid_country( "197.155.160.76", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "97.204.129.68", "US", 1 );
    tests++; errors += test_is_from_valid_country( "97.204.129.68", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "97.204.129.68", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "97.204.129.68", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "97.204.129.68", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "41.60.52.1", "ZM", 1 );
    tests++; errors += test_is_from_valid_country( "41.60.52.1", "XX,ZM,YY", 1 );
    tests++; errors += test_is_from_valid_country( "41.60.52.1", "ZM,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "41.60.52.1", "XX,YY,ZM", 1 );
    tests++; errors += test_is_from_valid_country( "41.60.52.1", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "54.192.128.173", "US", 1 );
    tests++; errors += test_is_from_valid_country( "54.192.128.173", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "54.192.128.173", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "54.192.128.173", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "54.192.128.173", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "133.253.127.76", "JP", 1 );
    tests++; errors += test_is_from_valid_country( "133.253.127.76", "XX,JP,YY", 1 );
    tests++; errors += test_is_from_valid_country( "133.253.127.76", "JP,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "133.253.127.76", "XX,YY,JP", 1 );
    tests++; errors += test_is_from_valid_country( "133.253.127.76", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:88b6:188b:6c26:1cd6:e3f0:2222:e5d0", "AU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:88b6:188b:6c26:1cd6:e3f0:2222:e5d0", "XX,AU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:88b6:188b:6c26:1cd6:e3f0:2222:e5d0", "AU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:88b6:188b:6c26:1cd6:e3f0:2222:e5d0", "XX,YY,AU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:88b6:188b:6c26:1cd6:e3f0:2222:e5d0", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "176.32.39.188", "RU", 1 );
    tests++; errors += test_is_from_valid_country( "176.32.39.188", "XX,RU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "176.32.39.188", "RU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "176.32.39.188", "XX,YY,RU", 1 );
    tests++; errors += test_is_from_valid_country( "176.32.39.188", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "25.158.65.94", "GB", 1 );
    tests++; errors += test_is_from_valid_country( "25.158.65.94", "XX,GB,YY", 1 );
    tests++; errors += test_is_from_valid_country( "25.158.65.94", "GB,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "25.158.65.94", "XX,YY,GB", 1 );
    tests++; errors += test_is_from_valid_country( "25.158.65.94", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "143.58.17.106", "US", 1 );
    tests++; errors += test_is_from_valid_country( "143.58.17.106", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "143.58.17.106", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "143.58.17.106", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "143.58.17.106", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "78.9.3.43", "PL", 1 );
    tests++; errors += test_is_from_valid_country( "78.9.3.43", "XX,PL,YY", 1 );
    tests++; errors += test_is_from_valid_country( "78.9.3.43", "PL,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "78.9.3.43", "XX,YY,PL", 1 );
    tests++; errors += test_is_from_valid_country( "78.9.3.43", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "158.74.59.48", "US", 1 );
    tests++; errors += test_is_from_valid_country( "158.74.59.48", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "158.74.59.48", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "158.74.59.48", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "158.74.59.48", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "220.200.9.242", "CN", 1 );
    tests++; errors += test_is_from_valid_country( "220.200.9.242", "XX,CN,YY", 1 );
    tests++; errors += test_is_from_valid_country( "220.200.9.242", "CN,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "220.200.9.242", "XX,YY,CN", 1 );
    tests++; errors += test_is_from_valid_country( "220.200.9.242", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:2150:5b6f:9ac7:09be:62d5:15c3:29ca", "EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:2150:5b6f:9ac7:09be:62d5:15c3:29ca", "XX,EU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:2150:5b6f:9ac7:09be:62d5:15c3:29ca", "EU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:2150:5b6f:9ac7:09be:62d5:15c3:29ca", "XX,YY,EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:2150:5b6f:9ac7:09be:62d5:15c3:29ca", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "194.0.188.56", "DE", 1 );
    tests++; errors += test_is_from_valid_country( "194.0.188.56", "XX,DE,YY", 1 );
    tests++; errors += test_is_from_valid_country( "194.0.188.56", "DE,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "194.0.188.56", "XX,YY,DE", 1 );
    tests++; errors += test_is_from_valid_country( "194.0.188.56", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "26.160.76.14", "US", 1 );
    tests++; errors += test_is_from_valid_country( "26.160.76.14", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "26.160.76.14", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "26.160.76.14", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "26.160.76.14", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "177.216.253.85", "BR", 1 );
    tests++; errors += test_is_from_valid_country( "177.216.253.85", "XX,BR,YY", 1 );
    tests++; errors += test_is_from_valid_country( "177.216.253.85", "BR,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "177.216.253.85", "XX,YY,BR", 1 );
    tests++; errors += test_is_from_valid_country( "177.216.253.85", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "14.231.113.91", "VN", 1 );
    tests++; errors += test_is_from_valid_country( "14.231.113.91", "XX,VN,YY", 1 );
    tests++; errors += test_is_from_valid_country( "14.231.113.91", "VN,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "14.231.113.91", "XX,YY,VN", 1 );
    tests++; errors += test_is_from_valid_country( "14.231.113.91", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "140.225.159.168", "US", 1 );
    tests++; errors += test_is_from_valid_country( "140.225.159.168", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "140.225.159.168", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "140.225.159.168", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "140.225.159.168", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "152.151.216.172", "US", 1 );
    tests++; errors += test_is_from_valid_country( "152.151.216.172", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "152.151.216.172", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "152.151.216.172", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "152.151.216.172", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "83.130.60.49", "IL", 1 );
    tests++; errors += test_is_from_valid_country( "83.130.60.49", "XX,IL,YY", 1 );
    tests++; errors += test_is_from_valid_country( "83.130.60.49", "IL,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "83.130.60.49", "XX,YY,IL", 1 );
    tests++; errors += test_is_from_valid_country( "83.130.60.49", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:82f8:76f6:9811:94ea:2da9:8f78:e96f", "AU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:82f8:76f6:9811:94ea:2da9:8f78:e96f", "XX,AU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:82f8:76f6:9811:94ea:2da9:8f78:e96f", "AU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:82f8:76f6:9811:94ea:2da9:8f78:e96f", "XX,YY,AU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:82f8:76f6:9811:94ea:2da9:8f78:e96f", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "214.146.246.182", "US", 1 );
    tests++; errors += test_is_from_valid_country( "214.146.246.182", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "214.146.246.182", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "214.146.246.182", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "214.146.246.182", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "19.154.97.202", "US", 1 );
    tests++; errors += test_is_from_valid_country( "19.154.97.202", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "19.154.97.202", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "19.154.97.202", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "19.154.97.202", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "72.91.233.237", "US", 1 );
    tests++; errors += test_is_from_valid_country( "72.91.233.237", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "72.91.233.237", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "72.91.233.237", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "72.91.233.237", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "131.82.53.232", "US", 1 );
    tests++; errors += test_is_from_valid_country( "131.82.53.232", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "131.82.53.232", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "131.82.53.232", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "131.82.53.232", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "154.64.222.54", "US", 1 );
    tests++; errors += test_is_from_valid_country( "154.64.222.54", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "154.64.222.54", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "154.64.222.54", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "154.64.222.54", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "139.43.190.250", "US", 1 );
    tests++; errors += test_is_from_valid_country( "139.43.190.250", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "139.43.190.250", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "139.43.190.250", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "139.43.190.250", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:171b:a04b:84c5:18bf:1323:edbb:28a1", "CH", 1 );
    tests++; errors += test_is_from_valid_country( "2001:171b:a04b:84c5:18bf:1323:edbb:28a1", "XX,CH,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:171b:a04b:84c5:18bf:1323:edbb:28a1", "CH,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:171b:a04b:84c5:18bf:1323:edbb:28a1", "XX,YY,CH", 1 );
    tests++; errors += test_is_from_valid_country( "2001:171b:a04b:84c5:18bf:1323:edbb:28a1", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "100.56.132.31", "US", 1 );
    tests++; errors += test_is_from_valid_country( "100.56.132.31", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "100.56.132.31", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "100.56.132.31", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "100.56.132.31", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "199.137.148.17", "US", 1 );
    tests++; errors += test_is_from_valid_country( "199.137.148.17", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "199.137.148.17", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "199.137.148.17", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "199.137.148.17", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:51f3:c6f6:df52:a21c:870d:cb48:ed1d", "EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:51f3:c6f6:df52:a21c:870d:cb48:ed1d", "XX,EU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:51f3:c6f6:df52:a21c:870d:cb48:ed1d", "EU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:51f3:c6f6:df52:a21c:870d:cb48:ed1d", "XX,YY,EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:51f3:c6f6:df52:a21c:870d:cb48:ed1d", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:a097:eb5d:2702:856f:316b:a969:7d85", "JP", 1 );
    tests++; errors += test_is_from_valid_country( "2001:a097:eb5d:2702:856f:316b:a969:7d85", "XX,JP,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:a097:eb5d:2702:856f:316b:a969:7d85", "JP,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:a097:eb5d:2702:856f:316b:a969:7d85", "XX,YY,JP", 1 );
    tests++; errors += test_is_from_valid_country( "2001:a097:eb5d:2702:856f:316b:a969:7d85", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "109.46.167.252", "DE", 1 );
    tests++; errors += test_is_from_valid_country( "109.46.167.252", "XX,DE,YY", 1 );
    tests++; errors += test_is_from_valid_country( "109.46.167.252", "DE,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "109.46.167.252", "XX,YY,DE", 1 );
    tests++; errors += test_is_from_valid_country( "109.46.167.252", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "17.173.102.235", "US", 1 );
    tests++; errors += test_is_from_valid_country( "17.173.102.235", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "17.173.102.235", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "17.173.102.235", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "17.173.102.235", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "152.94.162.96", "NO", 1 );
    tests++; errors += test_is_from_valid_country( "152.94.162.96", "XX,NO,YY", 1 );
    tests++; errors += test_is_from_valid_country( "152.94.162.96", "NO,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "152.94.162.96", "XX,YY,NO", 1 );
    tests++; errors += test_is_from_valid_country( "152.94.162.96", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "1.99.139.234", "KR", 1 );
    tests++; errors += test_is_from_valid_country( "1.99.139.234", "XX,KR,YY", 1 );
    tests++; errors += test_is_from_valid_country( "1.99.139.234", "KR,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "1.99.139.234", "XX,YY,KR", 1 );
    tests++; errors += test_is_from_valid_country( "1.99.139.234", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "53.167.178.36", "DE", 1 );
    tests++; errors += test_is_from_valid_country( "53.167.178.36", "XX,DE,YY", 1 );
    tests++; errors += test_is_from_valid_country( "53.167.178.36", "DE,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "53.167.178.36", "XX,YY,DE", 1 );
    tests++; errors += test_is_from_valid_country( "53.167.178.36", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "99.127.45.70", "US", 1 );
    tests++; errors += test_is_from_valid_country( "99.127.45.70", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "99.127.45.70", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "99.127.45.70", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "99.127.45.70", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "190.147.197.174", "CO", 1 );
    tests++; errors += test_is_from_valid_country( "190.147.197.174", "XX,CO,YY", 1 );
    tests++; errors += test_is_from_valid_country( "190.147.197.174", "CO,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "190.147.197.174", "XX,YY,CO", 1 );
    tests++; errors += test_is_from_valid_country( "190.147.197.174", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "114.52.120.149", "KR", 1 );
    tests++; errors += test_is_from_valid_country( "114.52.120.149", "XX,KR,YY", 1 );
    tests++; errors += test_is_from_valid_country( "114.52.120.149", "KR,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "114.52.120.149", "XX,YY,KR", 1 );
    tests++; errors += test_is_from_valid_country( "114.52.120.149", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "164.51.87.87", "US", 1 );
    tests++; errors += test_is_from_valid_country( "164.51.87.87", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "164.51.87.87", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "164.51.87.87", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "164.51.87.87", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "60.203.249.125", "CN", 1 );
    tests++; errors += test_is_from_valid_country( "60.203.249.125", "XX,CN,YY", 1 );
    tests++; errors += test_is_from_valid_country( "60.203.249.125", "CN,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "60.203.249.125", "XX,YY,CN", 1 );
    tests++; errors += test_is_from_valid_country( "60.203.249.125", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "208.27.3.44", "US", 1 );
    tests++; errors += test_is_from_valid_country( "208.27.3.44", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "208.27.3.44", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "208.27.3.44", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "208.27.3.44", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "143.209.210.115", "US", 1 );
    tests++; errors += test_is_from_valid_country( "143.209.210.115", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "143.209.210.115", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "143.209.210.115", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "143.209.210.115", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "24.80.12.210", "CA", 1 );
    tests++; errors += test_is_from_valid_country( "24.80.12.210", "XX,CA,YY", 1 );
    tests++; errors += test_is_from_valid_country( "24.80.12.210", "CA,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "24.80.12.210", "XX,YY,CA", 1 );
    tests++; errors += test_is_from_valid_country( "24.80.12.210", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "78.123.237.141", "FR", 1 );
    tests++; errors += test_is_from_valid_country( "78.123.237.141", "XX,FR,YY", 1 );
    tests++; errors += test_is_from_valid_country( "78.123.237.141", "FR,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "78.123.237.141", "XX,YY,FR", 1 );
    tests++; errors += test_is_from_valid_country( "78.123.237.141", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "164.48.120.242", "SE", 1 );
    tests++; errors += test_is_from_valid_country( "164.48.120.242", "XX,SE,YY", 1 );
    tests++; errors += test_is_from_valid_country( "164.48.120.242", "SE,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "164.48.120.242", "XX,YY,SE", 1 );
    tests++; errors += test_is_from_valid_country( "164.48.120.242", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:2b8b:2832:3665:c039:392e:3a29:9e18", "EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:2b8b:2832:3665:c039:392e:3a29:9e18", "XX,EU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:2b8b:2832:3665:c039:392e:3a29:9e18", "EU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:2b8b:2832:3665:c039:392e:3a29:9e18", "XX,YY,EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:2b8b:2832:3665:c039:392e:3a29:9e18", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "216.208.118.64", "CA", 1 );
    tests++; errors += test_is_from_valid_country( "216.208.118.64", "XX,CA,YY", 1 );
    tests++; errors += test_is_from_valid_country( "216.208.118.64", "CA,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "216.208.118.64", "XX,YY,CA", 1 );
    tests++; errors += test_is_from_valid_country( "216.208.118.64", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "217.238.15.249", "DE", 1 );
    tests++; errors += test_is_from_valid_country( "217.238.15.249", "XX,DE,YY", 1 );
    tests++; errors += test_is_from_valid_country( "217.238.15.249", "DE,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "217.238.15.249", "XX,YY,DE", 1 );
    tests++; errors += test_is_from_valid_country( "217.238.15.249", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "75.136.2.139", "US", 1 );
    tests++; errors += test_is_from_valid_country( "75.136.2.139", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "75.136.2.139", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "75.136.2.139", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "75.136.2.139", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "210.50.228.13", "AU", 1 );
    tests++; errors += test_is_from_valid_country( "210.50.228.13", "XX,AU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "210.50.228.13", "AU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "210.50.228.13", "XX,YY,AU", 1 );
    tests++; errors += test_is_from_valid_country( "210.50.228.13", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "35.31.186.150", "US", 1 );
    tests++; errors += test_is_from_valid_country( "35.31.186.150", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "35.31.186.150", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "35.31.186.150", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "35.31.186.150", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "38.25.79.43", "US", 1 );
    tests++; errors += test_is_from_valid_country( "38.25.79.43", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "38.25.79.43", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "38.25.79.43", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "38.25.79.43", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "215.122.118.167", "US", 1 );
    tests++; errors += test_is_from_valid_country( "215.122.118.167", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "215.122.118.167", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "215.122.118.167", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "215.122.118.167", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "56.206.130.189", "US", 1 );
    tests++; errors += test_is_from_valid_country( "56.206.130.189", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "56.206.130.189", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "56.206.130.189", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "56.206.130.189", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "160.186.105.227", "JP", 1 );
    tests++; errors += test_is_from_valid_country( "160.186.105.227", "XX,JP,YY", 1 );
    tests++; errors += test_is_from_valid_country( "160.186.105.227", "JP,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "160.186.105.227", "XX,YY,JP", 1 );
    tests++; errors += test_is_from_valid_country( "160.186.105.227", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "29.237.64.238", "US", 1 );
    tests++; errors += test_is_from_valid_country( "29.237.64.238", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "29.237.64.238", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "29.237.64.238", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "29.237.64.238", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "35.208.3.21", "US", 1 );
    tests++; errors += test_is_from_valid_country( "35.208.3.21", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "35.208.3.21", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "35.208.3.21", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "35.208.3.21", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "41.198.84.37", "MU", 1 );
    tests++; errors += test_is_from_valid_country( "41.198.84.37", "XX,MU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "41.198.84.37", "MU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "41.198.84.37", "XX,YY,MU", 1 );
    tests++; errors += test_is_from_valid_country( "41.198.84.37", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "136.37.48.245", "US", 1 );
    tests++; errors += test_is_from_valid_country( "136.37.48.245", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "136.37.48.245", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "136.37.48.245", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "136.37.48.245", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "74.17.121.17", "US", 1 );
    tests++; errors += test_is_from_valid_country( "74.17.121.17", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "74.17.121.17", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "74.17.121.17", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "74.17.121.17", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "60.2.198.64", "CN", 1 );
    tests++; errors += test_is_from_valid_country( "60.2.198.64", "XX,CN,YY", 1 );
    tests++; errors += test_is_from_valid_country( "60.2.198.64", "CN,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "60.2.198.64", "XX,YY,CN", 1 );
    tests++; errors += test_is_from_valid_country( "60.2.198.64", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "157.57.23.232", "US", 1 );
    tests++; errors += test_is_from_valid_country( "157.57.23.232", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "157.57.23.232", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "157.57.23.232", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "157.57.23.232", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "94.0.113.56", "GB", 1 );
    tests++; errors += test_is_from_valid_country( "94.0.113.56", "XX,GB,YY", 1 );
    tests++; errors += test_is_from_valid_country( "94.0.113.56", "GB,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "94.0.113.56", "XX,YY,GB", 1 );
    tests++; errors += test_is_from_valid_country( "94.0.113.56", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "87.194.72.184", "GB", 1 );
    tests++; errors += test_is_from_valid_country( "87.194.72.184", "XX,GB,YY", 1 );
    tests++; errors += test_is_from_valid_country( "87.194.72.184", "GB,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "87.194.72.184", "XX,YY,GB", 1 );
    tests++; errors += test_is_from_valid_country( "87.194.72.184", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "27.236.35.228", "KR", 1 );
    tests++; errors += test_is_from_valid_country( "27.236.35.228", "XX,KR,YY", 1 );
    tests++; errors += test_is_from_valid_country( "27.236.35.228", "KR,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "27.236.35.228", "XX,YY,KR", 1 );
    tests++; errors += test_is_from_valid_country( "27.236.35.228", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:247e:ce73:1e4a:5200:4fe1:a3aa:e092", "EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:247e:ce73:1e4a:5200:4fe1:a3aa:e092", "XX,EU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:247e:ce73:1e4a:5200:4fe1:a3aa:e092", "EU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:247e:ce73:1e4a:5200:4fe1:a3aa:e092", "XX,YY,EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:247e:ce73:1e4a:5200:4fe1:a3aa:e092", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "143.215.38.120", "US", 1 );
    tests++; errors += test_is_from_valid_country( "143.215.38.120", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "143.215.38.120", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "143.215.38.120", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "143.215.38.120", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "49.237.90.6", "TH", 1 );
    tests++; errors += test_is_from_valid_country( "49.237.90.6", "XX,TH,YY", 1 );
    tests++; errors += test_is_from_valid_country( "49.237.90.6", "TH,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "49.237.90.6", "XX,YY,TH", 1 );
    tests++; errors += test_is_from_valid_country( "49.237.90.6", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:8e1d:d0ea:3bc8:bd72:599a:3d0e:00d7", "AU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:8e1d:d0ea:3bc8:bd72:599a:3d0e:00d7", "XX,AU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:8e1d:d0ea:3bc8:bd72:599a:3d0e:00d7", "AU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:8e1d:d0ea:3bc8:bd72:599a:3d0e:00d7", "XX,YY,AU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:8e1d:d0ea:3bc8:bd72:599a:3d0e:00d7", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "183.188.218.63", "CN", 1 );
    tests++; errors += test_is_from_valid_country( "183.188.218.63", "XX,CN,YY", 1 );
    tests++; errors += test_is_from_valid_country( "183.188.218.63", "CN,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "183.188.218.63", "XX,YY,CN", 1 );
    tests++; errors += test_is_from_valid_country( "183.188.218.63", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "181.173.222.14", "CL", 1 );
    tests++; errors += test_is_from_valid_country( "181.173.222.14", "XX,CL,YY", 1 );
    tests++; errors += test_is_from_valid_country( "181.173.222.14", "CL,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "181.173.222.14", "XX,YY,CL", 1 );
    tests++; errors += test_is_from_valid_country( "181.173.222.14", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:2c2f:348b:7c75:ef3f:66c6:cf1d:e1be", "EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:2c2f:348b:7c75:ef3f:66c6:cf1d:e1be", "XX,EU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:2c2f:348b:7c75:ef3f:66c6:cf1d:e1be", "EU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:2c2f:348b:7c75:ef3f:66c6:cf1d:e1be", "XX,YY,EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:2c2f:348b:7c75:ef3f:66c6:cf1d:e1be", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "182.16.227.232", "JP", 1 );
    tests++; errors += test_is_from_valid_country( "182.16.227.232", "XX,JP,YY", 1 );
    tests++; errors += test_is_from_valid_country( "182.16.227.232", "JP,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "182.16.227.232", "XX,YY,JP", 1 );
    tests++; errors += test_is_from_valid_country( "182.16.227.232", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "73.84.144.73", "US", 1 );
    tests++; errors += test_is_from_valid_country( "73.84.144.73", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "73.84.144.73", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "73.84.144.73", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "73.84.144.73", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "28.163.230.19", "US", 1 );
    tests++; errors += test_is_from_valid_country( "28.163.230.19", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "28.163.230.19", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "28.163.230.19", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "28.163.230.19", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "29.92.155.179", "US", 1 );
    tests++; errors += test_is_from_valid_country( "29.92.155.179", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "29.92.155.179", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "29.92.155.179", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "29.92.155.179", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "212.177.69.41", "IT", 1 );
    tests++; errors += test_is_from_valid_country( "212.177.69.41", "XX,IT,YY", 1 );
    tests++; errors += test_is_from_valid_country( "212.177.69.41", "IT,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "212.177.69.41", "XX,YY,IT", 1 );
    tests++; errors += test_is_from_valid_country( "212.177.69.41", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "178.220.174.243", "RS", 1 );
    tests++; errors += test_is_from_valid_country( "178.220.174.243", "XX,RS,YY", 1 );
    tests++; errors += test_is_from_valid_country( "178.220.174.243", "RS,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "178.220.174.243", "XX,YY,RS", 1 );
    tests++; errors += test_is_from_valid_country( "178.220.174.243", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "220.25.87.204", "JP", 1 );
    tests++; errors += test_is_from_valid_country( "220.25.87.204", "XX,JP,YY", 1 );
    tests++; errors += test_is_from_valid_country( "220.25.87.204", "JP,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "220.25.87.204", "XX,YY,JP", 1 );
    tests++; errors += test_is_from_valid_country( "220.25.87.204", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "84.168.113.14", "DE", 1 );
    tests++; errors += test_is_from_valid_country( "84.168.113.14", "XX,DE,YY", 1 );
    tests++; errors += test_is_from_valid_country( "84.168.113.14", "DE,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "84.168.113.14", "XX,YY,DE", 1 );
    tests++; errors += test_is_from_valid_country( "84.168.113.14", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:2346:8f53:35c9:605d:826c:e18c:f6ec", "EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:2346:8f53:35c9:605d:826c:e18c:f6ec", "XX,EU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:2346:8f53:35c9:605d:826c:e18c:f6ec", "EU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:2346:8f53:35c9:605d:826c:e18c:f6ec", "XX,YY,EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:2346:8f53:35c9:605d:826c:e18c:f6ec", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "214.40.149.123", "US", 1 );
    tests++; errors += test_is_from_valid_country( "214.40.149.123", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "214.40.149.123", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "214.40.149.123", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "214.40.149.123", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "111.63.92.52", "CN", 1 );
    tests++; errors += test_is_from_valid_country( "111.63.92.52", "XX,CN,YY", 1 );
    tests++; errors += test_is_from_valid_country( "111.63.92.52", "CN,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "111.63.92.52", "XX,YY,CN", 1 );
    tests++; errors += test_is_from_valid_country( "111.63.92.52", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "182.95.125.101", "IN", 1 );
    tests++; errors += test_is_from_valid_country( "182.95.125.101", "XX,IN,YY", 1 );
    tests++; errors += test_is_from_valid_country( "182.95.125.101", "IN,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "182.95.125.101", "XX,YY,IN", 1 );
    tests++; errors += test_is_from_valid_country( "182.95.125.101", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "145.29.169.0", "NL", 1 );
    tests++; errors += test_is_from_valid_country( "145.29.169.0", "XX,NL,YY", 1 );
    tests++; errors += test_is_from_valid_country( "145.29.169.0", "NL,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "145.29.169.0", "XX,YY,NL", 1 );
    tests++; errors += test_is_from_valid_country( "145.29.169.0", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "152.138.30.61", "US", 1 );
    tests++; errors += test_is_from_valid_country( "152.138.30.61", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "152.138.30.61", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "152.138.30.61", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "152.138.30.61", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:26a3:ba01:c5e9:c36e:096c:13b9:2727", "EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:26a3:ba01:c5e9:c36e:096c:13b9:2727", "XX,EU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:26a3:ba01:c5e9:c36e:096c:13b9:2727", "EU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:26a3:ba01:c5e9:c36e:096c:13b9:2727", "XX,YY,EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:26a3:ba01:c5e9:c36e:096c:13b9:2727", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "189.76.205.143", "BR", 1 );
    tests++; errors += test_is_from_valid_country( "189.76.205.143", "XX,BR,YY", 1 );
    tests++; errors += test_is_from_valid_country( "189.76.205.143", "BR,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "189.76.205.143", "XX,YY,BR", 1 );
    tests++; errors += test_is_from_valid_country( "189.76.205.143", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "146.218.217.234", "US", 1 );
    tests++; errors += test_is_from_valid_country( "146.218.217.234", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "146.218.217.234", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "146.218.217.234", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "146.218.217.234", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "54.79.1.62", "US", 1 );
    tests++; errors += test_is_from_valid_country( "54.79.1.62", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "54.79.1.62", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "54.79.1.62", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "54.79.1.62", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:b34d:b4df:5c6b:c73a:08d8:40ea:e4b0", "TW", 1 );
    tests++; errors += test_is_from_valid_country( "2001:b34d:b4df:5c6b:c73a:08d8:40ea:e4b0", "XX,TW,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:b34d:b4df:5c6b:c73a:08d8:40ea:e4b0", "TW,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:b34d:b4df:5c6b:c73a:08d8:40ea:e4b0", "XX,YY,TW", 1 );
    tests++; errors += test_is_from_valid_country( "2001:b34d:b4df:5c6b:c73a:08d8:40ea:e4b0", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "205.130.205.165", "US", 1 );
    tests++; errors += test_is_from_valid_country( "205.130.205.165", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "205.130.205.165", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "205.130.205.165", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "205.130.205.165", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "77.85.147.13", "BG", 1 );
    tests++; errors += test_is_from_valid_country( "77.85.147.13", "XX,BG,YY", 1 );
    tests++; errors += test_is_from_valid_country( "77.85.147.13", "BG,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "77.85.147.13", "XX,YY,BG", 1 );
    tests++; errors += test_is_from_valid_country( "77.85.147.13", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "149.48.181.224", "US", 1 );
    tests++; errors += test_is_from_valid_country( "149.48.181.224", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "149.48.181.224", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "149.48.181.224", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "149.48.181.224", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "94.148.195.51", "DK", 1 );
    tests++; errors += test_is_from_valid_country( "94.148.195.51", "XX,DK,YY", 1 );
    tests++; errors += test_is_from_valid_country( "94.148.195.51", "DK,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "94.148.195.51", "XX,YY,DK", 1 );
    tests++; errors += test_is_from_valid_country( "94.148.195.51", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "72.252.137.161", "JM", 1 );
    tests++; errors += test_is_from_valid_country( "72.252.137.161", "XX,JM,YY", 1 );
    tests++; errors += test_is_from_valid_country( "72.252.137.161", "JM,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "72.252.137.161", "XX,YY,JM", 1 );
    tests++; errors += test_is_from_valid_country( "72.252.137.161", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:a306:88cf:36ee:4a3d:333f:70fa:3702", "JP", 1 );
    tests++; errors += test_is_from_valid_country( "2001:a306:88cf:36ee:4a3d:333f:70fa:3702", "XX,JP,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:a306:88cf:36ee:4a3d:333f:70fa:3702", "JP,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:a306:88cf:36ee:4a3d:333f:70fa:3702", "XX,YY,JP", 1 );
    tests++; errors += test_is_from_valid_country( "2001:a306:88cf:36ee:4a3d:333f:70fa:3702", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:848a:2edc:1d10:befe:2194:6930:0d91", "AU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:848a:2edc:1d10:befe:2194:6930:0d91", "XX,AU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:848a:2edc:1d10:befe:2194:6930:0d91", "AU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:848a:2edc:1d10:befe:2194:6930:0d91", "XX,YY,AU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:848a:2edc:1d10:befe:2194:6930:0d91", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "76.165.103.5", "US", 1 );
    tests++; errors += test_is_from_valid_country( "76.165.103.5", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "76.165.103.5", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "76.165.103.5", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "76.165.103.5", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "177.35.103.97", "BR", 1 );
    tests++; errors += test_is_from_valid_country( "177.35.103.97", "XX,BR,YY", 1 );
    tests++; errors += test_is_from_valid_country( "177.35.103.97", "BR,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "177.35.103.97", "XX,YY,BR", 1 );
    tests++; errors += test_is_from_valid_country( "177.35.103.97", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "63.238.69.14", "US", 1 );
    tests++; errors += test_is_from_valid_country( "63.238.69.14", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "63.238.69.14", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "63.238.69.14", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "63.238.69.14", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "50.137.246.189", "US", 1 );
    tests++; errors += test_is_from_valid_country( "50.137.246.189", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "50.137.246.189", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "50.137.246.189", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "50.137.246.189", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "150.229.208.119", "AU", 1 );
    tests++; errors += test_is_from_valid_country( "150.229.208.119", "XX,AU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "150.229.208.119", "AU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "150.229.208.119", "XX,YY,AU", 1 );
    tests++; errors += test_is_from_valid_country( "150.229.208.119", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "114.87.18.225", "CN", 1 );
    tests++; errors += test_is_from_valid_country( "114.87.18.225", "XX,CN,YY", 1 );
    tests++; errors += test_is_from_valid_country( "114.87.18.225", "CN,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "114.87.18.225", "XX,YY,CN", 1 );
    tests++; errors += test_is_from_valid_country( "114.87.18.225", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "26.179.58.208", "US", 1 );
    tests++; errors += test_is_from_valid_country( "26.179.58.208", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "26.179.58.208", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "26.179.58.208", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "26.179.58.208", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "189.41.252.42", "BR", 1 );
    tests++; errors += test_is_from_valid_country( "189.41.252.42", "XX,BR,YY", 1 );
    tests++; errors += test_is_from_valid_country( "189.41.252.42", "BR,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "189.41.252.42", "XX,YY,BR", 1 );
    tests++; errors += test_is_from_valid_country( "189.41.252.42", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "61.169.208.132", "CN", 1 );
    tests++; errors += test_is_from_valid_country( "61.169.208.132", "XX,CN,YY", 1 );
    tests++; errors += test_is_from_valid_country( "61.169.208.132", "CN,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "61.169.208.132", "XX,YY,CN", 1 );
    tests++; errors += test_is_from_valid_country( "61.169.208.132", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:28f5:4e75:357b:fef8:fb74:e5b8:2dc9", "EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:28f5:4e75:357b:fef8:fb74:e5b8:2dc9", "XX,EU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:28f5:4e75:357b:fef8:fb74:e5b8:2dc9", "EU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:28f5:4e75:357b:fef8:fb74:e5b8:2dc9", "XX,YY,EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:28f5:4e75:357b:fef8:fb74:e5b8:2dc9", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:5392:d78b:3fbf:1b39:6092:bb35:69b1", "EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:5392:d78b:3fbf:1b39:6092:bb35:69b1", "XX,EU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:5392:d78b:3fbf:1b39:6092:bb35:69b1", "EU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:5392:d78b:3fbf:1b39:6092:bb35:69b1", "XX,YY,EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:5392:d78b:3fbf:1b39:6092:bb35:69b1", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "178.202.67.219", "DE", 1 );
    tests++; errors += test_is_from_valid_country( "178.202.67.219", "XX,DE,YY", 1 );
    tests++; errors += test_is_from_valid_country( "178.202.67.219", "DE,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "178.202.67.219", "XX,YY,DE", 1 );
    tests++; errors += test_is_from_valid_country( "178.202.67.219", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "172.193.221.248", "US", 1 );
    tests++; errors += test_is_from_valid_country( "172.193.221.248", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "172.193.221.248", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "172.193.221.248", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "172.193.221.248", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "53.225.246.121", "DE", 1 );
    tests++; errors += test_is_from_valid_country( "53.225.246.121", "XX,DE,YY", 1 );
    tests++; errors += test_is_from_valid_country( "53.225.246.121", "DE,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "53.225.246.121", "XX,YY,DE", 1 );
    tests++; errors += test_is_from_valid_country( "53.225.246.121", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:81fc:6030:0fab:6fec:f319:4ca3:ff3f", "AU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:81fc:6030:0fab:6fec:f319:4ca3:ff3f", "XX,AU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:81fc:6030:0fab:6fec:f319:4ca3:ff3f", "AU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:81fc:6030:0fab:6fec:f319:4ca3:ff3f", "XX,YY,AU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:81fc:6030:0fab:6fec:f319:4ca3:ff3f", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "5.93.62.119", "IT", 1 );
    tests++; errors += test_is_from_valid_country( "5.93.62.119", "XX,IT,YY", 1 );
    tests++; errors += test_is_from_valid_country( "5.93.62.119", "IT,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "5.93.62.119", "XX,YY,IT", 1 );
    tests++; errors += test_is_from_valid_country( "5.93.62.119", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "223.228.108.177", "IN", 1 );
    tests++; errors += test_is_from_valid_country( "223.228.108.177", "XX,IN,YY", 1 );
    tests++; errors += test_is_from_valid_country( "223.228.108.177", "IN,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "223.228.108.177", "XX,YY,IN", 1 );
    tests++; errors += test_is_from_valid_country( "223.228.108.177", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "64.6.148.92", "US", 1 );
    tests++; errors += test_is_from_valid_country( "64.6.148.92", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "64.6.148.92", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "64.6.148.92", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "64.6.148.92", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "51.127.169.82", "GB", 1 );
    tests++; errors += test_is_from_valid_country( "51.127.169.82", "XX,GB,YY", 1 );
    tests++; errors += test_is_from_valid_country( "51.127.169.82", "GB,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "51.127.169.82", "XX,YY,GB", 1 );
    tests++; errors += test_is_from_valid_country( "51.127.169.82", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:5523:3ecf:85c5:276c:ca06:4a23:b36e", "EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:5523:3ecf:85c5:276c:ca06:4a23:b36e", "XX,EU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:5523:3ecf:85c5:276c:ca06:4a23:b36e", "EU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:5523:3ecf:85c5:276c:ca06:4a23:b36e", "XX,YY,EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:5523:3ecf:85c5:276c:ca06:4a23:b36e", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "3.68.241.144", "US", 1 );
    tests++; errors += test_is_from_valid_country( "3.68.241.144", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "3.68.241.144", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "3.68.241.144", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "3.68.241.144", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "140.168.10.42", "AU", 1 );
    tests++; errors += test_is_from_valid_country( "140.168.10.42", "XX,AU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "140.168.10.42", "AU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "140.168.10.42", "XX,YY,AU", 1 );
    tests++; errors += test_is_from_valid_country( "140.168.10.42", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "84.210.251.251", "NO", 1 );
    tests++; errors += test_is_from_valid_country( "84.210.251.251", "XX,NO,YY", 1 );
    tests++; errors += test_is_from_valid_country( "84.210.251.251", "NO,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "84.210.251.251", "XX,YY,NO", 1 );
    tests++; errors += test_is_from_valid_country( "84.210.251.251", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:86b0:3868:6df7:580f:300a:e727:bb40", "AU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:86b0:3868:6df7:580f:300a:e727:bb40", "XX,AU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:86b0:3868:6df7:580f:300a:e727:bb40", "AU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:86b0:3868:6df7:580f:300a:e727:bb40", "XX,YY,AU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:86b0:3868:6df7:580f:300a:e727:bb40", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "150.211.125.88", "US", 1 );
    tests++; errors += test_is_from_valid_country( "150.211.125.88", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "150.211.125.88", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "150.211.125.88", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "150.211.125.88", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "79.131.224.122", "GR", 1 );
    tests++; errors += test_is_from_valid_country( "79.131.224.122", "XX,GR,YY", 1 );
    tests++; errors += test_is_from_valid_country( "79.131.224.122", "GR,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "79.131.224.122", "XX,YY,GR", 1 );
    tests++; errors += test_is_from_valid_country( "79.131.224.122", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "198.120.244.63", "US", 1 );
    tests++; errors += test_is_from_valid_country( "198.120.244.63", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "198.120.244.63", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "198.120.244.63", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "198.120.244.63", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "66.65.227.165", "US", 1 );
    tests++; errors += test_is_from_valid_country( "66.65.227.165", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "66.65.227.165", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "66.65.227.165", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "66.65.227.165", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "46.55.156.135", "BG", 1 );
    tests++; errors += test_is_from_valid_country( "46.55.156.135", "XX,BG,YY", 1 );
    tests++; errors += test_is_from_valid_country( "46.55.156.135", "BG,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "46.55.156.135", "XX,YY,BG", 1 );
    tests++; errors += test_is_from_valid_country( "46.55.156.135", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "140.93.166.242", "FR", 1 );
    tests++; errors += test_is_from_valid_country( "140.93.166.242", "XX,FR,YY", 1 );
    tests++; errors += test_is_from_valid_country( "140.93.166.242", "FR,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "140.93.166.242", "XX,YY,FR", 1 );
    tests++; errors += test_is_from_valid_country( "140.93.166.242", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "202.37.246.7", "NZ", 1 );
    tests++; errors += test_is_from_valid_country( "202.37.246.7", "XX,NZ,YY", 1 );
    tests++; errors += test_is_from_valid_country( "202.37.246.7", "NZ,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "202.37.246.7", "XX,YY,NZ", 1 );
    tests++; errors += test_is_from_valid_country( "202.37.246.7", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "118.219.97.103", "KR", 1 );
    tests++; errors += test_is_from_valid_country( "118.219.97.103", "XX,KR,YY", 1 );
    tests++; errors += test_is_from_valid_country( "118.219.97.103", "KR,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "118.219.97.103", "XX,YY,KR", 1 );
    tests++; errors += test_is_from_valid_country( "118.219.97.103", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "145.23.108.122", "NL", 1 );
    tests++; errors += test_is_from_valid_country( "145.23.108.122", "XX,NL,YY", 1 );
    tests++; errors += test_is_from_valid_country( "145.23.108.122", "NL,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "145.23.108.122", "XX,YY,NL", 1 );
    tests++; errors += test_is_from_valid_country( "145.23.108.122", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2.211.235.125", "DE", 1 );
    tests++; errors += test_is_from_valid_country( "2.211.235.125", "XX,DE,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2.211.235.125", "DE,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2.211.235.125", "XX,YY,DE", 1 );
    tests++; errors += test_is_from_valid_country( "2.211.235.125", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:5468:909e:23f8:e174:f1bf:8aa6:d661", "EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:5468:909e:23f8:e174:f1bf:8aa6:d661", "XX,EU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:5468:909e:23f8:e174:f1bf:8aa6:d661", "EU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:5468:909e:23f8:e174:f1bf:8aa6:d661", "XX,YY,EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:5468:909e:23f8:e174:f1bf:8aa6:d661", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "143.139.223.79", "US", 1 );
    tests++; errors += test_is_from_valid_country( "143.139.223.79", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "143.139.223.79", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "143.139.223.79", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "143.139.223.79", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "4.114.12.80", "US", 1 );
    tests++; errors += test_is_from_valid_country( "4.114.12.80", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "4.114.12.80", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "4.114.12.80", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "4.114.12.80", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "193.10.0.36", "SE", 1 );
    tests++; errors += test_is_from_valid_country( "193.10.0.36", "XX,SE,YY", 1 );
    tests++; errors += test_is_from_valid_country( "193.10.0.36", "SE,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "193.10.0.36", "XX,YY,SE", 1 );
    tests++; errors += test_is_from_valid_country( "193.10.0.36", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "18.112.160.225", "US", 1 );
    tests++; errors += test_is_from_valid_country( "18.112.160.225", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "18.112.160.225", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "18.112.160.225", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "18.112.160.225", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "41.91.102.107", "EG", 1 );
    tests++; errors += test_is_from_valid_country( "41.91.102.107", "XX,EG,YY", 1 );
    tests++; errors += test_is_from_valid_country( "41.91.102.107", "EG,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "41.91.102.107", "XX,YY,EG", 1 );
    tests++; errors += test_is_from_valid_country( "41.91.102.107", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:a32a:7d1f:2995:8bd9:0574:3fff:ccc2", "JP", 1 );
    tests++; errors += test_is_from_valid_country( "2001:a32a:7d1f:2995:8bd9:0574:3fff:ccc2", "XX,JP,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:a32a:7d1f:2995:8bd9:0574:3fff:ccc2", "JP,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:a32a:7d1f:2995:8bd9:0574:3fff:ccc2", "XX,YY,JP", 1 );
    tests++; errors += test_is_from_valid_country( "2001:a32a:7d1f:2995:8bd9:0574:3fff:ccc2", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "59.192.47.228", "CN", 1 );
    tests++; errors += test_is_from_valid_country( "59.192.47.228", "XX,CN,YY", 1 );
    tests++; errors += test_is_from_valid_country( "59.192.47.228", "CN,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "59.192.47.228", "XX,YY,CN", 1 );
    tests++; errors += test_is_from_valid_country( "59.192.47.228", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "219.218.15.0", "CN", 1 );
    tests++; errors += test_is_from_valid_country( "219.218.15.0", "XX,CN,YY", 1 );
    tests++; errors += test_is_from_valid_country( "219.218.15.0", "CN,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "219.218.15.0", "XX,YY,CN", 1 );
    tests++; errors += test_is_from_valid_country( "219.218.15.0", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "99.118.155.105", "US", 1 );
    tests++; errors += test_is_from_valid_country( "99.118.155.105", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "99.118.155.105", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "99.118.155.105", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "99.118.155.105", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "158.81.97.247", "US", 1 );
    tests++; errors += test_is_from_valid_country( "158.81.97.247", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "158.81.97.247", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "158.81.97.247", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "158.81.97.247", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "214.158.108.233", "US", 1 );
    tests++; errors += test_is_from_valid_country( "214.158.108.233", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "214.158.108.233", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "214.158.108.233", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "214.158.108.233", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "1.231.81.179", "KR", 1 );
    tests++; errors += test_is_from_valid_country( "1.231.81.179", "XX,KR,YY", 1 );
    tests++; errors += test_is_from_valid_country( "1.231.81.179", "KR,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "1.231.81.179", "XX,YY,KR", 1 );
    tests++; errors += test_is_from_valid_country( "1.231.81.179", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "128.234.121.30", "RO", 1 );
    tests++; errors += test_is_from_valid_country( "128.234.121.30", "XX,RO,YY", 1 );
    tests++; errors += test_is_from_valid_country( "128.234.121.30", "RO,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "128.234.121.30", "XX,YY,RO", 1 );
    tests++; errors += test_is_from_valid_country( "128.234.121.30", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "5.119.136.139", "IR", 1 );
    tests++; errors += test_is_from_valid_country( "5.119.136.139", "XX,IR,YY", 1 );
    tests++; errors += test_is_from_valid_country( "5.119.136.139", "IR,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "5.119.136.139", "XX,YY,IR", 1 );
    tests++; errors += test_is_from_valid_country( "5.119.136.139", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:53f6:408a:a4ba:8ff0:6736:594d:6d7a", "EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:53f6:408a:a4ba:8ff0:6736:594d:6d7a", "XX,EU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:53f6:408a:a4ba:8ff0:6736:594d:6d7a", "EU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:53f6:408a:a4ba:8ff0:6736:594d:6d7a", "XX,YY,EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:53f6:408a:a4ba:8ff0:6736:594d:6d7a", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:a40e:35fa:6fcd:abd6:7502:2168:5277", "JP", 1 );
    tests++; errors += test_is_from_valid_country( "2001:a40e:35fa:6fcd:abd6:7502:2168:5277", "XX,JP,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:a40e:35fa:6fcd:abd6:7502:2168:5277", "JP,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:a40e:35fa:6fcd:abd6:7502:2168:5277", "XX,YY,JP", 1 );
    tests++; errors += test_is_from_valid_country( "2001:a40e:35fa:6fcd:abd6:7502:2168:5277", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:2f4b:ad6b:f2ec:6439:1bde:611f:1a87", "EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:2f4b:ad6b:f2ec:6439:1bde:611f:1a87", "XX,EU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:2f4b:ad6b:f2ec:6439:1bde:611f:1a87", "EU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:2f4b:ad6b:f2ec:6439:1bde:611f:1a87", "XX,YY,EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:2f4b:ad6b:f2ec:6439:1bde:611f:1a87", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "47.140.104.107", "CA", 1 );
    tests++; errors += test_is_from_valid_country( "47.140.104.107", "XX,CA,YY", 1 );
    tests++; errors += test_is_from_valid_country( "47.140.104.107", "CA,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "47.140.104.107", "XX,YY,CA", 1 );
    tests++; errors += test_is_from_valid_country( "47.140.104.107", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "223.24.229.83", "TH", 1 );
    tests++; errors += test_is_from_valid_country( "223.24.229.83", "XX,TH,YY", 1 );
    tests++; errors += test_is_from_valid_country( "223.24.229.83", "TH,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "223.24.229.83", "XX,YY,TH", 1 );
    tests++; errors += test_is_from_valid_country( "223.24.229.83", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "92.79.89.82", "DE", 1 );
    tests++; errors += test_is_from_valid_country( "92.79.89.82", "XX,DE,YY", 1 );
    tests++; errors += test_is_from_valid_country( "92.79.89.82", "DE,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "92.79.89.82", "XX,YY,DE", 1 );
    tests++; errors += test_is_from_valid_country( "92.79.89.82", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:882f:4c3e:c788:b583:7031:809c:de92", "AU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:882f:4c3e:c788:b583:7031:809c:de92", "XX,AU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:882f:4c3e:c788:b583:7031:809c:de92", "AU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:882f:4c3e:c788:b583:7031:809c:de92", "XX,YY,AU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:882f:4c3e:c788:b583:7031:809c:de92", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "148.123.226.44", "NO", 1 );
    tests++; errors += test_is_from_valid_country( "148.123.226.44", "XX,NO,YY", 1 );
    tests++; errors += test_is_from_valid_country( "148.123.226.44", "NO,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "148.123.226.44", "XX,YY,NO", 1 );
    tests++; errors += test_is_from_valid_country( "148.123.226.44", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "69.0.13.156", "US", 1 );
    tests++; errors += test_is_from_valid_country( "69.0.13.156", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "69.0.13.156", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "69.0.13.156", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "69.0.13.156", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "96.38.217.119", "US", 1 );
    tests++; errors += test_is_from_valid_country( "96.38.217.119", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "96.38.217.119", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "96.38.217.119", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "96.38.217.119", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "122.215.132.114", "JP", 1 );
    tests++; errors += test_is_from_valid_country( "122.215.132.114", "XX,JP,YY", 1 );
    tests++; errors += test_is_from_valid_country( "122.215.132.114", "JP,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "122.215.132.114", "XX,YY,JP", 1 );
    tests++; errors += test_is_from_valid_country( "122.215.132.114", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "7.247.32.138", "US", 1 );
    tests++; errors += test_is_from_valid_country( "7.247.32.138", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "7.247.32.138", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "7.247.32.138", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "7.247.32.138", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "57.248.192.241", "EU", 1 );
    tests++; errors += test_is_from_valid_country( "57.248.192.241", "XX,EU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "57.248.192.241", "EU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "57.248.192.241", "XX,YY,EU", 1 );
    tests++; errors += test_is_from_valid_country( "57.248.192.241", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "154.51.54.29", "US", 1 );
    tests++; errors += test_is_from_valid_country( "154.51.54.29", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "154.51.54.29", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "154.51.54.29", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "154.51.54.29", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "130.118.199.79", "US", 1 );
    tests++; errors += test_is_from_valid_country( "130.118.199.79", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "130.118.199.79", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "130.118.199.79", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "130.118.199.79", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "184.96.87.165", "US", 1 );
    tests++; errors += test_is_from_valid_country( "184.96.87.165", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "184.96.87.165", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "184.96.87.165", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "184.96.87.165", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:b2be:971c:ef48:f8ae:1f57:a95e:6cc1", "TW", 1 );
    tests++; errors += test_is_from_valid_country( "2001:b2be:971c:ef48:f8ae:1f57:a95e:6cc1", "XX,TW,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:b2be:971c:ef48:f8ae:1f57:a95e:6cc1", "TW,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:b2be:971c:ef48:f8ae:1f57:a95e:6cc1", "XX,YY,TW", 1 );
    tests++; errors += test_is_from_valid_country( "2001:b2be:971c:ef48:f8ae:1f57:a95e:6cc1", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "165.146.173.11", "ZA", 1 );
    tests++; errors += test_is_from_valid_country( "165.146.173.11", "XX,ZA,YY", 1 );
    tests++; errors += test_is_from_valid_country( "165.146.173.11", "ZA,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "165.146.173.11", "XX,YY,ZA", 1 );
    tests++; errors += test_is_from_valid_country( "165.146.173.11", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "19.178.69.84", "US", 1 );
    tests++; errors += test_is_from_valid_country( "19.178.69.84", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "19.178.69.84", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "19.178.69.84", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "19.178.69.84", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "28.72.243.129", "US", 1 );
    tests++; errors += test_is_from_valid_country( "28.72.243.129", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "28.72.243.129", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "28.72.243.129", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "28.72.243.129", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "31.36.125.142", "FR", 1 );
    tests++; errors += test_is_from_valid_country( "31.36.125.142", "XX,FR,YY", 1 );
    tests++; errors += test_is_from_valid_country( "31.36.125.142", "FR,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "31.36.125.142", "XX,YY,FR", 1 );
    tests++; errors += test_is_from_valid_country( "31.36.125.142", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:2d8f:ce9b:0fb4:68bb:6f47:b995:0c8f", "EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:2d8f:ce9b:0fb4:68bb:6f47:b995:0c8f", "XX,EU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:2d8f:ce9b:0fb4:68bb:6f47:b995:0c8f", "EU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:2d8f:ce9b:0fb4:68bb:6f47:b995:0c8f", "XX,YY,EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:2d8f:ce9b:0fb4:68bb:6f47:b995:0c8f", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "7.7.97.73", "US", 1 );
    tests++; errors += test_is_from_valid_country( "7.7.97.73", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "7.7.97.73", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "7.7.97.73", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "7.7.97.73", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "221.1.26.189", "CN", 1 );
    tests++; errors += test_is_from_valid_country( "221.1.26.189", "XX,CN,YY", 1 );
    tests++; errors += test_is_from_valid_country( "221.1.26.189", "CN,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "221.1.26.189", "XX,YY,CN", 1 );
    tests++; errors += test_is_from_valid_country( "221.1.26.189", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "94.2.146.159", "GB", 1 );
    tests++; errors += test_is_from_valid_country( "94.2.146.159", "XX,GB,YY", 1 );
    tests++; errors += test_is_from_valid_country( "94.2.146.159", "GB,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "94.2.146.159", "XX,YY,GB", 1 );
    tests++; errors += test_is_from_valid_country( "94.2.146.159", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:1430:066a:70ab:7550:4d22:701e:d474", "FI", 1 );
    tests++; errors += test_is_from_valid_country( "2001:1430:066a:70ab:7550:4d22:701e:d474", "XX,FI,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:1430:066a:70ab:7550:4d22:701e:d474", "FI,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:1430:066a:70ab:7550:4d22:701e:d474", "XX,YY,FI", 1 );
    tests++; errors += test_is_from_valid_country( "2001:1430:066a:70ab:7550:4d22:701e:d474", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "220.156.109.42", "JP", 1 );
    tests++; errors += test_is_from_valid_country( "220.156.109.42", "XX,JP,YY", 1 );
    tests++; errors += test_is_from_valid_country( "220.156.109.42", "JP,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "220.156.109.42", "XX,YY,JP", 1 );
    tests++; errors += test_is_from_valid_country( "220.156.109.42", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "211.144.136.30", "CN", 1 );
    tests++; errors += test_is_from_valid_country( "211.144.136.30", "XX,CN,YY", 1 );
    tests++; errors += test_is_from_valid_country( "211.144.136.30", "CN,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "211.144.136.30", "XX,YY,CN", 1 );
    tests++; errors += test_is_from_valid_country( "211.144.136.30", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "77.241.67.233", "JO", 1 );
    tests++; errors += test_is_from_valid_country( "77.241.67.233", "XX,JO,YY", 1 );
    tests++; errors += test_is_from_valid_country( "77.241.67.233", "JO,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "77.241.67.233", "XX,YY,JO", 1 );
    tests++; errors += test_is_from_valid_country( "77.241.67.233", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "105.152.150.181", "MA", 1 );
    tests++; errors += test_is_from_valid_country( "105.152.150.181", "XX,MA,YY", 1 );
    tests++; errors += test_is_from_valid_country( "105.152.150.181", "MA,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "105.152.150.181", "XX,YY,MA", 1 );
    tests++; errors += test_is_from_valid_country( "105.152.150.181", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "74.243.75.152", "US", 1 );
    tests++; errors += test_is_from_valid_country( "74.243.75.152", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "74.243.75.152", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "74.243.75.152", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "74.243.75.152", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "3.5.167.191", "US", 1 );
    tests++; errors += test_is_from_valid_country( "3.5.167.191", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "3.5.167.191", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "3.5.167.191", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "3.5.167.191", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:b183:c3e3:9ea5:17f9:df60:89ba:3b49", "TW", 1 );
    tests++; errors += test_is_from_valid_country( "2001:b183:c3e3:9ea5:17f9:df60:89ba:3b49", "XX,TW,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:b183:c3e3:9ea5:17f9:df60:89ba:3b49", "TW,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:b183:c3e3:9ea5:17f9:df60:89ba:3b49", "XX,YY,TW", 1 );
    tests++; errors += test_is_from_valid_country( "2001:b183:c3e3:9ea5:17f9:df60:89ba:3b49", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "46.177.11.230", "GR", 1 );
    tests++; errors += test_is_from_valid_country( "46.177.11.230", "XX,GR,YY", 1 );
    tests++; errors += test_is_from_valid_country( "46.177.11.230", "GR,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "46.177.11.230", "XX,YY,GR", 1 );
    tests++; errors += test_is_from_valid_country( "46.177.11.230", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "124.18.106.209", "JP", 1 );
    tests++; errors += test_is_from_valid_country( "124.18.106.209", "XX,JP,YY", 1 );
    tests++; errors += test_is_from_valid_country( "124.18.106.209", "JP,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "124.18.106.209", "XX,YY,JP", 1 );
    tests++; errors += test_is_from_valid_country( "124.18.106.209", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "85.107.7.102", "TR", 1 );
    tests++; errors += test_is_from_valid_country( "85.107.7.102", "XX,TR,YY", 1 );
    tests++; errors += test_is_from_valid_country( "85.107.7.102", "TR,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "85.107.7.102", "XX,YY,TR", 1 );
    tests++; errors += test_is_from_valid_country( "85.107.7.102", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "136.241.147.85", "US", 1 );
    tests++; errors += test_is_from_valid_country( "136.241.147.85", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "136.241.147.85", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "136.241.147.85", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "136.241.147.85", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "163.54.122.210", "JP", 1 );
    tests++; errors += test_is_from_valid_country( "163.54.122.210", "XX,JP,YY", 1 );
    tests++; errors += test_is_from_valid_country( "163.54.122.210", "JP,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "163.54.122.210", "XX,YY,JP", 1 );
    tests++; errors += test_is_from_valid_country( "163.54.122.210", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "166.150.205.68", "US", 1 );
    tests++; errors += test_is_from_valid_country( "166.150.205.68", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "166.150.205.68", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "166.150.205.68", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "166.150.205.68", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:8f14:1513:4f63:eabb:79be:a415:a9be", "AU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:8f14:1513:4f63:eabb:79be:a415:a9be", "XX,AU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:8f14:1513:4f63:eabb:79be:a415:a9be", "AU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:8f14:1513:4f63:eabb:79be:a415:a9be", "XX,YY,AU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:8f14:1513:4f63:eabb:79be:a415:a9be", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:b3ec:c182:acc3:91dd:7ff3:381f:7180", "TW", 1 );
    tests++; errors += test_is_from_valid_country( "2001:b3ec:c182:acc3:91dd:7ff3:381f:7180", "XX,TW,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:b3ec:c182:acc3:91dd:7ff3:381f:7180", "TW,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:b3ec:c182:acc3:91dd:7ff3:381f:7180", "XX,YY,TW", 1 );
    tests++; errors += test_is_from_valid_country( "2001:b3ec:c182:acc3:91dd:7ff3:381f:7180", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:8a69:05dc:8f34:a64d:9446:a8b9:4f8b", "AU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:8a69:05dc:8f34:a64d:9446:a8b9:4f8b", "XX,AU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:8a69:05dc:8f34:a64d:9446:a8b9:4f8b", "AU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:8a69:05dc:8f34:a64d:9446:a8b9:4f8b", "XX,YY,AU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:8a69:05dc:8f34:a64d:9446:a8b9:4f8b", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "215.119.193.172", "US", 1 );
    tests++; errors += test_is_from_valid_country( "215.119.193.172", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "215.119.193.172", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "215.119.193.172", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "215.119.193.172", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "36.190.181.245", "CN", 1 );
    tests++; errors += test_is_from_valid_country( "36.190.181.245", "XX,CN,YY", 1 );
    tests++; errors += test_is_from_valid_country( "36.190.181.245", "CN,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "36.190.181.245", "XX,YY,CN", 1 );
    tests++; errors += test_is_from_valid_country( "36.190.181.245", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "93.124.210.7", "NO", 1 );
    tests++; errors += test_is_from_valid_country( "93.124.210.7", "XX,NO,YY", 1 );
    tests++; errors += test_is_from_valid_country( "93.124.210.7", "NO,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "93.124.210.7", "XX,YY,NO", 1 );
    tests++; errors += test_is_from_valid_country( "93.124.210.7", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:8faf:debb:730d:1405:2f1f:553f:9361", "AU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:8faf:debb:730d:1405:2f1f:553f:9361", "XX,AU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:8faf:debb:730d:1405:2f1f:553f:9361", "AU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:8faf:debb:730d:1405:2f1f:553f:9361", "XX,YY,AU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:8faf:debb:730d:1405:2f1f:553f:9361", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "155.122.41.102", "US", 1 );
    tests++; errors += test_is_from_valid_country( "155.122.41.102", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "155.122.41.102", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "155.122.41.102", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "155.122.41.102", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "201.66.172.205", "BR", 1 );
    tests++; errors += test_is_from_valid_country( "201.66.172.205", "XX,BR,YY", 1 );
    tests++; errors += test_is_from_valid_country( "201.66.172.205", "BR,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "201.66.172.205", "XX,YY,BR", 1 );
    tests++; errors += test_is_from_valid_country( "201.66.172.205", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "24.233.197.35", "US", 1 );
    tests++; errors += test_is_from_valid_country( "24.233.197.35", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "24.233.197.35", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "24.233.197.35", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "24.233.197.35", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "126.116.169.78", "JP", 1 );
    tests++; errors += test_is_from_valid_country( "126.116.169.78", "XX,JP,YY", 1 );
    tests++; errors += test_is_from_valid_country( "126.116.169.78", "JP,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "126.116.169.78", "XX,YY,JP", 1 );
    tests++; errors += test_is_from_valid_country( "126.116.169.78", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "5.188.243.174", "RU", 1 );
    tests++; errors += test_is_from_valid_country( "5.188.243.174", "XX,RU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "5.188.243.174", "RU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "5.188.243.174", "XX,YY,RU", 1 );
    tests++; errors += test_is_from_valid_country( "5.188.243.174", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:856c:015e:7bca:90db:2c69:e1ee:c92f", "AU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:856c:015e:7bca:90db:2c69:e1ee:c92f", "XX,AU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:856c:015e:7bca:90db:2c69:e1ee:c92f", "AU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:856c:015e:7bca:90db:2c69:e1ee:c92f", "XX,YY,AU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:856c:015e:7bca:90db:2c69:e1ee:c92f", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "73.247.21.235", "US", 1 );
    tests++; errors += test_is_from_valid_country( "73.247.21.235", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "73.247.21.235", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "73.247.21.235", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "73.247.21.235", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "132.212.219.189", "CA", 1 );
    tests++; errors += test_is_from_valid_country( "132.212.219.189", "XX,CA,YY", 1 );
    tests++; errors += test_is_from_valid_country( "132.212.219.189", "CA,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "132.212.219.189", "XX,YY,CA", 1 );
    tests++; errors += test_is_from_valid_country( "132.212.219.189", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "7.117.29.154", "US", 1 );
    tests++; errors += test_is_from_valid_country( "7.117.29.154", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "7.117.29.154", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "7.117.29.154", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "7.117.29.154", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "94.22.134.19", "FI", 1 );
    tests++; errors += test_is_from_valid_country( "94.22.134.19", "XX,FI,YY", 1 );
    tests++; errors += test_is_from_valid_country( "94.22.134.19", "FI,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "94.22.134.19", "XX,YY,FI", 1 );
    tests++; errors += test_is_from_valid_country( "94.22.134.19", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "68.225.47.242", "US", 1 );
    tests++; errors += test_is_from_valid_country( "68.225.47.242", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "68.225.47.242", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "68.225.47.242", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "68.225.47.242", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "124.156.218.167", "CN", 1 );
    tests++; errors += test_is_from_valid_country( "124.156.218.167", "XX,CN,YY", 1 );
    tests++; errors += test_is_from_valid_country( "124.156.218.167", "CN,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "124.156.218.167", "XX,YY,CN", 1 );
    tests++; errors += test_is_from_valid_country( "124.156.218.167", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "63.244.214.122", "US", 1 );
    tests++; errors += test_is_from_valid_country( "63.244.214.122", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "63.244.214.122", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "63.244.214.122", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "63.244.214.122", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "198.99.143.213", "US", 1 );
    tests++; errors += test_is_from_valid_country( "198.99.143.213", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "198.99.143.213", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "198.99.143.213", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "198.99.143.213", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "81.75.140.26", "IT", 1 );
    tests++; errors += test_is_from_valid_country( "81.75.140.26", "XX,IT,YY", 1 );
    tests++; errors += test_is_from_valid_country( "81.75.140.26", "IT,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "81.75.140.26", "XX,YY,IT", 1 );
    tests++; errors += test_is_from_valid_country( "81.75.140.26", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "98.133.134.1", "US", 1 );
    tests++; errors += test_is_from_valid_country( "98.133.134.1", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "98.133.134.1", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "98.133.134.1", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "98.133.134.1", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "216.90.235.55", "US", 1 );
    tests++; errors += test_is_from_valid_country( "216.90.235.55", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "216.90.235.55", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "216.90.235.55", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "216.90.235.55", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:b0cc:ec55:27c5:1707:0891:c608:f7dc", "TW", 1 );
    tests++; errors += test_is_from_valid_country( "2001:b0cc:ec55:27c5:1707:0891:c608:f7dc", "XX,TW,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:b0cc:ec55:27c5:1707:0891:c608:f7dc", "TW,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:b0cc:ec55:27c5:1707:0891:c608:f7dc", "XX,YY,TW", 1 );
    tests++; errors += test_is_from_valid_country( "2001:b0cc:ec55:27c5:1707:0891:c608:f7dc", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "117.116.86.233", "CN", 1 );
    tests++; errors += test_is_from_valid_country( "117.116.86.233", "XX,CN,YY", 1 );
    tests++; errors += test_is_from_valid_country( "117.116.86.233", "CN,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "117.116.86.233", "XX,YY,CN", 1 );
    tests++; errors += test_is_from_valid_country( "117.116.86.233", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "210.104.143.189", "KR", 1 );
    tests++; errors += test_is_from_valid_country( "210.104.143.189", "XX,KR,YY", 1 );
    tests++; errors += test_is_from_valid_country( "210.104.143.189", "KR,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "210.104.143.189", "XX,YY,KR", 1 );
    tests++; errors += test_is_from_valid_country( "210.104.143.189", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "174.113.234.196", "CA", 1 );
    tests++; errors += test_is_from_valid_country( "174.113.234.196", "XX,CA,YY", 1 );
    tests++; errors += test_is_from_valid_country( "174.113.234.196", "CA,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "174.113.234.196", "XX,YY,CA", 1 );
    tests++; errors += test_is_from_valid_country( "174.113.234.196", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "53.230.119.206", "DE", 1 );
    tests++; errors += test_is_from_valid_country( "53.230.119.206", "XX,DE,YY", 1 );
    tests++; errors += test_is_from_valid_country( "53.230.119.206", "DE,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "53.230.119.206", "XX,YY,DE", 1 );
    tests++; errors += test_is_from_valid_country( "53.230.119.206", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "62.204.239.113", "CZ", 1 );
    tests++; errors += test_is_from_valid_country( "62.204.239.113", "XX,CZ,YY", 1 );
    tests++; errors += test_is_from_valid_country( "62.204.239.113", "CZ,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "62.204.239.113", "XX,YY,CZ", 1 );
    tests++; errors += test_is_from_valid_country( "62.204.239.113", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "76.245.51.160", "US", 1 );
    tests++; errors += test_is_from_valid_country( "76.245.51.160", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "76.245.51.160", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "76.245.51.160", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "76.245.51.160", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "155.38.220.40", "US", 1 );
    tests++; errors += test_is_from_valid_country( "155.38.220.40", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "155.38.220.40", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "155.38.220.40", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "155.38.220.40", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "211.107.60.62", "KR", 1 );
    tests++; errors += test_is_from_valid_country( "211.107.60.62", "XX,KR,YY", 1 );
    tests++; errors += test_is_from_valid_country( "211.107.60.62", "KR,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "211.107.60.62", "XX,YY,KR", 1 );
    tests++; errors += test_is_from_valid_country( "211.107.60.62", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:2aa9:4e96:ec22:1205:0cc2:a300:ea18", "EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:2aa9:4e96:ec22:1205:0cc2:a300:ea18", "XX,EU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:2aa9:4e96:ec22:1205:0cc2:a300:ea18", "EU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:2aa9:4e96:ec22:1205:0cc2:a300:ea18", "XX,YY,EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:2aa9:4e96:ec22:1205:0cc2:a300:ea18", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "4.92.131.242", "US", 1 );
    tests++; errors += test_is_from_valid_country( "4.92.131.242", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "4.92.131.242", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "4.92.131.242", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "4.92.131.242", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "96.163.39.105", "US", 1 );
    tests++; errors += test_is_from_valid_country( "96.163.39.105", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "96.163.39.105", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "96.163.39.105", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "96.163.39.105", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:2650:41e4:7faa:198b:9ff5:f450:bfdc", "EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:2650:41e4:7faa:198b:9ff5:f450:bfdc", "XX,EU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:2650:41e4:7faa:198b:9ff5:f450:bfdc", "EU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:2650:41e4:7faa:198b:9ff5:f450:bfdc", "XX,YY,EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:2650:41e4:7faa:198b:9ff5:f450:bfdc", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "202.59.134.242", "BD", 1 );
    tests++; errors += test_is_from_valid_country( "202.59.134.242", "XX,BD,YY", 1 );
    tests++; errors += test_is_from_valid_country( "202.59.134.242", "BD,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "202.59.134.242", "XX,YY,BD", 1 );
    tests++; errors += test_is_from_valid_country( "202.59.134.242", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "125.198.44.31", "JP", 1 );
    tests++; errors += test_is_from_valid_country( "125.198.44.31", "XX,JP,YY", 1 );
    tests++; errors += test_is_from_valid_country( "125.198.44.31", "JP,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "125.198.44.31", "XX,YY,JP", 1 );
    tests++; errors += test_is_from_valid_country( "125.198.44.31", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "109.79.172.93", "IE", 1 );
    tests++; errors += test_is_from_valid_country( "109.79.172.93", "XX,IE,YY", 1 );
    tests++; errors += test_is_from_valid_country( "109.79.172.93", "IE,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "109.79.172.93", "XX,YY,IE", 1 );
    tests++; errors += test_is_from_valid_country( "109.79.172.93", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "55.72.28.126", "US", 1 );
    tests++; errors += test_is_from_valid_country( "55.72.28.126", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "55.72.28.126", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "55.72.28.126", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "55.72.28.126", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "61.128.194.125", "CN", 1 );
    tests++; errors += test_is_from_valid_country( "61.128.194.125", "XX,CN,YY", 1 );
    tests++; errors += test_is_from_valid_country( "61.128.194.125", "CN,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "61.128.194.125", "XX,YY,CN", 1 );
    tests++; errors += test_is_from_valid_country( "61.128.194.125", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "205.34.137.191", "US", 1 );
    tests++; errors += test_is_from_valid_country( "205.34.137.191", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "205.34.137.191", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "205.34.137.191", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "205.34.137.191", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:533f:5e90:8718:fe81:b8d2:15c7:97ae", "EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:533f:5e90:8718:fe81:b8d2:15c7:97ae", "XX,EU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:533f:5e90:8718:fe81:b8d2:15c7:97ae", "EU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:533f:5e90:8718:fe81:b8d2:15c7:97ae", "XX,YY,EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:533f:5e90:8718:fe81:b8d2:15c7:97ae", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "59.196.191.178", "CN", 1 );
    tests++; errors += test_is_from_valid_country( "59.196.191.178", "XX,CN,YY", 1 );
    tests++; errors += test_is_from_valid_country( "59.196.191.178", "CN,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "59.196.191.178", "XX,YY,CN", 1 );
    tests++; errors += test_is_from_valid_country( "59.196.191.178", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "199.100.141.234", "US", 1 );
    tests++; errors += test_is_from_valid_country( "199.100.141.234", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "199.100.141.234", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "199.100.141.234", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "199.100.141.234", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:23ea:cac4:6609:183b:355c:2c1f:0e91", "EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:23ea:cac4:6609:183b:355c:2c1f:0e91", "XX,EU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:23ea:cac4:6609:183b:355c:2c1f:0e91", "EU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:23ea:cac4:6609:183b:355c:2c1f:0e91", "XX,YY,EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:23ea:cac4:6609:183b:355c:2c1f:0e91", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "65.31.197.10", "US", 1 );
    tests++; errors += test_is_from_valid_country( "65.31.197.10", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "65.31.197.10", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "65.31.197.10", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "65.31.197.10", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:21c7:a17d:52e8:3b50:af42:87f3:727e", "EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:21c7:a17d:52e8:3b50:af42:87f3:727e", "XX,EU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:21c7:a17d:52e8:3b50:af42:87f3:727e", "EU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:21c7:a17d:52e8:3b50:af42:87f3:727e", "XX,YY,EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:21c7:a17d:52e8:3b50:af42:87f3:727e", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "3.76.44.139", "US", 1 );
    tests++; errors += test_is_from_valid_country( "3.76.44.139", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "3.76.44.139", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "3.76.44.139", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "3.76.44.139", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "152.152.180.191", "BE", 1 );
    tests++; errors += test_is_from_valid_country( "152.152.180.191", "XX,BE,YY", 1 );
    tests++; errors += test_is_from_valid_country( "152.152.180.191", "BE,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "152.152.180.191", "XX,YY,BE", 1 );
    tests++; errors += test_is_from_valid_country( "152.152.180.191", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "118.30.88.99", "CN", 1 );
    tests++; errors += test_is_from_valid_country( "118.30.88.99", "XX,CN,YY", 1 );
    tests++; errors += test_is_from_valid_country( "118.30.88.99", "CN,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "118.30.88.99", "XX,YY,CN", 1 );
    tests++; errors += test_is_from_valid_country( "118.30.88.99", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "206.172.157.168", "CA", 1 );
    tests++; errors += test_is_from_valid_country( "206.172.157.168", "XX,CA,YY", 1 );
    tests++; errors += test_is_from_valid_country( "206.172.157.168", "CA,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "206.172.157.168", "XX,YY,CA", 1 );
    tests++; errors += test_is_from_valid_country( "206.172.157.168", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "64.131.209.71", "US", 1 );
    tests++; errors += test_is_from_valid_country( "64.131.209.71", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "64.131.209.71", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "64.131.209.71", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "64.131.209.71", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "100.142.226.64", "US", 1 );
    tests++; errors += test_is_from_valid_country( "100.142.226.64", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "100.142.226.64", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "100.142.226.64", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "100.142.226.64", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "69.163.237.240", "US", 1 );
    tests++; errors += test_is_from_valid_country( "69.163.237.240", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "69.163.237.240", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "69.163.237.240", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "69.163.237.240", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:a71a:9a7f:3171:170b:6edc:3651:393d", "JP", 1 );
    tests++; errors += test_is_from_valid_country( "2001:a71a:9a7f:3171:170b:6edc:3651:393d", "XX,JP,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:a71a:9a7f:3171:170b:6edc:3651:393d", "JP,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:a71a:9a7f:3171:170b:6edc:3651:393d", "XX,YY,JP", 1 );
    tests++; errors += test_is_from_valid_country( "2001:a71a:9a7f:3171:170b:6edc:3651:393d", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "115.212.48.223", "CN", 1 );
    tests++; errors += test_is_from_valid_country( "115.212.48.223", "XX,CN,YY", 1 );
    tests++; errors += test_is_from_valid_country( "115.212.48.223", "CN,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "115.212.48.223", "XX,YY,CN", 1 );
    tests++; errors += test_is_from_valid_country( "115.212.48.223", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "81.203.203.160", "ES", 1 );
    tests++; errors += test_is_from_valid_country( "81.203.203.160", "XX,ES,YY", 1 );
    tests++; errors += test_is_from_valid_country( "81.203.203.160", "ES,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "81.203.203.160", "XX,YY,ES", 1 );
    tests++; errors += test_is_from_valid_country( "81.203.203.160", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:2099:aa67:bd87:fd39:2982:02e0:7c9d", "EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:2099:aa67:bd87:fd39:2982:02e0:7c9d", "XX,EU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:2099:aa67:bd87:fd39:2982:02e0:7c9d", "EU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:2099:aa67:bd87:fd39:2982:02e0:7c9d", "XX,YY,EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:2099:aa67:bd87:fd39:2982:02e0:7c9d", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "42.63.72.216", "CN", 1 );
    tests++; errors += test_is_from_valid_country( "42.63.72.216", "XX,CN,YY", 1 );
    tests++; errors += test_is_from_valid_country( "42.63.72.216", "CN,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "42.63.72.216", "XX,YY,CN", 1 );
    tests++; errors += test_is_from_valid_country( "42.63.72.216", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:8316:3b10:339f:36de:a9d9:02a2:1053", "AU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:8316:3b10:339f:36de:a9d9:02a2:1053", "XX,AU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:8316:3b10:339f:36de:a9d9:02a2:1053", "AU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:8316:3b10:339f:36de:a9d9:02a2:1053", "XX,YY,AU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:8316:3b10:339f:36de:a9d9:02a2:1053", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "87.97.152.145", "BG", 1 );
    tests++; errors += test_is_from_valid_country( "87.97.152.145", "XX,BG,YY", 1 );
    tests++; errors += test_is_from_valid_country( "87.97.152.145", "BG,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "87.97.152.145", "XX,YY,BG", 1 );
    tests++; errors += test_is_from_valid_country( "87.97.152.145", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "119.90.8.8", "CN", 1 );
    tests++; errors += test_is_from_valid_country( "119.90.8.8", "XX,CN,YY", 1 );
    tests++; errors += test_is_from_valid_country( "119.90.8.8", "CN,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "119.90.8.8", "XX,YY,CN", 1 );
    tests++; errors += test_is_from_valid_country( "119.90.8.8", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "149.18.6.152", "US", 1 );
    tests++; errors += test_is_from_valid_country( "149.18.6.152", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "149.18.6.152", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "149.18.6.152", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "149.18.6.152", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "158.65.81.89", "US", 1 );
    tests++; errors += test_is_from_valid_country( "158.65.81.89", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "158.65.81.89", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "158.65.81.89", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "158.65.81.89", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "27.230.151.110", "JP", 1 );
    tests++; errors += test_is_from_valid_country( "27.230.151.110", "XX,JP,YY", 1 );
    tests++; errors += test_is_from_valid_country( "27.230.151.110", "JP,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "27.230.151.110", "XX,YY,JP", 1 );
    tests++; errors += test_is_from_valid_country( "27.230.151.110", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "135.0.39.161", "CA", 1 );
    tests++; errors += test_is_from_valid_country( "135.0.39.161", "XX,CA,YY", 1 );
    tests++; errors += test_is_from_valid_country( "135.0.39.161", "CA,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "135.0.39.161", "XX,YY,CA", 1 );
    tests++; errors += test_is_from_valid_country( "135.0.39.161", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:22c5:ec5f:a7f0:3cfb:f3cf:010b:7e35", "EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:22c5:ec5f:a7f0:3cfb:f3cf:010b:7e35", "XX,EU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:22c5:ec5f:a7f0:3cfb:f3cf:010b:7e35", "EU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:22c5:ec5f:a7f0:3cfb:f3cf:010b:7e35", "XX,YY,EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:22c5:ec5f:a7f0:3cfb:f3cf:010b:7e35", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "184.98.31.221", "US", 1 );
    tests++; errors += test_is_from_valid_country( "184.98.31.221", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "184.98.31.221", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "184.98.31.221", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "184.98.31.221", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "180.49.144.85", "JP", 1 );
    tests++; errors += test_is_from_valid_country( "180.49.144.85", "XX,JP,YY", 1 );
    tests++; errors += test_is_from_valid_country( "180.49.144.85", "JP,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "180.49.144.85", "XX,YY,JP", 1 );
    tests++; errors += test_is_from_valid_country( "180.49.144.85", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "122.117.150.0", "TW", 1 );
    tests++; errors += test_is_from_valid_country( "122.117.150.0", "XX,TW,YY", 1 );
    tests++; errors += test_is_from_valid_country( "122.117.150.0", "TW,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "122.117.150.0", "XX,YY,TW", 1 );
    tests++; errors += test_is_from_valid_country( "122.117.150.0", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "192.146.29.220", "US", 1 );
    tests++; errors += test_is_from_valid_country( "192.146.29.220", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "192.146.29.220", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "192.146.29.220", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "192.146.29.220", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "205.189.102.66", "US", 1 );
    tests++; errors += test_is_from_valid_country( "205.189.102.66", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "205.189.102.66", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "205.189.102.66", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "205.189.102.66", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "123.124.47.117", "CN", 1 );
    tests++; errors += test_is_from_valid_country( "123.124.47.117", "XX,CN,YY", 1 );
    tests++; errors += test_is_from_valid_country( "123.124.47.117", "CN,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "123.124.47.117", "XX,YY,CN", 1 );
    tests++; errors += test_is_from_valid_country( "123.124.47.117", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "22.168.53.227", "US", 1 );
    tests++; errors += test_is_from_valid_country( "22.168.53.227", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "22.168.53.227", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "22.168.53.227", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "22.168.53.227", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "69.239.236.191", "US", 1 );
    tests++; errors += test_is_from_valid_country( "69.239.236.191", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "69.239.236.191", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "69.239.236.191", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "69.239.236.191", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:0ba0:ee5a:93ac:8ead:65c3:b72a:51fc", "ES", 1 );
    tests++; errors += test_is_from_valid_country( "2001:0ba0:ee5a:93ac:8ead:65c3:b72a:51fc", "XX,ES,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:0ba0:ee5a:93ac:8ead:65c3:b72a:51fc", "ES,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:0ba0:ee5a:93ac:8ead:65c3:b72a:51fc", "XX,YY,ES", 1 );
    tests++; errors += test_is_from_valid_country( "2001:0ba0:ee5a:93ac:8ead:65c3:b72a:51fc", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "78.155.226.43", "IE", 1 );
    tests++; errors += test_is_from_valid_country( "78.155.226.43", "XX,IE,YY", 1 );
    tests++; errors += test_is_from_valid_country( "78.155.226.43", "IE,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "78.155.226.43", "XX,YY,IE", 1 );
    tests++; errors += test_is_from_valid_country( "78.155.226.43", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:2b8a:3997:7415:7fc0:f072:95b8:6f66", "EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:2b8a:3997:7415:7fc0:f072:95b8:6f66", "XX,EU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:2b8a:3997:7415:7fc0:f072:95b8:6f66", "EU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:2b8a:3997:7415:7fc0:f072:95b8:6f66", "XX,YY,EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:2b8a:3997:7415:7fc0:f072:95b8:6f66", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "200.172.67.230", "BR", 1 );
    tests++; errors += test_is_from_valid_country( "200.172.67.230", "XX,BR,YY", 1 );
    tests++; errors += test_is_from_valid_country( "200.172.67.230", "BR,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "200.172.67.230", "XX,YY,BR", 1 );
    tests++; errors += test_is_from_valid_country( "200.172.67.230", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "180.1.100.209", "JP", 1 );
    tests++; errors += test_is_from_valid_country( "180.1.100.209", "XX,JP,YY", 1 );
    tests++; errors += test_is_from_valid_country( "180.1.100.209", "JP,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "180.1.100.209", "XX,YY,JP", 1 );
    tests++; errors += test_is_from_valid_country( "180.1.100.209", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:259e:96a4:c8a6:88d2:08a8:a2ca:e1d5", "EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:259e:96a4:c8a6:88d2:08a8:a2ca:e1d5", "XX,EU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:259e:96a4:c8a6:88d2:08a8:a2ca:e1d5", "EU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:259e:96a4:c8a6:88d2:08a8:a2ca:e1d5", "XX,YY,EU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:259e:96a4:c8a6:88d2:08a8:a2ca:e1d5", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "200.68.49.181", "CL", 1 );
    tests++; errors += test_is_from_valid_country( "200.68.49.181", "XX,CL,YY", 1 );
    tests++; errors += test_is_from_valid_country( "200.68.49.181", "CL,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "200.68.49.181", "XX,YY,CL", 1 );
    tests++; errors += test_is_from_valid_country( "200.68.49.181", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "207.56.69.185", "US", 1 );
    tests++; errors += test_is_from_valid_country( "207.56.69.185", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "207.56.69.185", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "207.56.69.185", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "207.56.69.185", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "94.23.219.199", "FR", 1 );
    tests++; errors += test_is_from_valid_country( "94.23.219.199", "XX,FR,YY", 1 );
    tests++; errors += test_is_from_valid_country( "94.23.219.199", "FR,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "94.23.219.199", "XX,YY,FR", 1 );
    tests++; errors += test_is_from_valid_country( "94.23.219.199", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "206.159.226.5", "US", 1 );
    tests++; errors += test_is_from_valid_country( "206.159.226.5", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "206.159.226.5", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "206.159.226.5", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "206.159.226.5", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "39.146.61.123", "CN", 1 );
    tests++; errors += test_is_from_valid_country( "39.146.61.123", "XX,CN,YY", 1 );
    tests++; errors += test_is_from_valid_country( "39.146.61.123", "CN,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "39.146.61.123", "XX,YY,CN", 1 );
    tests++; errors += test_is_from_valid_country( "39.146.61.123", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:b0dd:5d8f:42d6:cf2f:f5da:e384:e292", "TW", 1 );
    tests++; errors += test_is_from_valid_country( "2001:b0dd:5d8f:42d6:cf2f:f5da:e384:e292", "XX,TW,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:b0dd:5d8f:42d6:cf2f:f5da:e384:e292", "TW,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:b0dd:5d8f:42d6:cf2f:f5da:e384:e292", "XX,YY,TW", 1 );
    tests++; errors += test_is_from_valid_country( "2001:b0dd:5d8f:42d6:cf2f:f5da:e384:e292", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "137.18.245.4", "US", 1 );
    tests++; errors += test_is_from_valid_country( "137.18.245.4", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "137.18.245.4", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "137.18.245.4", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "137.18.245.4", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "167.2.226.145", "US", 1 );
    tests++; errors += test_is_from_valid_country( "167.2.226.145", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "167.2.226.145", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "167.2.226.145", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "167.2.226.145", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "132.172.0.58", "US", 1 );
    tests++; errors += test_is_from_valid_country( "132.172.0.58", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "132.172.0.58", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "132.172.0.58", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "132.172.0.58", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:8e8e:939e:f9ca:4d18:8909:0fad:6c97", "AU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:8e8e:939e:f9ca:4d18:8909:0fad:6c97", "XX,AU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:8e8e:939e:f9ca:4d18:8909:0fad:6c97", "AU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:8e8e:939e:f9ca:4d18:8909:0fad:6c97", "XX,YY,AU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:8e8e:939e:f9ca:4d18:8909:0fad:6c97", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "206.48.176.18", "US", 1 );
    tests++; errors += test_is_from_valid_country( "206.48.176.18", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "206.48.176.18", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "206.48.176.18", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "206.48.176.18", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:0ee8:225c:a56f:badd:3790:89b3:5b74", "KR", 1 );
    tests++; errors += test_is_from_valid_country( "2001:0ee8:225c:a56f:badd:3790:89b3:5b74", "XX,KR,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:0ee8:225c:a56f:badd:3790:89b3:5b74", "KR,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:0ee8:225c:a56f:badd:3790:89b3:5b74", "XX,YY,KR", 1 );
    tests++; errors += test_is_from_valid_country( "2001:0ee8:225c:a56f:badd:3790:89b3:5b74", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "20.174.34.170", "US", 1 );
    tests++; errors += test_is_from_valid_country( "20.174.34.170", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "20.174.34.170", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "20.174.34.170", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "20.174.34.170", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "132.37.35.238", "US", 1 );
    tests++; errors += test_is_from_valid_country( "132.37.35.238", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "132.37.35.238", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "132.37.35.238", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "132.37.35.238", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "170.44.63.139", "US", 1 );
    tests++; errors += test_is_from_valid_country( "170.44.63.139", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "170.44.63.139", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "170.44.63.139", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "170.44.63.139", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "146.157.96.242", "US", 1 );
    tests++; errors += test_is_from_valid_country( "146.157.96.242", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "146.157.96.242", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "146.157.96.242", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "146.157.96.242", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "149.23.239.231", "US", 1 );
    tests++; errors += test_is_from_valid_country( "149.23.239.231", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "149.23.239.231", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "149.23.239.231", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "149.23.239.231", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "92.66.23.33", "NL", 1 );
    tests++; errors += test_is_from_valid_country( "92.66.23.33", "XX,NL,YY", 1 );
    tests++; errors += test_is_from_valid_country( "92.66.23.33", "NL,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "92.66.23.33", "XX,YY,NL", 1 );
    tests++; errors += test_is_from_valid_country( "92.66.23.33", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "89.165.10.7", "IR", 1 );
    tests++; errors += test_is_from_valid_country( "89.165.10.7", "XX,IR,YY", 1 );
    tests++; errors += test_is_from_valid_country( "89.165.10.7", "IR,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "89.165.10.7", "XX,YY,IR", 1 );
    tests++; errors += test_is_from_valid_country( "89.165.10.7", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "18.23.135.71", "US", 1 );
    tests++; errors += test_is_from_valid_country( "18.23.135.71", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "18.23.135.71", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "18.23.135.71", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "18.23.135.71", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "114.33.73.1", "TW", 1 );
    tests++; errors += test_is_from_valid_country( "114.33.73.1", "XX,TW,YY", 1 );
    tests++; errors += test_is_from_valid_country( "114.33.73.1", "TW,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "114.33.73.1", "XX,YY,TW", 1 );
    tests++; errors += test_is_from_valid_country( "114.33.73.1", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "99.84.85.39", "US", 1 );
    tests++; errors += test_is_from_valid_country( "99.84.85.39", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "99.84.85.39", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "99.84.85.39", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "99.84.85.39", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "84.24.26.229", "NL", 1 );
    tests++; errors += test_is_from_valid_country( "84.24.26.229", "XX,NL,YY", 1 );
    tests++; errors += test_is_from_valid_country( "84.24.26.229", "NL,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "84.24.26.229", "XX,YY,NL", 1 );
    tests++; errors += test_is_from_valid_country( "84.24.26.229", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:88a9:adca:3efb:6cdf:6ffe:9587:ba4e", "AU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:88a9:adca:3efb:6cdf:6ffe:9587:ba4e", "XX,AU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:88a9:adca:3efb:6cdf:6ffe:9587:ba4e", "AU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:88a9:adca:3efb:6cdf:6ffe:9587:ba4e", "XX,YY,AU", 1 );
    tests++; errors += test_is_from_valid_country( "2001:88a9:adca:3efb:6cdf:6ffe:9587:ba4e", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "8.155.92.214", "US", 1 );
    tests++; errors += test_is_from_valid_country( "8.155.92.214", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "8.155.92.214", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "8.155.92.214", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "8.155.92.214", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "158.71.24.91", "US", 1 );
    tests++; errors += test_is_from_valid_country( "158.71.24.91", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "158.71.24.91", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "158.71.24.91", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "158.71.24.91", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "152.211.8.209", "US", 1 );
    tests++; errors += test_is_from_valid_country( "152.211.8.209", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "152.211.8.209", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "152.211.8.209", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "152.211.8.209", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "81.104.228.189", "GB", 1 );
    tests++; errors += test_is_from_valid_country( "81.104.228.189", "XX,GB,YY", 1 );
    tests++; errors += test_is_from_valid_country( "81.104.228.189", "GB,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "81.104.228.189", "XX,YY,GB", 1 );
    tests++; errors += test_is_from_valid_country( "81.104.228.189", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "164.175.185.82", "US", 1 );
    tests++; errors += test_is_from_valid_country( "164.175.185.82", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "164.175.185.82", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "164.175.185.82", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "164.175.185.82", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "95.78.101.9", "RU", 1 );
    tests++; errors += test_is_from_valid_country( "95.78.101.9", "XX,RU,YY", 1 );
    tests++; errors += test_is_from_valid_country( "95.78.101.9", "RU,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "95.78.101.9", "XX,YY,RU", 1 );
    tests++; errors += test_is_from_valid_country( "95.78.101.9", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:b5bc:9507:e160:9028:790e:562c:7bab", "TW", 1 );
    tests++; errors += test_is_from_valid_country( "2001:b5bc:9507:e160:9028:790e:562c:7bab", "XX,TW,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:b5bc:9507:e160:9028:790e:562c:7bab", "TW,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:b5bc:9507:e160:9028:790e:562c:7bab", "XX,YY,TW", 1 );
    tests++; errors += test_is_from_valid_country( "2001:b5bc:9507:e160:9028:790e:562c:7bab", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "192.111.81.228", "US", 1 );
    tests++; errors += test_is_from_valid_country( "192.111.81.228", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "192.111.81.228", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "192.111.81.228", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "192.111.81.228", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "180.116.115.136", "CN", 1 );
    tests++; errors += test_is_from_valid_country( "180.116.115.136", "XX,CN,YY", 1 );
    tests++; errors += test_is_from_valid_country( "180.116.115.136", "CN,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "180.116.115.136", "XX,YY,CN", 1 );
    tests++; errors += test_is_from_valid_country( "180.116.115.136", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "3.215.177.168", "US", 1 );
    tests++; errors += test_is_from_valid_country( "3.215.177.168", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "3.215.177.168", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "3.215.177.168", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "3.215.177.168", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:1ca0:5458:6e81:c66f:0cbb:8051:f9bb", "NL", 1 );
    tests++; errors += test_is_from_valid_country( "2001:1ca0:5458:6e81:c66f:0cbb:8051:f9bb", "XX,NL,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:1ca0:5458:6e81:c66f:0cbb:8051:f9bb", "NL,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:1ca0:5458:6e81:c66f:0cbb:8051:f9bb", "XX,YY,NL", 1 );
    tests++; errors += test_is_from_valid_country( "2001:1ca0:5458:6e81:c66f:0cbb:8051:f9bb", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "157.182.76.203", "US", 1 );
    tests++; errors += test_is_from_valid_country( "157.182.76.203", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "157.182.76.203", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "157.182.76.203", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "157.182.76.203", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "2001:1d11:7d7a:f68a:a364:f2c1:12bb:0e53", "NL", 1 );
    tests++; errors += test_is_from_valid_country( "2001:1d11:7d7a:f68a:a364:f2c1:12bb:0e53", "XX,NL,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:1d11:7d7a:f68a:a364:f2c1:12bb:0e53", "NL,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "2001:1d11:7d7a:f68a:a364:f2c1:12bb:0e53", "XX,YY,NL", 1 );
    tests++; errors += test_is_from_valid_country( "2001:1d11:7d7a:f68a:a364:f2c1:12bb:0e53", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "93.99.39.240", "CZ", 1 );
    tests++; errors += test_is_from_valid_country( "93.99.39.240", "XX,CZ,YY", 1 );
    tests++; errors += test_is_from_valid_country( "93.99.39.240", "CZ,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "93.99.39.240", "XX,YY,CZ", 1 );
    tests++; errors += test_is_from_valid_country( "93.99.39.240", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "111.1.166.30", "CN", 1 );
    tests++; errors += test_is_from_valid_country( "111.1.166.30", "XX,CN,YY", 1 );
    tests++; errors += test_is_from_valid_country( "111.1.166.30", "CN,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "111.1.166.30", "XX,YY,CN", 1 );
    tests++; errors += test_is_from_valid_country( "111.1.166.30", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "145.190.228.16", "NL", 1 );
    tests++; errors += test_is_from_valid_country( "145.190.228.16", "XX,NL,YY", 1 );
    tests++; errors += test_is_from_valid_country( "145.190.228.16", "NL,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "145.190.228.16", "XX,YY,NL", 1 );
    tests++; errors += test_is_from_valid_country( "145.190.228.16", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "184.246.134.246", "US", 1 );
    tests++; errors += test_is_from_valid_country( "184.246.134.246", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "184.246.134.246", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "184.246.134.246", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "184.246.134.246", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "123.135.224.253", "CN", 1 );
    tests++; errors += test_is_from_valid_country( "123.135.224.253", "XX,CN,YY", 1 );
    tests++; errors += test_is_from_valid_country( "123.135.224.253", "CN,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "123.135.224.253", "XX,YY,CN", 1 );
    tests++; errors += test_is_from_valid_country( "123.135.224.253", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "161.215.180.155", "US", 1 );
    tests++; errors += test_is_from_valid_country( "161.215.180.155", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "161.215.180.155", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "161.215.180.155", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "161.215.180.155", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "8.215.37.184", "US", 1 );
    tests++; errors += test_is_from_valid_country( "8.215.37.184", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "8.215.37.184", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "8.215.37.184", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "8.215.37.184", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "197.146.248.61", "MA", 1 );
    tests++; errors += test_is_from_valid_country( "197.146.248.61", "XX,MA,YY", 1 );
    tests++; errors += test_is_from_valid_country( "197.146.248.61", "MA,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "197.146.248.61", "XX,YY,MA", 1 );
    tests++; errors += test_is_from_valid_country( "197.146.248.61", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "7.222.29.139", "US", 1 );
    tests++; errors += test_is_from_valid_country( "7.222.29.139", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "7.222.29.139", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "7.222.29.139", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "7.222.29.139", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "83.105.80.35", "GB", 1 );
    tests++; errors += test_is_from_valid_country( "83.105.80.35", "XX,GB,YY", 1 );
    tests++; errors += test_is_from_valid_country( "83.105.80.35", "GB,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "83.105.80.35", "XX,YY,GB", 1 );
    tests++; errors += test_is_from_valid_country( "83.105.80.35", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "43.189.120.13", "JP", 1 );
    tests++; errors += test_is_from_valid_country( "43.189.120.13", "XX,JP,YY", 1 );
    tests++; errors += test_is_from_valid_country( "43.189.120.13", "JP,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "43.189.120.13", "XX,YY,JP", 1 );
    tests++; errors += test_is_from_valid_country( "43.189.120.13", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "114.112.49.93", "CN", 1 );
    tests++; errors += test_is_from_valid_country( "114.112.49.93", "XX,CN,YY", 1 );
    tests++; errors += test_is_from_valid_country( "114.112.49.93", "CN,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "114.112.49.93", "XX,YY,CN", 1 );
    tests++; errors += test_is_from_valid_country( "114.112.49.93", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "143.231.234.240", "US", 1 );
    tests++; errors += test_is_from_valid_country( "143.231.234.240", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "143.231.234.240", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "143.231.234.240", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "143.231.234.240", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "146.22.96.34", "US", 1 );
    tests++; errors += test_is_from_valid_country( "146.22.96.34", "XX,US,YY", 1 );
    tests++; errors += test_is_from_valid_country( "146.22.96.34", "US,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "146.22.96.34", "XX,YY,US", 1 );
    tests++; errors += test_is_from_valid_country( "146.22.96.34", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "14.78.24.205", "KR", 1 );
    tests++; errors += test_is_from_valid_country( "14.78.24.205", "XX,KR,YY", 1 );
    tests++; errors += test_is_from_valid_country( "14.78.24.205", "KR,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "14.78.24.205", "XX,YY,KR", 1 );
    tests++; errors += test_is_from_valid_country( "14.78.24.205", "XX,YY,ZZ", 0 );
    tests++; errors += test_is_from_valid_country( "89.154.215.138", "PT", 1 );
    tests++; errors += test_is_from_valid_country( "89.154.215.138", "XX,PT,YY", 1 );
    tests++; errors += test_is_from_valid_country( "89.154.215.138", "PT,XX,YY", 1 );
    tests++; errors += test_is_from_valid_country( "89.154.215.138", "XX,YY,PT", 1 );
    tests++; errors += test_is_from_valid_country( "89.154.215.138", "XX,YY,ZZ", 0 );

    printf( "\ngeoip.c:is_from_valid_country(): passed %i out of %i tests\n", ( tests - errors ), tests );
    return( errors );
}
