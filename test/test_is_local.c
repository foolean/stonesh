/*
 * test_is_local.c
 *
 * This file is part of the regressions tests for stonesh.
 *
 * Copyright 2012 Bennett Samowich <bennett@foolean.org>
 *
 * Stonesh is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * Stonesh is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with Stonesh.  If not, see <http://www.gnu.org/licenses/>.
 */

#include <stdio.h>
#include <stdlib.h>
#include <string.h>

#include "geoip.h"

char *progname = "test_is_local";

int test_is_local( char *in, int out )
{
    int result;
    printf( "   is_local( '%s', %i ) ", in, out );

    result = is_local( in );
    printf( " = %i ", result );
    if ( result == out ) {
        printf( "passed\n" );
        return( 0 );
    }
    printf( "failed\n" );
    return( 1 );
}

int main()
{
    int errors = 0;
    int tests = 0;


    /* test the trim function */
    printf( "testing geoip.c:is_local()\n" );

    tests++; errors += test_is_local( "127.0.0.1", 1 );
    tests++; errors += test_is_local( "127.168.100.100", 1 );
    tests++; errors += test_is_local( "192.168.100.100", 0 );
    tests++; errors += test_is_local( "::1", 0 );
    tests++; errors += test_is_local( "foo", 0 );
    tests++; errors += test_is_local( "199.97.150.149", 0);
    tests++; errors += test_is_local( "127.82.183.101", 1);
    tests++; errors += test_is_local( "1.12.231.144", 0);
    tests++; errors += test_is_local( "127.145.158.115", 1);
    tests++; errors += test_is_local( "127.135.32.193", 1);
    tests++; errors += test_is_local( "127.105.35.188", 1);
    tests++; errors += test_is_local( "127.242.125.110", 1);
    tests++; errors += test_is_local( "127.118.29.108", 1);
    tests++; errors += test_is_local( "127.193.200.227", 1);
    tests++; errors += test_is_local( "171.98.98.40", 0);
    tests++; errors += test_is_local( "127.177.190.149", 1);
    tests++; errors += test_is_local( "127.63.162.214", 1);
    tests++; errors += test_is_local( "127.116.130.32", 1);
    tests++; errors += test_is_local( "127.134.242.19", 1);
    tests++; errors += test_is_local( "224.200.124.130", 0);
    tests++; errors += test_is_local( "154.212.9.83", 0);
    tests++; errors += test_is_local( "127.113.86.105", 1);
    tests++; errors += test_is_local( "82.184.124.238", 0);
    tests++; errors += test_is_local( "127.46.175.53", 1);
    tests++; errors += test_is_local( "1.111.176.191", 0);
    tests++; errors += test_is_local( "127.53.95.178", 1);
    tests++; errors += test_is_local( "124.146.129.56", 0);
    tests++; errors += test_is_local( "127.73.212.213", 1);
    tests++; errors += test_is_local( "127.188.253.98", 1);
    tests++; errors += test_is_local( "127.1.100.173", 1);
    tests++; errors += test_is_local( "135.136.162.101", 0);
    tests++; errors += test_is_local( "127.72.90.42", 1);
    tests++; errors += test_is_local( "7.104.73.204", 0);
    tests++; errors += test_is_local( "219.164.39.197", 0);
    tests++; errors += test_is_local( "93.188.150.242", 0);
    tests++; errors += test_is_local( "127.141.222.232", 1);
    tests++; errors += test_is_local( "41.30.83.155", 0);
    tests++; errors += test_is_local( "165.34.19.181", 0);
    tests++; errors += test_is_local( "127.85.83.218", 1);
    tests++; errors += test_is_local( "127.16.127.155", 1);
    tests++; errors += test_is_local( "28.206.73.17", 0);
    tests++; errors += test_is_local( "127.253.60.67", 1);
    tests++; errors += test_is_local( "41.206.116.111", 0);
    tests++; errors += test_is_local( "127.62.159.11", 1);
    tests++; errors += test_is_local( "127.191.218.92", 1);
    tests++; errors += test_is_local( "196.103.14.27", 0);
    tests++; errors += test_is_local( "127.221.46.140", 1);
    tests++; errors += test_is_local( "196.164.60.248", 0);
    tests++; errors += test_is_local( "127.68.35.136", 1);
    tests++; errors += test_is_local( "139.170.181.247", 0);
    tests++; errors += test_is_local( "171.73.27.14", 0);
    tests++; errors += test_is_local( "127.171.226.89", 1);
    tests++; errors += test_is_local( "127.229.200.143", 1);
    tests++; errors += test_is_local( "127.106.169.46", 1);
    tests++; errors += test_is_local( "181.215.129.53", 0);
    tests++; errors += test_is_local( "127.238.77.165", 1);
    tests++; errors += test_is_local( "127.23.246.131", 1);
    tests++; errors += test_is_local( "127.153.32.182", 1);
    tests++; errors += test_is_local( "248.13.97.31", 0);
    tests++; errors += test_is_local( "127.137.24.76", 1);
    tests++; errors += test_is_local( "238.13.237.189", 0);
    tests++; errors += test_is_local( "127.3.27.53", 1);
    tests++; errors += test_is_local( "26.15.183.23", 0);
    tests++; errors += test_is_local( "62.159.201.62", 0);
    tests++; errors += test_is_local( "0.188.128.67", 0);
    tests++; errors += test_is_local( "212.146.87.87", 0);
    tests++; errors += test_is_local( "147.141.74.106", 0);
    tests++; errors += test_is_local( "64.160.146.150", 0);
    tests++; errors += test_is_local( "127.120.210.61", 1);
    tests++; errors += test_is_local( "127.86.205.178", 1);
    tests++; errors += test_is_local( "152.115.171.11", 0);
    tests++; errors += test_is_local( "240.48.10.137", 0);
    tests++; errors += test_is_local( "123.119.224.26", 0);
    tests++; errors += test_is_local( "127.28.20.91", 1);
    tests++; errors += test_is_local( "226.50.107.0", 0);
    tests++; errors += test_is_local( "127.77.12.188", 1);
    tests++; errors += test_is_local( "127.201.126.89", 1);
    tests++; errors += test_is_local( "127.111.39.250", 1);
    tests++; errors += test_is_local( "212.216.35.125", 0);
    tests++; errors += test_is_local( "193.166.182.233", 0);
    tests++; errors += test_is_local( "127.100.102.57", 1);
    tests++; errors += test_is_local( "193.30.79.109", 0);
    tests++; errors += test_is_local( "127.78.21.178", 1);
    tests++; errors += test_is_local( "230.24.188.248", 0);
    tests++; errors += test_is_local( "127.1.159.82", 1);
    tests++; errors += test_is_local( "226.163.164.89", 0);
    tests++; errors += test_is_local( "127.239.225.0", 1);
    tests++; errors += test_is_local( "127.169.97.102", 1);
    tests++; errors += test_is_local( "2.235.164.167", 0);
    tests++; errors += test_is_local( "46.186.54.37", 0);
    tests++; errors += test_is_local( "179.191.173.119", 0);
    tests++; errors += test_is_local( "127.15.24.27", 1);
    tests++; errors += test_is_local( "226.116.138.104", 0);
    tests++; errors += test_is_local( "160.3.83.36", 0);
    tests++; errors += test_is_local( "127.219.148.44", 1);
    tests++; errors += test_is_local( "127.21.30.35", 1);
    tests++; errors += test_is_local( "127.3.118.117", 1);
    tests++; errors += test_is_local( "61.253.16.0", 0);
    tests++; errors += test_is_local( "71.225.239.184", 0);
    tests++; errors += test_is_local( "127.76.62.22", 1);
    tests++; errors += test_is_local( "127.73.104.74", 1);
    tests++; errors += test_is_local( "52.25.243.162", 0);
    tests++; errors += test_is_local( "175.52.90.11", 0);
    tests++; errors += test_is_local( "127.162.147.136", 1);
    tests++; errors += test_is_local( "124.97.19.75", 0);
    tests++; errors += test_is_local( "243.119.12.141", 0);
    tests++; errors += test_is_local( "36.96.42.0", 0);
    tests++; errors += test_is_local( "147.51.117.195", 0);
    tests++; errors += test_is_local( "249.125.202.161", 0);
    tests++; errors += test_is_local( "127.75.226.197", 1);
    tests++; errors += test_is_local( "127.212.250.4", 1);
    tests++; errors += test_is_local( "127.105.126.188", 1);
    tests++; errors += test_is_local( "127.215.33.170", 1);
    tests++; errors += test_is_local( "127.91.53.198", 1);
    tests++; errors += test_is_local( "127.107.172.135", 1);
    tests++; errors += test_is_local( "127.24.108.200", 1);
    tests++; errors += test_is_local( "127.155.82.224", 1);
    tests++; errors += test_is_local( "127.150.84.129", 1);
    tests++; errors += test_is_local( "127.127.150.221", 1);
    tests++; errors += test_is_local( "92.98.83.145", 0);
    tests++; errors += test_is_local( "127.17.173.110", 1);
    tests++; errors += test_is_local( "159.252.117.196", 0);
    tests++; errors += test_is_local( "137.194.48.92", 0);
    tests++; errors += test_is_local( "127.112.216.160", 1);
    tests++; errors += test_is_local( "127.85.233.118", 1);
    tests++; errors += test_is_local( "253.0.88.150", 0);
    tests++; errors += test_is_local( "127.163.207.17", 1);
    tests++; errors += test_is_local( "127.67.41.14", 1);
    tests++; errors += test_is_local( "127.136.12.221", 1);
    tests++; errors += test_is_local( "127.1.164.134", 1);
    tests++; errors += test_is_local( "100.5.103.174", 0);
    tests++; errors += test_is_local( "127.216.215.248", 1);
    tests++; errors += test_is_local( "127.73.235.181", 1);
    tests++; errors += test_is_local( "145.163.233.117", 0);
    tests++; errors += test_is_local( "110.107.107.152", 0);
    tests++; errors += test_is_local( "130.253.144.110", 0);
    tests++; errors += test_is_local( "210.249.52.215", 0);
    tests++; errors += test_is_local( "237.108.74.198", 0);
    tests++; errors += test_is_local( "206.204.30.146", 0);
    tests++; errors += test_is_local( "38.230.250.6", 0);
    tests++; errors += test_is_local( "127.86.87.225", 1);
    tests++; errors += test_is_local( "91.242.3.162", 0);
    tests++; errors += test_is_local( "127.53.64.194", 1);
    tests++; errors += test_is_local( "127.113.25.63", 1);
    tests++; errors += test_is_local( "127.128.80.74", 1);
    tests++; errors += test_is_local( "164.177.43.225", 0);
    tests++; errors += test_is_local( "42.240.22.73", 0);
    tests++; errors += test_is_local( "246.137.96.117", 0);
    tests++; errors += test_is_local( "127.215.11.62", 1);
    tests++; errors += test_is_local( "127.197.79.91", 1);
    tests++; errors += test_is_local( "127.92.55.80", 1);
    tests++; errors += test_is_local( "127.19.60.21", 1);
    tests++; errors += test_is_local( "70.133.79.66", 0);
    tests++; errors += test_is_local( "127.101.156.188", 1);
    tests++; errors += test_is_local( "155.205.171.142", 0);
    tests++; errors += test_is_local( "127.32.40.165", 1);
    tests++; errors += test_is_local( "127.103.11.94", 1);
    tests++; errors += test_is_local( "127.182.70.162", 1);
    tests++; errors += test_is_local( "127.105.114.245", 1);
    tests++; errors += test_is_local( "87.198.251.212", 0);
    tests++; errors += test_is_local( "228.59.119.155", 0);
    tests++; errors += test_is_local( "127.174.231.213", 1);
    tests++; errors += test_is_local( "127.244.128.69", 1);
    tests++; errors += test_is_local( "127.67.145.252", 1);
    tests++; errors += test_is_local( "46.200.78.102", 0);
    tests++; errors += test_is_local( "4.69.149.84", 0);
    tests++; errors += test_is_local( "130.238.3.144", 0);
    tests++; errors += test_is_local( "138.47.94.10", 0);
    tests++; errors += test_is_local( "127.237.215.40", 1);
    tests++; errors += test_is_local( "149.100.120.116", 0);
    tests++; errors += test_is_local( "127.185.79.2", 1);
    tests++; errors += test_is_local( "127.172.153.112", 1);
    tests++; errors += test_is_local( "127.220.75.187", 1);
    tests++; errors += test_is_local( "113.79.91.174", 0);
    tests++; errors += test_is_local( "127.133.171.222", 1);
    tests++; errors += test_is_local( "127.124.86.228", 1);
    tests++; errors += test_is_local( "186.245.236.122", 0);
    tests++; errors += test_is_local( "48.95.246.211", 0);
    tests++; errors += test_is_local( "127.28.222.25", 1);
    tests++; errors += test_is_local( "127.200.232.147", 1);
    tests++; errors += test_is_local( "127.118.32.203", 1);
    tests++; errors += test_is_local( "193.198.21.87", 0);
    tests++; errors += test_is_local( "176.185.91.35", 0);
    tests++; errors += test_is_local( "127.174.151.222", 1);
    tests++; errors += test_is_local( "33.116.23.68", 0);
    tests++; errors += test_is_local( "127.164.48.49", 1);
    tests++; errors += test_is_local( "28.219.174.237", 0);
    tests++; errors += test_is_local( "236.188.122.16", 0);
    tests++; errors += test_is_local( "127.129.249.71", 1);
    tests++; errors += test_is_local( "248.89.180.211", 0);
    tests++; errors += test_is_local( "209.202.215.39", 0);
    tests++; errors += test_is_local( "127.197.192.96", 1);
    tests++; errors += test_is_local( "164.174.154.98", 0);
    tests++; errors += test_is_local( "63.105.160.8", 0);
    tests++; errors += test_is_local( "127.147.87.242", 1);
    tests++; errors += test_is_local( "127.222.176.194", 1);
    tests++; errors += test_is_local( "127.69.251.0", 1);
    tests++; errors += test_is_local( "147.114.248.128", 0);
    tests++; errors += test_is_local( "127.122.0.70", 1);
    tests++; errors += test_is_local( "127.40.35.60", 1);
    tests++; errors += test_is_local( "41.87.44.116", 0);
    tests++; errors += test_is_local( "127.87.162.54", 1);
    tests++; errors += test_is_local( "95.100.122.46", 0);
    tests++; errors += test_is_local( "34.61.191.146", 0);
    tests++; errors += test_is_local( "127.85.213.84", 1);
    tests++; errors += test_is_local( "127.203.201.198", 1);
    tests++; errors += test_is_local( "83.212.14.61", 0);
    tests++; errors += test_is_local( "127.179.89.33", 1);
    tests++; errors += test_is_local( "127.189.195.49", 1);
    tests++; errors += test_is_local( "127.128.231.171", 1);
    tests++; errors += test_is_local( "186.184.216.120", 0);
    tests++; errors += test_is_local( "163.247.52.168", 0);
    tests++; errors += test_is_local( "51.122.125.99", 0);
    tests++; errors += test_is_local( "127.167.117.53", 1);
    tests++; errors += test_is_local( "127.150.220.186", 1);
    tests++; errors += test_is_local( "127.38.176.236", 1);
    tests++; errors += test_is_local( "131.132.199.189", 0);
    tests++; errors += test_is_local( "127.49.61.173", 1);
    tests++; errors += test_is_local( "169.142.195.169", 0);
    tests++; errors += test_is_local( "127.231.220.16", 1);
    tests++; errors += test_is_local( "127.229.97.79", 1);
    tests++; errors += test_is_local( "182.93.15.139", 0);
    tests++; errors += test_is_local( "127.2.110.189", 1);
    tests++; errors += test_is_local( "240.80.97.140", 0);
    tests++; errors += test_is_local( "38.82.71.146", 0);
    tests++; errors += test_is_local( "127.47.56.188", 1);
    tests++; errors += test_is_local( "127.173.125.75", 1);
    tests++; errors += test_is_local( "6.0.162.45", 0);
    tests++; errors += test_is_local( "46.119.44.129", 0);
    tests++; errors += test_is_local( "236.155.88.244", 0);
    tests++; errors += test_is_local( "194.108.149.189", 0);
    tests++; errors += test_is_local( "94.140.5.22", 0);
    tests++; errors += test_is_local( "127.95.4.197", 1);
    tests++; errors += test_is_local( "127.39.193.227", 1);
    tests++; errors += test_is_local( "108.179.111.93", 0);
    tests++; errors += test_is_local( "127.152.100.196", 1);
    tests++; errors += test_is_local( "127.222.84.166", 1);
    tests++; errors += test_is_local( "149.59.4.247", 0);
    tests++; errors += test_is_local( "39.187.215.203", 0);
    tests++; errors += test_is_local( "193.71.64.78", 0);
    tests++; errors += test_is_local( "11.203.101.66", 0);
    tests++; errors += test_is_local( "153.227.142.61", 0);
    tests++; errors += test_is_local( "180.253.30.69", 0);
    tests++; errors += test_is_local( "10.55.213.74", 0);
    tests++; errors += test_is_local( "127.34.240.34", 1);
    tests++; errors += test_is_local( "127.251.86.118", 1);
    tests++; errors += test_is_local( "184.42.187.54", 0);
    tests++; errors += test_is_local( "127.245.32.26", 1);
    tests++; errors += test_is_local( "127.225.216.148", 1);
    tests++; errors += test_is_local( "229.228.189.53", 0);
    tests++; errors += test_is_local( "127.81.2.164", 1);
    tests++; errors += test_is_local( "176.46.116.173", 0);
    tests++; errors += test_is_local( "127.1.51.46", 1);
    tests++; errors += test_is_local( "35.50.219.29", 0);
    tests++; errors += test_is_local( "10.59.103.198", 0);
    tests++; errors += test_is_local( "127.153.70.170", 1);
    tests++; errors += test_is_local( "250.117.186.19", 0);
    tests++; errors += test_is_local( "127.209.33.4", 1);
    tests++; errors += test_is_local( "127.232.48.162", 1);
    tests++; errors += test_is_local( "115.171.146.124", 0);
    tests++; errors += test_is_local( "127.222.2.185", 1);
    tests++; errors += test_is_local( "127.143.41.210", 1);
    tests++; errors += test_is_local( "125.158.161.185", 0);
    tests++; errors += test_is_local( "127.193.18.163", 1);
    tests++; errors += test_is_local( "64.120.234.13", 0);
    tests++; errors += test_is_local( "127.48.107.57", 1);
    tests++; errors += test_is_local( "127.101.98.170", 1);
    tests++; errors += test_is_local( "127.131.89.46", 1);
    tests++; errors += test_is_local( "127.114.62.117", 1);
    tests++; errors += test_is_local( "127.58.130.247", 1);
    tests++; errors += test_is_local( "246.128.165.201", 0);
    tests++; errors += test_is_local( "127.220.97.111", 1);
    tests++; errors += test_is_local( "127.87.43.124", 1);
    tests++; errors += test_is_local( "127.224.163.198", 1);
    tests++; errors += test_is_local( "127.3.77.220", 1);
    tests++; errors += test_is_local( "127.30.147.208", 1);
    tests++; errors += test_is_local( "193.97.203.2", 0);
    tests++; errors += test_is_local( "47.26.206.180", 0);
    tests++; errors += test_is_local( "127.190.214.236", 1);
    tests++; errors += test_is_local( "51.135.151.149", 0);
    tests++; errors += test_is_local( "127.202.185.193", 1);
    tests++; errors += test_is_local( "127.35.23.37", 1);
    tests++; errors += test_is_local( "127.72.121.165", 1);
    tests++; errors += test_is_local( "127.184.155.242", 1);
    tests++; errors += test_is_local( "127.83.157.120", 1);
    tests++; errors += test_is_local( "243.96.80.73", 0);
    tests++; errors += test_is_local( "144.83.49.191", 0);
    tests++; errors += test_is_local( "127.136.1.212", 1);
    tests++; errors += test_is_local( "207.136.33.71", 0);
    tests++; errors += test_is_local( "186.7.96.114", 0);
    tests++; errors += test_is_local( "127.212.90.236", 1);
    tests++; errors += test_is_local( "127.210.177.153", 1);
    tests++; errors += test_is_local( "127.126.243.252", 1);
    tests++; errors += test_is_local( "127.216.141.35", 1);
    tests++; errors += test_is_local( "127.95.199.103", 1);
    tests++; errors += test_is_local( "181.114.175.31", 0);
    tests++; errors += test_is_local( "98.99.134.158", 0);
    tests++; errors += test_is_local( "127.147.218.177", 1);
    tests++; errors += test_is_local( "79.1.53.43", 0);
    tests++; errors += test_is_local( "127.191.124.17", 1);
    tests++; errors += test_is_local( "132.17.159.140", 0);
    tests++; errors += test_is_local( "127.48.211.251", 1);
    tests++; errors += test_is_local( "38.138.94.133", 0);
    tests++; errors += test_is_local( "167.141.0.253", 0);
    tests++; errors += test_is_local( "127.188.31.195", 1);
    tests++; errors += test_is_local( "127.11.90.65", 1);
    tests++; errors += test_is_local( "127.188.214.37", 1);
    tests++; errors += test_is_local( "182.74.61.171", 0);
    tests++; errors += test_is_local( "127.8.108.29", 1);
    tests++; errors += test_is_local( "66.99.71.177", 0);
    tests++; errors += test_is_local( "173.175.98.133", 0);
    tests++; errors += test_is_local( "127.5.33.103", 1);
    tests++; errors += test_is_local( "113.70.237.171", 0);
    tests++; errors += test_is_local( "115.175.46.14", 0);
    tests++; errors += test_is_local( "127.92.115.211", 1);
    tests++; errors += test_is_local( "127.207.230.175", 1);
    tests++; errors += test_is_local( "127.152.146.180", 1);
    tests++; errors += test_is_local( "194.9.175.208", 0);
    tests++; errors += test_is_local( "8.166.172.80", 0);
    tests++; errors += test_is_local( "76.8.116.63", 0);
    tests++; errors += test_is_local( "127.215.25.227", 1);
    tests++; errors += test_is_local( "103.1.167.206", 0);
    tests++; errors += test_is_local( "172.228.243.92", 0);
    tests++; errors += test_is_local( "229.38.224.31", 0);
    tests++; errors += test_is_local( "250.116.152.188", 0);
    tests++; errors += test_is_local( "7.91.127.233", 0);
    tests++; errors += test_is_local( "249.164.2.77", 0);
    tests++; errors += test_is_local( "218.0.249.67", 0);
    tests++; errors += test_is_local( "221.11.193.159", 0);
    tests++; errors += test_is_local( "127.138.109.89", 1);
    tests++; errors += test_is_local( "127.110.122.140", 1);
    tests++; errors += test_is_local( "127.69.124.181", 1);
    tests++; errors += test_is_local( "127.169.224.32", 1);
    tests++; errors += test_is_local( "127.211.24.159", 1);
    tests++; errors += test_is_local( "127.44.102.192", 1);
    tests++; errors += test_is_local( "79.120.88.163", 0);
    tests++; errors += test_is_local( "61.11.36.130", 0);
    tests++; errors += test_is_local( "127.198.13.9", 1);
    tests++; errors += test_is_local( "127.36.64.149", 1);
    tests++; errors += test_is_local( "127.192.96.147", 1);
    tests++; errors += test_is_local( "127.129.62.162", 1);
    tests++; errors += test_is_local( "127.88.89.216", 1);
    tests++; errors += test_is_local( "127.57.166.15", 1);
    tests++; errors += test_is_local( "251.92.144.116", 0);
    tests++; errors += test_is_local( "127.157.129.27", 1);
    tests++; errors += test_is_local( "44.217.186.143", 0);
    tests++; errors += test_is_local( "127.153.249.83", 1);
    tests++; errors += test_is_local( "184.92.242.200", 0);
    tests++; errors += test_is_local( "127.21.161.190", 1);
    tests++; errors += test_is_local( "127.86.88.197", 1);
    tests++; errors += test_is_local( "127.245.2.30", 1);
    tests++; errors += test_is_local( "127.58.159.95", 1);
    tests++; errors += test_is_local( "127.97.69.236", 1);
    tests++; errors += test_is_local( "127.34.5.45", 1);
    tests++; errors += test_is_local( "127.76.12.212", 1);
    tests++; errors += test_is_local( "127.9.202.89", 1);
    tests++; errors += test_is_local( "177.170.235.139", 0);
    tests++; errors += test_is_local( "242.79.209.33", 0);
    tests++; errors += test_is_local( "127.19.213.141", 1);
    tests++; errors += test_is_local( "184.79.43.167", 0);
    tests++; errors += test_is_local( "127.253.136.111", 1);
    tests++; errors += test_is_local( "220.30.70.60", 0);
    tests++; errors += test_is_local( "127.3.125.240", 1);
    tests++; errors += test_is_local( "8.91.60.52", 0);
    tests++; errors += test_is_local( "127.224.142.232", 1);
    tests++; errors += test_is_local( "99.152.178.155", 0);
    tests++; errors += test_is_local( "127.63.15.162", 1);
    tests++; errors += test_is_local( "127.223.213.43", 1);
    tests++; errors += test_is_local( "2.251.239.24", 0);
    tests++; errors += test_is_local( "82.180.219.11", 0);
    tests++; errors += test_is_local( "3.19.32.250", 0);
    tests++; errors += test_is_local( "127.154.120.21", 1);
    tests++; errors += test_is_local( "127.50.219.217", 1);
    tests++; errors += test_is_local( "48.21.36.223", 0);
    tests++; errors += test_is_local( "217.188.36.33", 0);
    tests++; errors += test_is_local( "127.70.32.213", 1);
    tests++; errors += test_is_local( "127.153.105.41", 1);
    tests++; errors += test_is_local( "251.253.191.51", 0);
    tests++; errors += test_is_local( "150.207.103.146", 0);
    tests++; errors += test_is_local( "53.23.85.182", 0);
    tests++; errors += test_is_local( "204.66.193.195", 0);
    tests++; errors += test_is_local( "127.228.131.80", 1);
    tests++; errors += test_is_local( "24.67.137.194", 0);
    tests++; errors += test_is_local( "127.168.193.217", 1);
    tests++; errors += test_is_local( "128.192.96.229", 0);
    tests++; errors += test_is_local( "251.123.166.144", 0);
    tests++; errors += test_is_local( "158.217.19.37", 0);
    tests++; errors += test_is_local( "202.230.165.170", 0);
    tests++; errors += test_is_local( "127.42.115.100", 1);
    tests++; errors += test_is_local( "127.0.205.64", 1);
    tests++; errors += test_is_local( "85.169.63.218", 0);
    tests++; errors += test_is_local( "111.216.86.184", 0);
    tests++; errors += test_is_local( "127.241.252.190", 1);
    tests++; errors += test_is_local( "133.67.78.230", 0);
    tests++; errors += test_is_local( "127.197.102.22", 1);
    tests++; errors += test_is_local( "162.41.188.240", 0);
    tests++; errors += test_is_local( "66.108.55.13", 0);
    tests++; errors += test_is_local( "127.248.201.182", 1);
    tests++; errors += test_is_local( "236.134.56.124", 0);
    tests++; errors += test_is_local( "0.205.43.86", 0);
    tests++; errors += test_is_local( "129.96.9.51", 0);
    tests++; errors += test_is_local( "127.102.223.169", 1);
    tests++; errors += test_is_local( "92.28.104.50", 0);
    tests++; errors += test_is_local( "153.32.177.43", 0);
    tests++; errors += test_is_local( "169.149.209.81", 0);
    tests++; errors += test_is_local( "127.113.130.21", 1);
    tests++; errors += test_is_local( "127.168.0.184", 1);
    tests++; errors += test_is_local( "148.14.48.164", 0);
    tests++; errors += test_is_local( "75.29.159.202", 0);
    tests++; errors += test_is_local( "85.129.193.203", 0);
    tests++; errors += test_is_local( "127.166.244.119", 1);
    tests++; errors += test_is_local( "127.204.150.192", 1);
    tests++; errors += test_is_local( "127.211.25.104", 1);
    tests++; errors += test_is_local( "11.178.249.58", 0);
    tests++; errors += test_is_local( "247.175.90.117", 0);
    tests++; errors += test_is_local( "127.44.101.91", 1);
    tests++; errors += test_is_local( "2.93.78.12", 0);
    tests++; errors += test_is_local( "127.136.140.203", 1);
    tests++; errors += test_is_local( "127.67.97.1", 1);
    tests++; errors += test_is_local( "99.116.56.104", 0);
    tests++; errors += test_is_local( "127.51.91.65", 1);
    tests++; errors += test_is_local( "129.13.116.216", 0);
    tests++; errors += test_is_local( "127.203.101.73", 1);
    tests++; errors += test_is_local( "127.11.171.64", 1);
    tests++; errors += test_is_local( "153.115.45.83", 0);
    tests++; errors += test_is_local( "127.165.6.45", 1);
    tests++; errors += test_is_local( "233.22.94.188", 0);
    tests++; errors += test_is_local( "127.202.224.82", 1);
    tests++; errors += test_is_local( "91.173.28.222", 0);
    tests++; errors += test_is_local( "127.247.242.176", 1);
    tests++; errors += test_is_local( "127.60.137.36", 1);
    tests++; errors += test_is_local( "237.86.110.100", 0);
    tests++; errors += test_is_local( "127.138.240.9", 1);
    tests++; errors += test_is_local( "127.163.176.165", 1);
    tests++; errors += test_is_local( "20.19.35.64", 0);
    tests++; errors += test_is_local( "52.19.167.214", 0);
    tests++; errors += test_is_local( "127.25.29.76", 1);
    tests++; errors += test_is_local( "125.100.73.74", 0);
    tests++; errors += test_is_local( "19.50.190.107", 0);
    tests++; errors += test_is_local( "157.151.101.84", 0);
    tests++; errors += test_is_local( "84.40.120.161", 0);
    tests++; errors += test_is_local( "127.202.144.236", 1);
    tests++; errors += test_is_local( "53.184.136.248", 0);
    tests++; errors += test_is_local( "127.168.82.240", 1);
    tests++; errors += test_is_local( "228.187.144.140", 0);
    tests++; errors += test_is_local( "127.100.234.178", 1);
    tests++; errors += test_is_local( "127.238.20.224", 1);
    tests++; errors += test_is_local( "127.39.180.157", 1);
    tests++; errors += test_is_local( "127.185.241.36", 1);
    tests++; errors += test_is_local( "127.102.152.135", 1);
    tests++; errors += test_is_local( "127.151.191.243", 1);
    tests++; errors += test_is_local( "127.221.185.81", 1);
    tests++; errors += test_is_local( "127.13.68.224", 1);
    tests++; errors += test_is_local( "127.128.139.6", 1);
    tests++; errors += test_is_local( "127.199.238.124", 1);
    tests++; errors += test_is_local( "127.244.159.224", 1);
    tests++; errors += test_is_local( "218.120.30.65", 0);
    tests++; errors += test_is_local( "104.252.11.116", 0);
    tests++; errors += test_is_local( "127.183.73.80", 1);
    tests++; errors += test_is_local( "127.7.112.14", 1);
    tests++; errors += test_is_local( "12.237.11.110", 0);
    tests++; errors += test_is_local( "127.10.187.139", 1);
    tests++; errors += test_is_local( "99.39.247.193", 0);
    tests++; errors += test_is_local( "127.174.136.83", 1);
    tests++; errors += test_is_local( "127.24.117.188", 1);
    tests++; errors += test_is_local( "3.56.145.139", 0);
    tests++; errors += test_is_local( "228.19.3.217", 0);
    tests++; errors += test_is_local( "160.1.158.55", 0);
    tests++; errors += test_is_local( "98.83.183.80", 0);
    tests++; errors += test_is_local( "127.233.150.90", 1);
    tests++; errors += test_is_local( "127.34.252.28", 1);
    tests++; errors += test_is_local( "235.251.27.17", 0);
    tests++; errors += test_is_local( "127.171.88.178", 1);
    tests++; errors += test_is_local( "150.51.110.15", 0);
    tests++; errors += test_is_local( "137.29.109.71", 0);
    tests++; errors += test_is_local( "127.21.236.118", 1);
    tests++; errors += test_is_local( "127.87.24.94", 1);
    tests++; errors += test_is_local( "55.88.154.71", 0);
    tests++; errors += test_is_local( "127.113.52.101", 1);
    tests++; errors += test_is_local( "127.239.81.182", 1);
    tests++; errors += test_is_local( "110.114.222.116", 0);
    tests++; errors += test_is_local( "127.46.104.210", 1);
    tests++; errors += test_is_local( "199.59.170.210", 0);
    tests++; errors += test_is_local( "127.104.151.133", 1);
    tests++; errors += test_is_local( "223.161.190.192", 0);
    tests++; errors += test_is_local( "127.205.176.90", 1);
    tests++; errors += test_is_local( "246.143.231.242", 0);
    tests++; errors += test_is_local( "206.208.121.189", 0);
    tests++; errors += test_is_local( "39.151.43.114", 0);
    tests++; errors += test_is_local( "127.61.67.214", 1);
    tests++; errors += test_is_local( "127.199.91.81", 1);
    tests++; errors += test_is_local( "127.0.234.49", 1);
    tests++; errors += test_is_local( "233.229.232.180", 0);
    tests++; errors += test_is_local( "53.112.148.1", 0);
    tests++; errors += test_is_local( "97.58.116.72", 0);
    tests++; errors += test_is_local( "10.152.239.54", 0);
    tests++; errors += test_is_local( "223.205.44.197", 0);
    tests++; errors += test_is_local( "56.237.207.34", 0);
    tests++; errors += test_is_local( "127.66.64.241", 1);
    tests++; errors += test_is_local( "128.69.182.170", 0);
    tests++; errors += test_is_local( "89.97.94.253", 0);
    tests++; errors += test_is_local( "69.125.144.212", 0);
    tests++; errors += test_is_local( "109.142.10.10", 0);
    tests++; errors += test_is_local( "127.108.197.214", 1);
    tests++; errors += test_is_local( "138.41.204.5", 0);
    tests++; errors += test_is_local( "127.171.64.5", 1);
    tests++; errors += test_is_local( "223.102.142.153", 0);
    tests++; errors += test_is_local( "127.243.40.240", 1);
    tests++; errors += test_is_local( "127.185.182.104", 1);
    tests++; errors += test_is_local( "127.240.104.173", 1);
    tests++; errors += test_is_local( "127.214.52.190", 1);
    tests++; errors += test_is_local( "127.33.127.109", 1);
    tests++; errors += test_is_local( "127.148.156.67", 1);
    tests++; errors += test_is_local( "127.235.141.89", 1);
    tests++; errors += test_is_local( "105.181.208.23", 0);
    tests++; errors += test_is_local( "127.220.79.132", 1);
    tests++; errors += test_is_local( "127.151.16.247", 1);
    tests++; errors += test_is_local( "173.232.0.111", 0);
    tests++; errors += test_is_local( "219.131.158.88", 0);
    tests++; errors += test_is_local( "127.225.166.183", 1);
    tests++; errors += test_is_local( "127.252.217.22", 1);
    tests++; errors += test_is_local( "127.251.62.6", 1);
    tests++; errors += test_is_local( "127.53.155.179", 1);
    tests++; errors += test_is_local( "204.135.247.190", 0);
    tests++; errors += test_is_local( "127.153.250.127", 1);
    tests++; errors += test_is_local( "127.223.211.110", 1);
    tests++; errors += test_is_local( "90.229.201.124", 0);
    tests++; errors += test_is_local( "34.136.52.115", 0);
    tests++; errors += test_is_local( "127.133.205.41", 1);
    tests++; errors += test_is_local( "248.68.17.64", 0);
    tests++; errors += test_is_local( "11.143.3.71", 0);
    tests++; errors += test_is_local( "36.187.92.205", 0);
    tests++; errors += test_is_local( "244.160.219.27", 0);
    tests++; errors += test_is_local( "234.114.8.228", 0);
    tests++; errors += test_is_local( "127.116.211.99", 1);
    tests++; errors += test_is_local( "96.51.226.92", 0);
    tests++; errors += test_is_local( "127.8.245.11", 1);
    tests++; errors += test_is_local( "127.193.104.182", 1);
    tests++; errors += test_is_local( "127.247.3.90", 1);
    tests++; errors += test_is_local( "127.236.167.234", 1);
    tests++; errors += test_is_local( "127.102.241.93", 1);
    tests++; errors += test_is_local( "63.138.100.14", 0);
    tests++; errors += test_is_local( "133.138.15.83", 0);
    tests++; errors += test_is_local( "106.149.22.230", 0);
    tests++; errors += test_is_local( "118.79.175.241", 0);
    tests++; errors += test_is_local( "88.171.251.159", 0);
    tests++; errors += test_is_local( "99.107.250.130", 0);
    tests++; errors += test_is_local( "127.174.90.212", 1);
    tests++; errors += test_is_local( "127.245.104.80", 1);
    tests++; errors += test_is_local( "252.1.76.136", 0);
    tests++; errors += test_is_local( "127.35.85.112", 1);
    tests++; errors += test_is_local( "127.36.32.149", 1);
    tests++; errors += test_is_local( "55.148.226.63", 0);
    tests++; errors += test_is_local( "127.225.71.105", 1);
    tests++; errors += test_is_local( "104.92.226.162", 0);
    tests++; errors += test_is_local( "127.187.7.109", 1);
    tests++; errors += test_is_local( "112.247.100.45", 0);
    tests++; errors += test_is_local( "127.154.164.142", 1);
    tests++; errors += test_is_local( "118.197.113.239", 0);
    tests++; errors += test_is_local( "187.45.186.3", 0);
    tests++; errors += test_is_local( "127.151.133.93", 1);
    tests++; errors += test_is_local( "127.190.1.82", 1);
    tests++; errors += test_is_local( "127.72.51.190", 1);
    tests++; errors += test_is_local( "78.51.163.36", 0);
    tests++; errors += test_is_local( "127.221.122.192", 1);
    tests++; errors += test_is_local( "127.54.49.127", 1);
    tests++; errors += test_is_local( "93.218.62.223", 0);
    tests++; errors += test_is_local( "242.15.204.129", 0);
    tests++; errors += test_is_local( "110.75.221.21", 0);
    tests++; errors += test_is_local( "45.179.226.226", 0);
    tests++; errors += test_is_local( "50.153.225.95", 0);
    tests++; errors += test_is_local( "186.91.140.52", 0);
    tests++; errors += test_is_local( "127.161.143.91", 1);
    tests++; errors += test_is_local( "150.185.162.198", 0);
    tests++; errors += test_is_local( "20.168.96.40", 0);
    tests++; errors += test_is_local( "245.25.225.79", 0);
    tests++; errors += test_is_local( "127.252.85.199", 1);
    tests++; errors += test_is_local( "127.227.240.11", 1);
    tests++; errors += test_is_local( "127.98.17.164", 1);
    tests++; errors += test_is_local( "127.125.160.250", 1);
    tests++; errors += test_is_local( "76.168.206.244", 0);
    tests++; errors += test_is_local( "127.109.222.237", 1);
    tests++; errors += test_is_local( "65.40.27.11", 0);
    tests++; errors += test_is_local( "127.209.69.100", 1);
    tests++; errors += test_is_local( "127.65.246.249", 1);
    tests++; errors += test_is_local( "224.197.140.217", 0);
    tests++; errors += test_is_local( "50.218.34.248", 0);
    tests++; errors += test_is_local( "127.174.10.252", 1);
    tests++; errors += test_is_local( "127.204.94.174", 1);
    tests++; errors += test_is_local( "200.66.76.56", 0);
    tests++; errors += test_is_local( "127.243.186.1", 1);
    tests++; errors += test_is_local( "127.98.58.170", 1);
    tests++; errors += test_is_local( "71.158.234.21", 0);
    tests++; errors += test_is_local( "127.105.185.38", 1);
    tests++; errors += test_is_local( "140.119.1.19", 0);
    tests++; errors += test_is_local( "127.221.25.42", 1);
    tests++; errors += test_is_local( "184.232.33.53", 0);
    tests++; errors += test_is_local( "132.30.40.86", 0);
    tests++; errors += test_is_local( "104.35.10.210", 0);
    tests++; errors += test_is_local( "127.12.47.179", 1);
    tests++; errors += test_is_local( "4.70.80.191", 0);
    tests++; errors += test_is_local( "28.6.172.165", 0);
    tests++; errors += test_is_local( "232.120.65.84", 0);
    tests++; errors += test_is_local( "123.70.36.48", 0);
    tests++; errors += test_is_local( "238.226.94.51", 0);
    tests++; errors += test_is_local( "127.145.116.200", 1);
    tests++; errors += test_is_local( "77.123.118.136", 0);
    tests++; errors += test_is_local( "68.169.246.3", 0);
    tests++; errors += test_is_local( "127.224.216.231", 1);
    tests++; errors += test_is_local( "127.220.213.114", 1);
    tests++; errors += test_is_local( "127.16.96.250", 1);
    tests++; errors += test_is_local( "92.241.223.248", 0);
    tests++; errors += test_is_local( "27.35.80.150", 0);
    tests++; errors += test_is_local( "150.24.173.220", 0);
    tests++; errors += test_is_local( "99.87.101.41", 0);
    tests++; errors += test_is_local( "172.191.24.147", 0);
    tests++; errors += test_is_local( "127.71.0.192", 1);
    tests++; errors += test_is_local( "127.89.116.93", 1);
    tests++; errors += test_is_local( "127.20.151.115", 1);
    tests++; errors += test_is_local( "127.97.19.246", 1);
    tests++; errors += test_is_local( "34.120.31.131", 0);
    tests++; errors += test_is_local( "127.162.176.47", 1);
    tests++; errors += test_is_local( "204.191.45.205", 0);
    tests++; errors += test_is_local( "127.164.163.6", 1);
    tests++; errors += test_is_local( "25.151.47.135", 0);
    tests++; errors += test_is_local( "223.1.45.196", 0);
    tests++; errors += test_is_local( "127.198.21.138", 1);
    tests++; errors += test_is_local( "205.90.182.31", 0);
    tests++; errors += test_is_local( "9.234.54.34", 0);
    tests++; errors += test_is_local( "127.154.202.166", 1);
    tests++; errors += test_is_local( "61.45.73.142", 0);
    tests++; errors += test_is_local( "41.152.231.136", 0);
    tests++; errors += test_is_local( "127.200.187.201", 1);
    tests++; errors += test_is_local( "127.179.93.243", 1);
    tests++; errors += test_is_local( "55.37.225.206", 0);
    tests++; errors += test_is_local( "159.227.17.57", 0);
    tests++; errors += test_is_local( "222.54.51.134", 0);
    tests++; errors += test_is_local( "205.95.164.81", 0);
    tests++; errors += test_is_local( "127.168.91.185", 1);
    tests++; errors += test_is_local( "97.179.219.113", 0);
    tests++; errors += test_is_local( "127.62.30.209", 1);
    tests++; errors += test_is_local( "46.112.252.247", 0);
    tests++; errors += test_is_local( "127.31.213.71", 1);
    tests++; errors += test_is_local( "69.0.246.134", 0);
    tests++; errors += test_is_local( "127.163.101.164", 1);
    tests++; errors += test_is_local( "14.120.170.213", 0);
    tests++; errors += test_is_local( "0.174.101.146", 0);
    tests++; errors += test_is_local( "127.248.83.165", 1);
    tests++; errors += test_is_local( "127.14.144.176", 1);
    tests++; errors += test_is_local( "127.74.121.164", 1);
    tests++; errors += test_is_local( "127.8.174.11", 1);
    tests++; errors += test_is_local( "198.22.46.163", 0);
    tests++; errors += test_is_local( "127.118.192.90", 1);
    tests++; errors += test_is_local( "223.149.38.231", 0);
    tests++; errors += test_is_local( "129.115.140.73", 0);
    tests++; errors += test_is_local( "168.96.205.223", 0);
    tests++; errors += test_is_local( "21.126.71.87", 0);
    tests++; errors += test_is_local( "181.127.36.42", 0);
    tests++; errors += test_is_local( "127.131.215.117", 1);
    tests++; errors += test_is_local( "127.51.76.197", 1);
    tests++; errors += test_is_local( "175.129.35.189", 0);
    tests++; errors += test_is_local( "222.163.2.113", 0);
    tests++; errors += test_is_local( "186.223.61.187", 0);
    tests++; errors += test_is_local( "242.230.173.53", 0);
    tests++; errors += test_is_local( "127.120.69.180", 1);
    tests++; errors += test_is_local( "112.114.13.201", 0);
    tests++; errors += test_is_local( "18.31.32.157", 0);
    tests++; errors += test_is_local( "127.182.156.198", 1);
    tests++; errors += test_is_local( "74.23.136.82", 0);
    tests++; errors += test_is_local( "137.44.62.29", 0);
    tests++; errors += test_is_local( "29.58.159.194", 0);
    tests++; errors += test_is_local( "127.234.249.213", 1);
    tests++; errors += test_is_local( "127.201.134.16", 1);
    tests++; errors += test_is_local( "149.149.143.119", 0);
    tests++; errors += test_is_local( "21.38.14.70", 0);
    tests++; errors += test_is_local( "127.67.190.103", 1);
    tests++; errors += test_is_local( "127.197.251.142", 1);
    tests++; errors += test_is_local( "185.226.174.77", 0);
    tests++; errors += test_is_local( "203.165.137.10", 0);
    tests++; errors += test_is_local( "127.187.121.155", 1);
    tests++; errors += test_is_local( "85.121.171.70", 0);
    tests++; errors += test_is_local( "92.26.156.54", 0);
    tests++; errors += test_is_local( "127.230.4.38", 1);
    tests++; errors += test_is_local( "37.111.221.248", 0);
    tests++; errors += test_is_local( "86.101.139.233", 0);
    tests++; errors += test_is_local( "131.225.138.71", 0);
    tests++; errors += test_is_local( "127.104.212.163", 1);
    tests++; errors += test_is_local( "173.47.194.17", 0);
    tests++; errors += test_is_local( "127.42.37.112", 1);
    tests++; errors += test_is_local( "149.177.102.104", 0);
    tests++; errors += test_is_local( "127.49.28.249", 1);
    tests++; errors += test_is_local( "127.92.205.76", 1);
    tests++; errors += test_is_local( "207.190.93.223", 0);
    tests++; errors += test_is_local( "144.51.109.243", 0);
    tests++; errors += test_is_local( "127.243.203.207", 1);
    tests++; errors += test_is_local( "127.212.47.39", 1);
    tests++; errors += test_is_local( "154.196.107.50", 0);
    tests++; errors += test_is_local( "127.54.161.236", 1);
    tests++; errors += test_is_local( "204.224.253.8", 0);
    tests++; errors += test_is_local( "160.239.38.66", 0);
    tests++; errors += test_is_local( "128.20.79.174", 0);
    tests++; errors += test_is_local( "42.86.40.133", 0);
    tests++; errors += test_is_local( "135.48.51.92", 0);
    tests++; errors += test_is_local( "140.149.129.216", 0);
    tests++; errors += test_is_local( "127.128.199.246", 1);
    tests++; errors += test_is_local( "127.2.119.93", 1);
    tests++; errors += test_is_local( "103.191.183.227", 0);
    tests++; errors += test_is_local( "67.0.246.201", 0);
    tests++; errors += test_is_local( "127.200.143.89", 1);
    tests++; errors += test_is_local( "63.10.38.119", 0);
    tests++; errors += test_is_local( "127.16.166.207", 1);
    tests++; errors += test_is_local( "235.80.230.216", 0);
    tests++; errors += test_is_local( "127.56.234.51", 1);
    tests++; errors += test_is_local( "127.237.39.128", 1);
    tests++; errors += test_is_local( "62.212.150.87", 0);
    tests++; errors += test_is_local( "12.59.76.75", 0);
    tests++; errors += test_is_local( "56.132.71.8", 0);
    tests++; errors += test_is_local( "127.128.213.228", 1);
    tests++; errors += test_is_local( "127.43.57.41", 1);
    tests++; errors += test_is_local( "127.127.168.42", 1);
    tests++; errors += test_is_local( "127.192.225.182", 1);
    tests++; errors += test_is_local( "127.154.226.11", 1);
    tests++; errors += test_is_local( "10.171.18.59", 0);
    tests++; errors += test_is_local( "162.25.10.202", 0);
    tests++; errors += test_is_local( "127.215.152.191", 1);
    tests++; errors += test_is_local( "127.109.78.0", 1);
    tests++; errors += test_is_local( "241.185.73.50", 0);
    tests++; errors += test_is_local( "127.167.156.237", 1);
    tests++; errors += test_is_local( "127.150.245.219", 1);
    tests++; errors += test_is_local( "127.189.238.13", 1);
    tests++; errors += test_is_local( "89.137.13.86", 0);
    tests++; errors += test_is_local( "127.59.237.136", 1);
    tests++; errors += test_is_local( "186.132.1.190", 0);
    tests++; errors += test_is_local( "145.199.249.215", 0);
    tests++; errors += test_is_local( "51.209.189.165", 0);
    tests++; errors += test_is_local( "127.38.70.91", 1);
    tests++; errors += test_is_local( "210.62.218.170", 0);
    tests++; errors += test_is_local( "74.108.169.134", 0);
    tests++; errors += test_is_local( "214.122.252.224", 0);
    tests++; errors += test_is_local( "122.101.218.74", 0);
    tests++; errors += test_is_local( "1.95.174.63", 0);
    tests++; errors += test_is_local( "127.67.19.202", 1);
    tests++; errors += test_is_local( "127.203.123.9", 1);
    tests++; errors += test_is_local( "68.23.55.232", 0);
    tests++; errors += test_is_local( "127.143.201.253", 1);
    tests++; errors += test_is_local( "172.119.185.110", 0);
    tests++; errors += test_is_local( "118.148.171.74", 0);
    tests++; errors += test_is_local( "127.148.148.121", 1);
    tests++; errors += test_is_local( "48.1.142.252", 0);
    tests++; errors += test_is_local( "43.140.161.155", 0);
    tests++; errors += test_is_local( "113.141.200.134", 0);
    tests++; errors += test_is_local( "127.58.16.161", 1);
    tests++; errors += test_is_local( "127.219.83.113", 1);
    tests++; errors += test_is_local( "127.91.38.33", 1);
    tests++; errors += test_is_local( "127.181.96.220", 1);
    tests++; errors += test_is_local( "186.146.142.141", 0);
    tests++; errors += test_is_local( "127.156.108.143", 1);
    tests++; errors += test_is_local( "153.238.25.8", 0);
    tests++; errors += test_is_local( "127.115.53.197", 1);
    tests++; errors += test_is_local( "127.42.241.79", 1);
    tests++; errors += test_is_local( "241.157.94.138", 0);
    tests++; errors += test_is_local( "116.245.130.74", 0);
    tests++; errors += test_is_local( "150.57.226.248", 0);
    tests++; errors += test_is_local( "53.70.88.129", 0);
    tests++; errors += test_is_local( "148.69.89.118", 0);
    tests++; errors += test_is_local( "134.170.146.22", 0);
    tests++; errors += test_is_local( "94.204.212.158", 0);
    tests++; errors += test_is_local( "143.201.44.226", 0);
    tests++; errors += test_is_local( "70.7.124.2", 0);
    tests++; errors += test_is_local( "149.186.136.125", 0);
    tests++; errors += test_is_local( "127.71.105.105", 1);
    tests++; errors += test_is_local( "127.204.197.87", 1);
    tests++; errors += test_is_local( "127.142.246.78", 1);
    tests++; errors += test_is_local( "0.130.0.100", 0);
    tests++; errors += test_is_local( "153.234.132.196", 0);
    tests++; errors += test_is_local( "179.13.173.32", 0);
    tests++; errors += test_is_local( "127.162.228.68", 1);
    tests++; errors += test_is_local( "222.90.94.54", 0);
    tests++; errors += test_is_local( "127.79.133.148", 1);
    tests++; errors += test_is_local( "44.187.9.152", 0);
    tests++; errors += test_is_local( "28.41.171.18", 0);
    tests++; errors += test_is_local( "127.145.180.127", 1);
    tests++; errors += test_is_local( "223.215.216.77", 0);
    tests++; errors += test_is_local( "127.104.101.193", 1);
    tests++; errors += test_is_local( "127.168.125.153", 1);
    tests++; errors += test_is_local( "36.113.138.147", 0);
    tests++; errors += test_is_local( "145.183.142.163", 0);
    tests++; errors += test_is_local( "93.63.201.178", 0);
    tests++; errors += test_is_local( "127.55.10.139", 1);
    tests++; errors += test_is_local( "229.131.109.181", 0);
    tests++; errors += test_is_local( "127.26.87.108", 1);
    tests++; errors += test_is_local( "83.193.61.31", 0);
    tests++; errors += test_is_local( "31.119.250.109", 0);
    tests++; errors += test_is_local( "141.48.167.130", 0);
    tests++; errors += test_is_local( "161.141.138.91", 0);
    tests++; errors += test_is_local( "70.52.192.152", 0);
    tests++; errors += test_is_local( "39.109.198.4", 0);
    tests++; errors += test_is_local( "127.10.145.107", 1);
    tests++; errors += test_is_local( "127.186.150.246", 1);
    tests++; errors += test_is_local( "127.77.102.141", 1);
    tests++; errors += test_is_local( "127.171.47.62", 1);
    tests++; errors += test_is_local( "127.245.53.218", 1);
    tests++; errors += test_is_local( "245.147.142.252", 0);
    tests++; errors += test_is_local( "127.238.140.234", 1);
    tests++; errors += test_is_local( "137.41.157.182", 0);
    tests++; errors += test_is_local( "127.27.2.110", 1);
    tests++; errors += test_is_local( "127.139.145.241", 1);
    tests++; errors += test_is_local( "127.50.32.186", 1);
    tests++; errors += test_is_local( "127.102.240.212", 1);
    tests++; errors += test_is_local( "127.231.121.168", 1);
    tests++; errors += test_is_local( "75.169.138.78", 0);
    tests++; errors += test_is_local( "222.118.62.249", 0);
    tests++; errors += test_is_local( "34.236.0.200", 0);
    tests++; errors += test_is_local( "127.143.206.153", 1);
    tests++; errors += test_is_local( "0.243.5.120", 0);
    tests++; errors += test_is_local( "127.78.23.213", 1);
    tests++; errors += test_is_local( "127.199.115.107", 1);
    tests++; errors += test_is_local( "127.219.203.73", 1);
    tests++; errors += test_is_local( "127.46.113.157", 1);
    tests++; errors += test_is_local( "102.1.96.249", 0);
    tests++; errors += test_is_local( "127.57.116.216", 1);
    tests++; errors += test_is_local( "82.214.55.38", 0);
    tests++; errors += test_is_local( "127.99.126.151", 1);
    tests++; errors += test_is_local( "25.119.211.248", 0);
    tests++; errors += test_is_local( "127.253.156.251", 1);
    tests++; errors += test_is_local( "78.222.155.32", 0);
    tests++; errors += test_is_local( "79.163.28.4", 0);
    tests++; errors += test_is_local( "241.30.18.65", 0);
    tests++; errors += test_is_local( "127.149.121.12", 1);
    tests++; errors += test_is_local( "127.54.70.84", 1);
    tests++; errors += test_is_local( "127.186.82.68", 1);
    tests++; errors += test_is_local( "127.57.225.176", 1);
    tests++; errors += test_is_local( "127.93.143.224", 1);
    tests++; errors += test_is_local( "93.197.49.53", 0);
    tests++; errors += test_is_local( "111.208.161.172", 0);
    tests++; errors += test_is_local( "183.119.146.236", 0);
    tests++; errors += test_is_local( "127.91.47.101", 1);
    tests++; errors += test_is_local( "127.109.88.168", 1);
    tests++; errors += test_is_local( "127.66.56.224", 1);
    tests++; errors += test_is_local( "244.130.222.84", 0);
    tests++; errors += test_is_local( "127.44.152.135", 1);
    tests++; errors += test_is_local( "33.6.132.114", 0);
    tests++; errors += test_is_local( "127.154.100.173", 1);
    tests++; errors += test_is_local( "127.204.127.116", 1);
    tests++; errors += test_is_local( "127.210.154.236", 1);
    tests++; errors += test_is_local( "127.59.207.210", 1);
    tests++; errors += test_is_local( "121.230.51.80", 0);
    tests++; errors += test_is_local( "127.233.216.52", 1);
    tests++; errors += test_is_local( "22.113.244.41", 0);
    tests++; errors += test_is_local( "190.34.195.188", 0);
    tests++; errors += test_is_local( "77.110.104.59", 0);
    tests++; errors += test_is_local( "93.113.138.161", 0);
    tests++; errors += test_is_local( "127.231.139.125", 1);
    tests++; errors += test_is_local( "73.220.26.245", 0);
    tests++; errors += test_is_local( "127.21.166.164", 1);
    tests++; errors += test_is_local( "127.160.97.204", 1);
    tests++; errors += test_is_local( "127.157.120.11", 1);
    tests++; errors += test_is_local( "213.250.115.95", 0);
    tests++; errors += test_is_local( "45.179.63.114", 0);
    tests++; errors += test_is_local( "127.135.76.239", 1);
    tests++; errors += test_is_local( "124.35.17.253", 0);
    tests++; errors += test_is_local( "52.249.23.82", 0);
    tests++; errors += test_is_local( "127.78.147.157", 1);
    tests++; errors += test_is_local( "211.122.206.61", 0);
    tests++; errors += test_is_local( "130.94.178.105", 0);
    tests++; errors += test_is_local( "127.142.187.155", 1);
    tests++; errors += test_is_local( "13.229.253.29", 0);
    tests++; errors += test_is_local( "208.34.48.234", 0);
    tests++; errors += test_is_local( "157.154.210.177", 0);
    tests++; errors += test_is_local( "127.127.3.46", 1);
    tests++; errors += test_is_local( "127.218.155.61", 1);
    tests++; errors += test_is_local( "230.249.244.58", 0);
    tests++; errors += test_is_local( "210.236.224.130", 0);
    tests++; errors += test_is_local( "43.46.114.88", 0);
    tests++; errors += test_is_local( "127.148.182.12", 1);
    tests++; errors += test_is_local( "127.97.177.63", 1);
    tests++; errors += test_is_local( "127.90.84.248", 1);
    tests++; errors += test_is_local( "1.215.191.57", 0);
    tests++; errors += test_is_local( "127.7.135.228", 1);
    tests++; errors += test_is_local( "127.125.250.128", 1);
    tests++; errors += test_is_local( "127.116.113.136", 1);
    tests++; errors += test_is_local( "149.98.224.102", 0);
    tests++; errors += test_is_local( "76.168.216.14", 0);
    tests++; errors += test_is_local( "127.217.35.218", 1);
    tests++; errors += test_is_local( "127.95.102.159", 1);
    tests++; errors += test_is_local( "127.2.132.155", 1);
    tests++; errors += test_is_local( "127.141.107.246", 1);
    tests++; errors += test_is_local( "127.250.238.139", 1);
    tests++; errors += test_is_local( "127.0.232.180", 1);
    tests++; errors += test_is_local( "127.215.128.29", 1);
    tests++; errors += test_is_local( "191.233.83.230", 0);
    tests++; errors += test_is_local( "127.53.148.70", 1);
    tests++; errors += test_is_local( "241.102.14.248", 0);
    tests++; errors += test_is_local( "22.3.85.28", 0);
    tests++; errors += test_is_local( "127.186.239.205", 1);
    tests++; errors += test_is_local( "215.58.180.223", 0);
    tests++; errors += test_is_local( "164.43.186.209", 0);
    tests++; errors += test_is_local( "127.48.7.145", 1);
    tests++; errors += test_is_local( "123.32.105.155", 0);
    tests++; errors += test_is_local( "127.52.164.122", 1);
    tests++; errors += test_is_local( "135.87.117.169", 0);
    tests++; errors += test_is_local( "127.92.191.98", 1);
    tests++; errors += test_is_local( "17.183.24.21", 0);
    tests++; errors += test_is_local( "127.27.143.152", 1);
    tests++; errors += test_is_local( "71.221.42.241", 0);
    tests++; errors += test_is_local( "183.205.20.115", 0);
    tests++; errors += test_is_local( "42.133.86.99", 0);
    tests++; errors += test_is_local( "191.191.48.75", 0);
    tests++; errors += test_is_local( "108.95.63.113", 0);
    tests++; errors += test_is_local( "253.14.120.242", 0);
    tests++; errors += test_is_local( "144.79.112.11", 0);
    tests++; errors += test_is_local( "127.38.52.224", 1);
    tests++; errors += test_is_local( "94.12.107.229", 0);
    tests++; errors += test_is_local( "179.219.102.239", 0);
    tests++; errors += test_is_local( "127.144.221.75", 1);
    tests++; errors += test_is_local( "127.94.181.17", 1);
    tests++; errors += test_is_local( "227.245.97.243", 0);
    tests++; errors += test_is_local( "127.58.144.5", 1);
    tests++; errors += test_is_local( "127.147.73.36", 1);
    tests++; errors += test_is_local( "55.148.236.251", 0);
    tests++; errors += test_is_local( "165.76.9.124", 0);
    tests++; errors += test_is_local( "124.168.146.135", 0);
    tests++; errors += test_is_local( "127.204.0.82", 1);
    tests++; errors += test_is_local( "127.76.60.131", 1);
    tests++; errors += test_is_local( "127.137.170.66", 1);
    tests++; errors += test_is_local( "243.238.108.201", 0);
    tests++; errors += test_is_local( "219.253.246.92", 0);
    tests++; errors += test_is_local( "127.212.39.194", 1);
    tests++; errors += test_is_local( "127.4.206.132", 1);
    tests++; errors += test_is_local( "155.214.63.246", 0);
    tests++; errors += test_is_local( "235.16.177.117", 0);
    tests++; errors += test_is_local( "127.217.44.189", 1);
    tests++; errors += test_is_local( "87.15.245.237", 0);
    tests++; errors += test_is_local( "127.80.100.27", 1);
    tests++; errors += test_is_local( "127.236.169.132", 1);
    tests++; errors += test_is_local( "72.140.192.118", 0);
    tests++; errors += test_is_local( "127.138.206.195", 1);
    tests++; errors += test_is_local( "58.187.201.161", 0);
    tests++; errors += test_is_local( "151.92.101.73", 0);
    tests++; errors += test_is_local( "92.144.209.233", 0);
    tests++; errors += test_is_local( "127.8.167.64", 1);
    tests++; errors += test_is_local( "204.167.41.178", 0);
    tests++; errors += test_is_local( "127.125.123.25", 1);
    tests++; errors += test_is_local( "127.166.217.110", 1);
    tests++; errors += test_is_local( "127.216.171.136", 1);
    tests++; errors += test_is_local( "127.168.94.17", 1);
    tests++; errors += test_is_local( "127.221.37.33", 1);
    tests++; errors += test_is_local( "16.122.153.75", 0);
    tests++; errors += test_is_local( "215.182.231.80", 0);
    tests++; errors += test_is_local( "68.50.8.7", 0);
    tests++; errors += test_is_local( "127.98.105.88", 1);
    tests++; errors += test_is_local( "176.158.74.73", 0);
    tests++; errors += test_is_local( "235.161.161.165", 0);
    tests++; errors += test_is_local( "127.227.190.42", 1);
    tests++; errors += test_is_local( "127.79.62.238", 1);
    tests++; errors += test_is_local( "127.154.97.237", 1);
    tests++; errors += test_is_local( "223.36.154.222", 0);
    tests++; errors += test_is_local( "127.90.229.137", 1);
    tests++; errors += test_is_local( "252.10.140.75", 0);
    tests++; errors += test_is_local( "127.90.190.248", 1);
    tests++; errors += test_is_local( "210.228.203.169", 0);
    tests++; errors += test_is_local( "83.112.165.243", 0);
    tests++; errors += test_is_local( "123.181.196.147", 0);
    tests++; errors += test_is_local( "101.104.178.130", 0);
    tests++; errors += test_is_local( "127.128.47.94", 1);
    tests++; errors += test_is_local( "127.161.170.61", 1);
    tests++; errors += test_is_local( "127.106.225.66", 1);
    tests++; errors += test_is_local( "171.226.43.49", 0);
    tests++; errors += test_is_local( "127.188.252.160", 1);
    tests++; errors += test_is_local( "127.100.191.223", 1);
    tests++; errors += test_is_local( "127.52.57.236", 1);
    tests++; errors += test_is_local( "127.191.51.210", 1);
    tests++; errors += test_is_local( "251.131.175.15", 0);
    tests++; errors += test_is_local( "127.156.229.225", 1);
    tests++; errors += test_is_local( "127.88.84.76", 1);
    tests++; errors += test_is_local( "127.151.178.124", 1);
    tests++; errors += test_is_local( "71.247.196.0", 0);
    tests++; errors += test_is_local( "191.241.36.167", 0);
    tests++; errors += test_is_local( "127.197.84.136", 1);
    tests++; errors += test_is_local( "127.204.238.216", 1);
    tests++; errors += test_is_local( "127.145.49.128", 1);
    tests++; errors += test_is_local( "127.242.70.125", 1);
    tests++; errors += test_is_local( "127.77.112.23", 1);
    tests++; errors += test_is_local( "241.143.229.159", 0);
    tests++; errors += test_is_local( "127.46.65.43", 1);
    tests++; errors += test_is_local( "18.118.110.72", 0);
    tests++; errors += test_is_local( "127.94.81.98", 1);
    tests++; errors += test_is_local( "127.209.75.1", 1);
    tests++; errors += test_is_local( "127.173.123.111", 1);
    tests++; errors += test_is_local( "127.92.131.61", 1);
    tests++; errors += test_is_local( "78.220.84.170", 0);
    tests++; errors += test_is_local( "127.0.82.84", 1);
    tests++; errors += test_is_local( "176.240.27.94", 0);
    tests++; errors += test_is_local( "88.153.77.100", 0);
    tests++; errors += test_is_local( "127.213.161.95", 1);
    tests++; errors += test_is_local( "134.100.210.182", 0);
    tests++; errors += test_is_local( "127.210.65.128", 1);
    tests++; errors += test_is_local( "127.117.130.137", 1);
    tests++; errors += test_is_local( "127.238.89.58", 1);
    tests++; errors += test_is_local( "231.122.16.98", 0);
    tests++; errors += test_is_local( "127.11.131.111", 1);
    tests++; errors += test_is_local( "178.194.75.112", 0);
    tests++; errors += test_is_local( "127.179.230.203", 1);
    tests++; errors += test_is_local( "216.244.3.193", 0);
    tests++; errors += test_is_local( "220.230.38.53", 0);
    tests++; errors += test_is_local( "22.23.96.180", 0);
    tests++; errors += test_is_local( "127.35.81.80", 1);
    tests++; errors += test_is_local( "177.104.6.38", 0);
    tests++; errors += test_is_local( "107.136.110.240", 0);
    tests++; errors += test_is_local( "127.203.68.135", 1);
    tests++; errors += test_is_local( "184.232.108.23", 0);
    tests++; errors += test_is_local( "122.87.74.162", 0);
    tests++; errors += test_is_local( "127.78.202.134", 1);
    tests++; errors += test_is_local( "127.105.97.210", 1);
    tests++; errors += test_is_local( "133.208.173.185", 0);
    tests++; errors += test_is_local( "127.182.212.31", 1);
    tests++; errors += test_is_local( "113.105.247.248", 0);
    tests++; errors += test_is_local( "127.17.108.161", 1);
    tests++; errors += test_is_local( "211.26.63.249", 0);
    tests++; errors += test_is_local( "127.184.26.220", 1);
    tests++; errors += test_is_local( "240.61.142.58", 0);
    tests++; errors += test_is_local( "251.193.219.188", 0);
    tests++; errors += test_is_local( "252.152.192.48", 0);
    tests++; errors += test_is_local( "127.39.178.18", 1);
    tests++; errors += test_is_local( "127.84.153.157", 1);
    tests++; errors += test_is_local( "127.101.66.225", 1);
    tests++; errors += test_is_local( "127.179.60.122", 1);
    tests++; errors += test_is_local( "67.61.159.108", 0);
    tests++; errors += test_is_local( "127.114.245.141", 1);
    tests++; errors += test_is_local( "204.147.89.151", 0);
    tests++; errors += test_is_local( "fc40:9555::dde1", 0 );
    tests++; errors += test_is_local( "fc25:e058:36b4::890f", 0 );
    tests++; errors += test_is_local( "7aa6:4d32::1c46", 0 );
    tests++; errors += test_is_local( "f5be:822e:3f3d::b0ee", 0 );
    tests++; errors += test_is_local( "fdcd:8249::2782", 0 );
    tests++; errors += test_is_local( "fded:e48b::987e", 0 );
    tests++; errors += test_is_local( "fc81:3d0a:fde2::", 0 );
    tests++; errors += test_is_local( "fc96:1ff9:1eda::", 0 );
    tests++; errors += test_is_local( "fce4:f55a::", 0 );
    tests++; errors += test_is_local( "fc2c:0baa:f582::", 0 );
    tests++; errors += test_is_local( "d365:0f5c:e835:cf5f:ea2a::f6eb", 0 );
    tests++; errors += test_is_local( "fd1b:b4ae::", 0 );
    tests++; errors += test_is_local( "e148:24c4::", 0 );
    tests++; errors += test_is_local( "34c2:4cf6::", 0 );
    tests++; errors += test_is_local( "fce6:19c4::", 0 );
    tests++; errors += test_is_local( "e530:b8fe:9b7a:30b3:5dc4::7ca1", 0 );
    tests++; errors += test_is_local( "3945:7d67:3edc::", 0 );
    tests++; errors += test_is_local( "fd5e:a787::", 0 );
    tests++; errors += test_is_local( "7407:3a93::", 0 );
    tests++; errors += test_is_local( "8a89:09cb::b7e9", 0 );
    tests++; errors += test_is_local( "30aa:1f03::3483", 0 );
    tests++; errors += test_is_local( "fc2c:581a:b4a5:2670::", 0 );
    tests++; errors += test_is_local( "fdbf:5337:af05::", 0 );
    tests++; errors += test_is_local( "ff1f:8c68::", 0 );
    tests++; errors += test_is_local( "bba1:fcce::", 0 );
    tests++; errors += test_is_local( "fd3f:4676::", 0 );
    tests++; errors += test_is_local( "fca0:3a65::9f67", 0 );
    tests++; errors += test_is_local( "fccb:a15a:ed23::", 0 );
    tests++; errors += test_is_local( "8dca:680a::", 0 );
    tests++; errors += test_is_local( "0c2c:1776::", 0 );
    tests++; errors += test_is_local( "fd07:c231:9c50::2bcb", 0 );
    tests++; errors += test_is_local( "e677:7052:0d5d::fb60", 0 );
    tests++; errors += test_is_local( "fcc9:9042:8e56::", 0 );
    tests++; errors += test_is_local( "fb71:4891::1e5e", 0 );
    tests++; errors += test_is_local( "fd9e:0be5::c44c", 0 );
    tests++; errors += test_is_local( "07b3:6261::", 0 );
    tests++; errors += test_is_local( "1bc1:697c::7e92", 0 );
    tests++; errors += test_is_local( "4cb4:ed5f::", 0 );
    tests++; errors += test_is_local( "3898:39a0::", 0 );
    tests++; errors += test_is_local( "fc73:8f5b:c29f::c88c", 0 );
    tests++; errors += test_is_local( "fd31:cd35::", 0 );
    tests++; errors += test_is_local( "fc3e:3579:631b::", 0 );
    tests++; errors += test_is_local( "a750:b3b5::", 0 );
    tests++; errors += test_is_local( "fd5e:60f7::023d", 0 );
    tests++; errors += test_is_local( "fc6b:bc65:f336:af4e:bc3c:8e93::", 0 );
    tests++; errors += test_is_local( "065c:84e2:2760::978d", 0 );
    tests++; errors += test_is_local( "bcc8:6d8d::102d", 0 );
    tests++; errors += test_is_local( "5178:97b4::", 0 );
    tests++; errors += test_is_local( "fdb0:e057::8099", 0 );
    tests++; errors += test_is_local( "fc57:c7b7:da66:16c6::", 0 );
    tests++; errors += test_is_local( "fcc4:aca3:7c13:234e:d119::", 0 );
    tests++; errors += test_is_local( "fdeb:2348::", 0 );
    tests++; errors += test_is_local( "fdaa:b2ca:0eca:a648::", 0 );
    tests++; errors += test_is_local( "fc13:d77d::2479", 0 );
    tests++; errors += test_is_local( "fd75:5e2c::b052", 0 );

    printf( "\ngeoip.c:is_local(): passed %i out of %i tests\n", ( tests - errors ), tests );
    return( errors );
}
